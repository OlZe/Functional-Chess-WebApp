function sW(Z){return!Z}function qZ(Z,Q,J){if(Z)return Q;else return J()}class U{withFields(Z){let Q=Object.keys(this).map((J)=>(J in Z)?Z[J]:this[J]);return new this.constructor(...Q)}}class ZQ{static fromArray(Z,Q){let J=Q||new j;for(let W=Z.length-1;W>=0;--W)J=new cZ(Z[W],J);return J}[Symbol.iterator](){return new iW(this)}toArray(){return[...this]}atLeastLength(Z){let Q=this;while(Z-- >0&&Q)Q=Q.tail;return Q!==void 0}hasLength(Z){let Q=this;while(Z-- >0&&Q)Q=Q.tail;return Z===-1&&Q instanceof j}countLength(){let Z=this,Q=0;while(Z)Z=Z.tail,Q++;return Q-1}}function D(Z,Q){return new cZ(Z,Q)}function R(Z,Q){return ZQ.fromArray(Z,Q)}class iW{#Z;constructor(Z){this.#Z=Z}next(){if(this.#Z instanceof j)return{done:!0};else{let{head:Z,tail:Q}=this.#Z;return this.#Z=Q,{value:Z,done:!1}}}}class j extends ZQ{}class cZ extends ZQ{constructor(Z,Q){super();this.head=Z,this.tail=Q}}class O9{bitSize;byteSize;bitOffset;rawBuffer;constructor(Z,Q,J){if(!(Z instanceof Uint8Array))throw globalThis.Error("BitArray can only be constructed from a Uint8Array");if(this.bitSize=Q??Z.length*8,this.byteSize=Math.trunc((this.bitSize+7)/8),this.bitOffset=J??0,this.bitSize<0)throw globalThis.Error(`BitArray bit size is invalid: ${this.bitSize}`);if(this.bitOffset<0||this.bitOffset>7)throw globalThis.Error(`BitArray bit offset is invalid: ${this.bitOffset}`);if(Z.length!==Math.trunc((this.bitOffset+this.bitSize+7)/8))throw globalThis.Error("BitArray buffer length is invalid");this.rawBuffer=Z}byteAt(Z){if(Z<0||Z>=this.byteSize)return;return p9(this.rawBuffer,this.bitOffset,Z)}equals(Z){if(this.bitSize!==Z.bitSize)return!1;let Q=Math.trunc(this.bitSize/8);if(this.bitOffset===0&&Z.bitOffset===0){for(let W=0;W<Q;W++)if(this.rawBuffer[W]!==Z.rawBuffer[W])return!1;let J=this.bitSize%8;if(J){let W=8-J;if(this.rawBuffer[Q]>>W!==Z.rawBuffer[Q]>>W)return!1}}else{for(let W=0;W<Q;W++){let G=p9(this.rawBuffer,this.bitOffset,W),K=p9(Z.rawBuffer,Z.bitOffset,W);if(G!==K)return!1}let J=this.bitSize%8;if(J){let W=p9(this.rawBuffer,this.bitOffset,Q),G=p9(Z.rawBuffer,Z.bitOffset,Q),K=8-J;if(W>>K!==G>>K)return!1}}return!0}get buffer(){if(nW("buffer","Use BitArray.byteAt() or BitArray.rawBuffer instead"),this.bitOffset!==0||this.bitSize%8!==0)throw new globalThis.Error("BitArray.buffer does not support unaligned bit arrays");return this.rawBuffer}get length(){if(nW("length","Use BitArray.bitSize or BitArray.byteSize instead"),this.bitOffset!==0||this.bitSize%8!==0)throw new globalThis.Error("BitArray.length does not support unaligned bit arrays");return this.rawBuffer.length}}function p9(Z,Q,J){if(Q===0)return Z[J]??0;else{let W=Z[J]<<Q&255,G=Z[J+1]>>8-Q;return W|G}}class d9{constructor(Z){this.value=Z}}var lW={};function nW(Z,Q){if(lW[Z])return;console.warn(`Deprecated BitArray.${Z} property used in JavaScript FFI code. ${Q}.`),lW[Z]=!0}class s9 extends U{static isResult(Z){return Z instanceof s9}}class x extends s9{constructor(Z){super();this[0]=Z}isOk(){return!0}}class b extends s9{constructor(Z){super();this[0]=Z}isOk(){return!1}}function A(Z,Q){let J=[Z,Q];while(J.length){let W=J.pop(),G=J.pop();if(W===G)continue;if(!rW(W)||!rW(G))return!1;if(!iK(W,G)||pK(W,G)||dK(W,G)||sK(W,G)||lK(W,G)||nK(W,G)||rK(W,G))return!1;let X=Object.getPrototypeOf(W);if(X!==null&&typeof X.equals==="function")try{if(W.equals(G))continue;else return!1}catch{}let[V,Y]=cK(W),M=V(W),F=V(G);if(M.length!==F.length)return!1;for(let H of M)J.push(Y(W,H),Y(G,H))}return!0}function cK(Z){if(Z instanceof Map)return[(Q)=>Q.keys(),(Q,J)=>Q.get(J)];else{let Q=Z instanceof globalThis.Error?["message"]:[];return[(J)=>[...Q,...Object.keys(J)],(J,W)=>J[W]]}}function pK(Z,Q){return Z instanceof Date&&(Z>Q||Z<Q)}function dK(Z,Q){return!(Z instanceof O9)&&Z.buffer instanceof ArrayBuffer&&Z.BYTES_PER_ELEMENT&&!(Z.byteLength===Q.byteLength&&Z.every((J,W)=>J===Q[W]))}function sK(Z,Q){return Array.isArray(Z)&&Z.length!==Q.length}function lK(Z,Q){return Z instanceof Map&&Z.size!==Q.size}function nK(Z,Q){return Z instanceof Set&&(Z.size!=Q.size||[...Z].some((J)=>!Q.has(J)))}function rK(Z,Q){return Z instanceof RegExp&&(Z.source!==Q.source||Z.flags!==Q.flags)}function rW(Z){return typeof Z==="object"&&Z!==null}function iK(Z,Q){if(typeof Z!=="object"&&typeof Q!=="object"&&(!Z||!Q))return!1;if([Promise,WeakSet,WeakMap,Function].some((W)=>Z instanceof W))return!1;return Z.constructor===Q.constructor}function g(Z,Q,J,W,G,K,X){let V=new globalThis.Error(K);V.gleam_error=Z,V.file=Q,V.module=J,V.line=W,V.function=G,V.fn=G;for(let Y in X)V[Y]=X[Y];return V}class E extends U{constructor(Z){super();this[0]=Z}}class y extends U{}function aK(Z,Q){while(!0){let J=Z,W=Q;if(J instanceof j)return W;else{let G=J.head;Z=J.tail,Q=D(G,W)}}}function tK(Z){return aK(Z,R([]))}function aW(Z){return A(Z,new y)}function tW(Z,Q){if(Z instanceof E){let J=Z[0];return new x(J)}else return new b(Q)}function j8(Z){if(Z instanceof x){let Q=Z[0];return new E(Q)}else return new y}function SQ(Z,Q){if(Z instanceof E){let J=Z[0];return Q(J)}else return Z}function l9(Z,Q){if(Z instanceof E)return Z;else return Q()}function oK(Z,Q){while(!0){let J=Z,W=Q;if(J instanceof j)return tK(W);else{let G=J.head;if(G instanceof E){let K=J.tail,X=G[0];Z=K,Q=D(X,W)}else Z=J.tail,Q=W}}}function W9(Z){return oK(Z,R([]))}var oW=new WeakMap,B8=new DataView(new ArrayBuffer(8)),A8=0;function P8(Z){let Q=oW.get(Z);if(Q!==void 0)return Q;let J=A8++;if(A8===2147483647)A8=0;return oW.set(Z,J),J}function S8(Z,Q){return Z^Q+2654435769+(Z<<6)+(Z>>2)|0}function L8(Z){let Q=0,J=Z.length;for(let W=0;W<J;W++)Q=Math.imul(31,Q)+Z.charCodeAt(W)|0;return Q}function ZG(Z){B8.setFloat64(0,Z);let Q=B8.getInt32(0),J=B8.getInt32(4);return Math.imul(73244475,Q>>16^Q)^J}function eK(Z){return L8(Z.toString())}function ZX(Z){let Q=Object.getPrototypeOf(Z);if(Q!==null&&typeof Q.hashCode==="function")try{let W=Z.hashCode(Z);if(typeof W==="number")return W}catch{}if(Z instanceof Promise||Z instanceof WeakSet||Z instanceof WeakMap)return P8(Z);if(Z instanceof Date)return ZG(Z.getTime());let J=0;if(Z instanceof ArrayBuffer)Z=new Uint8Array(Z);if(Array.isArray(Z)||Z instanceof Uint8Array)for(let W=0;W<Z.length;W++)J=Math.imul(31,J)+nZ(Z[W])|0;else if(Z instanceof Set)Z.forEach((W)=>{J=J+nZ(W)|0});else if(Z instanceof Map)Z.forEach((W,G)=>{J=J+S8(nZ(W),nZ(G))|0});else{let W=Object.keys(Z);for(let G=0;G<W.length;G++){let K=W[G],X=Z[K];J=J+S8(nZ(X),L8(K))|0}}return J}function nZ(Z){if(Z===null)return 1108378658;if(Z===void 0)return 1108378659;if(Z===!0)return 1108378657;if(Z===!1)return 1108378656;switch(typeof Z){case"number":return ZG(Z);case"string":return L8(Z);case"bigint":return eK(Z);case"object":return ZX(Z);case"symbol":return P8(Z);case"function":return P8(Z);default:return 0}}var FQ=5,C8=Math.pow(2,FQ),QX=C8-1,JX=C8/2,WX=C8/4,xZ=0,UQ=1,pZ=2,G9=3,E8={type:pZ,bitmap:0,array:[]};function n9(Z,Q){return Z>>>Q&QX}function TJ(Z,Q){return 1<<n9(Z,Q)}function GX(Z){return Z-=Z>>1&1431655765,Z=(Z&858993459)+(Z>>2&858993459),Z=Z+(Z>>4)&252645135,Z+=Z>>8,Z+=Z>>16,Z&127}function w8(Z,Q){return GX(Z&Q-1)}function rZ(Z,Q,J){let W=Z.length,G=Array(W);for(let K=0;K<W;++K)G[K]=Z[K];return G[Q]=J,G}function KX(Z,Q,J){let W=Z.length,G=Array(W+1),K=0,X=0;while(K<Q)G[X++]=Z[K++];G[X++]=J;while(K<W)G[X++]=Z[K++];return G}function T8(Z,Q){let J=Z.length,W=Array(J-1),G=0,K=0;while(G<Q)W[K++]=Z[G++];++G;while(G<J)W[K++]=Z[G++];return W}function QG(Z,Q,J,W,G,K){let X=nZ(Q);if(X===W)return{type:G9,hash:X,array:[{type:xZ,k:Q,v:J},{type:xZ,k:G,v:K}]};let V={val:!1};return r9(x8(E8,Z,X,Q,J,V),Z,W,G,K,V)}function r9(Z,Q,J,W,G,K){switch(Z.type){case UQ:return XX(Z,Q,J,W,G,K);case pZ:return x8(Z,Q,J,W,G,K);case G9:return VX(Z,Q,J,W,G,K)}}function XX(Z,Q,J,W,G,K){let X=n9(J,Q),V=Z.array[X];if(V===void 0)return K.val=!0,{type:UQ,size:Z.size+1,array:rZ(Z.array,X,{type:xZ,k:W,v:G})};if(V.type===xZ){if(A(W,V.k)){if(G===V.v)return Z;return{type:UQ,size:Z.size,array:rZ(Z.array,X,{type:xZ,k:W,v:G})}}return K.val=!0,{type:UQ,size:Z.size,array:rZ(Z.array,X,QG(Q+FQ,V.k,V.v,J,W,G))}}let Y=r9(V,Q+FQ,J,W,G,K);if(Y===V)return Z;return{type:UQ,size:Z.size,array:rZ(Z.array,X,Y)}}function x8(Z,Q,J,W,G,K){let X=TJ(J,Q),V=w8(Z.bitmap,X);if((Z.bitmap&X)!==0){let Y=Z.array[V];if(Y.type!==xZ){let F=r9(Y,Q+FQ,J,W,G,K);if(F===Y)return Z;return{type:pZ,bitmap:Z.bitmap,array:rZ(Z.array,V,F)}}let M=Y.k;if(A(W,M)){if(G===Y.v)return Z;return{type:pZ,bitmap:Z.bitmap,array:rZ(Z.array,V,{type:xZ,k:W,v:G})}}return K.val=!0,{type:pZ,bitmap:Z.bitmap,array:rZ(Z.array,V,QG(Q+FQ,M,Y.v,J,W,G))}}else{let Y=Z.array.length;if(Y>=JX){let M=Array(32),F=n9(J,Q);M[F]=x8(E8,Q+FQ,J,W,G,K);let H=0,I=Z.bitmap;for(let q=0;q<32;q++){if((I&1)!==0){let N=Z.array[H++];M[q]=N}I=I>>>1}return{type:UQ,size:Y+1,array:M}}else{let M=KX(Z.array,V,{type:xZ,k:W,v:G});return K.val=!0,{type:pZ,bitmap:Z.bitmap|X,array:M}}}}function VX(Z,Q,J,W,G,K){if(J===Z.hash){let X=k8(Z,W);if(X!==-1){if(Z.array[X].v===G)return Z;return{type:G9,hash:J,array:rZ(Z.array,X,{type:xZ,k:W,v:G})}}let V=Z.array.length;return K.val=!0,{type:G9,hash:J,array:rZ(Z.array,V,{type:xZ,k:W,v:G})}}return r9({type:pZ,bitmap:TJ(Z.hash,Q),array:[Z]},Q,J,W,G,K)}function k8(Z,Q){let J=Z.array.length;for(let W=0;W<J;W++)if(A(Q,Z.array[W].k))return W;return-1}function SJ(Z,Q,J,W){switch(Z.type){case UQ:return YX(Z,Q,J,W);case pZ:return MX(Z,Q,J,W);case G9:return HX(Z,W)}}function YX(Z,Q,J,W){let G=n9(J,Q),K=Z.array[G];if(K===void 0)return;if(K.type!==xZ)return SJ(K,Q+FQ,J,W);if(A(W,K.k))return K;return}function MX(Z,Q,J,W){let G=TJ(J,Q);if((Z.bitmap&G)===0)return;let K=w8(Z.bitmap,G),X=Z.array[K];if(X.type!==xZ)return SJ(X,Q+FQ,J,W);if(A(W,X.k))return X;return}function HX(Z,Q){let J=k8(Z,Q);if(J<0)return;return Z.array[J]}function y8(Z,Q,J,W){switch(Z.type){case UQ:return UX(Z,Q,J,W);case pZ:return FX(Z,Q,J,W);case G9:return RX(Z,W)}}function UX(Z,Q,J,W){let G=n9(J,Q),K=Z.array[G];if(K===void 0)return Z;let X=void 0;if(K.type===xZ){if(!A(K.k,W))return Z}else if(X=y8(K,Q+FQ,J,W),X===K)return Z;if(X===void 0){if(Z.size<=WX){let V=Z.array,Y=Array(Z.size-1),M=0,F=0,H=0;while(M<G){let I=V[M];if(I!==void 0)Y[F]=I,H|=1<<M,++F;++M}++M;while(M<V.length){let I=V[M];if(I!==void 0)Y[F]=I,H|=1<<M,++F;++M}return{type:pZ,bitmap:H,array:Y}}return{type:UQ,size:Z.size-1,array:rZ(Z.array,G,X)}}return{type:UQ,size:Z.size,array:rZ(Z.array,G,X)}}function FX(Z,Q,J,W){let G=TJ(J,Q);if((Z.bitmap&G)===0)return Z;let K=w8(Z.bitmap,G),X=Z.array[K];if(X.type!==xZ){let V=y8(X,Q+FQ,J,W);if(V===X)return Z;if(V!==void 0)return{type:pZ,bitmap:Z.bitmap,array:rZ(Z.array,K,V)};if(Z.bitmap===G)return;return{type:pZ,bitmap:Z.bitmap^G,array:T8(Z.array,K)}}if(A(W,X.k)){if(Z.bitmap===G)return;return{type:pZ,bitmap:Z.bitmap^G,array:T8(Z.array,K)}}return Z}function RX(Z,Q){let J=k8(Z,Q);if(J<0)return Z;if(Z.array.length===1)return;return{type:G9,hash:Z.hash,array:T8(Z.array,J)}}function JG(Z,Q){if(Z===void 0)return;let J=Z.array,W=J.length;for(let G=0;G<W;G++){let K=J[G];if(K===void 0)continue;if(K.type===xZ){Q(K.v,K.k);continue}JG(K,Q)}}class wZ{static fromObject(Z){let Q=Object.keys(Z),J=wZ.new();for(let W=0;W<Q.length;W++){let G=Q[W];J=J.set(G,Z[G])}return J}static fromMap(Z){let Q=wZ.new();return Z.forEach((J,W)=>{Q=Q.set(W,J)}),Q}static new(){return new wZ(void 0,0)}constructor(Z,Q){this.root=Z,this.size=Q}get(Z,Q){if(this.root===void 0)return Q;let J=SJ(this.root,0,nZ(Z),Z);if(J===void 0)return Q;return J.v}set(Z,Q){let J={val:!1},W=this.root===void 0?E8:this.root,G=r9(W,0,nZ(Z),Z,Q,J);if(G===this.root)return this;return new wZ(G,J.val?this.size+1:this.size)}delete(Z){if(this.root===void 0)return this;let Q=y8(this.root,0,nZ(Z),Z);if(Q===this.root)return this;if(Q===void 0)return wZ.new();return new wZ(Q,this.size-1)}has(Z){if(this.root===void 0)return!1;return SJ(this.root,0,nZ(Z),Z)!==void 0}entries(){if(this.root===void 0)return[];let Z=[];return this.forEach((Q,J)=>Z.push([J,Q])),Z}forEach(Z){JG(this.root,Z)}hashCode(){let Z=0;return this.forEach((Q,J)=>{Z=Z+S8(nZ(Q),nZ(J))|0}),Z}equals(Z){if(!(Z instanceof wZ)||this.size!==Z.size)return!1;try{return this.forEach((Q,J)=>{if(!A(Z.get(J,!Q),Q))throw eW}),!0}catch(Q){if(Q===eW)return!1;throw Q}}}var eW=Symbol();class GZ extends U{}class KZ extends U{}class TQ extends U{}function LJ(Z,Q){if(Z===Q)return new KZ;else if(Z<Q)return new GZ;else return new TQ}class TZ extends U{}class j9 extends U{}function B9(Z,Q){while(!0){let J=Z,W=Q;if(J instanceof j)return W;else{let G=J.head;Z=J.tail,Q=D(G,W)}}}function e(Z){return B9(Z,R([]))}function YG(Z){return A(Z,R([]))}function jX(Z,Q,J){while(!0){let W=Z,G=Q,K=J;if(W instanceof j)return e(K);else{let{head:X,tail:V}=W,Y;if(G(X))Y=D(X,K);else Y=K;let F=Y;Z=V,Q=G,J=F}}}function A9(Z,Q){return jX(Z,Q,R([]))}function BX(Z,Q,J){while(!0){let W=Z,G=Q,K=J;if(W instanceof j)return e(K);else{let{head:X,tail:V}=W,Y,M=G(X);if(M instanceof x){let H=M[0];Y=D(H,K)}else Y=K;let F=Y;Z=V,Q=G,J=F}}}function CJ(Z,Q){return BX(Z,Q,R([]))}function AX(Z,Q,J){while(!0){let W=Z,G=Q,K=J;if(W instanceof j)return e(K);else{let X=W.head;Z=W.tail,Q=G,J=D(G(X),K)}}}function kZ(Z,Q){return AX(Z,Q,R([]))}function PX(Z,Q,J,W){while(!0){let G=Z,K=Q,X=J,V=W;if(G instanceof j)return e(V);else{let{head:Y,tail:M}=G,F=D(K(Y,X),V);Z=M,Q=K,J=X+1,W=F}}}function MG(Z,Q){return PX(Z,Q,0,R([]))}function SX(Z,Q){while(!0){let J=Z,W=Q;if(J instanceof j)return W;else{let G=J.head;Z=J.tail,Q=D(G,W)}}}function P9(Z,Q){return SX(e(Z),Q)}function EJ(Z,Q){return D(Q,Z)}function TX(Z,Q){while(!0){let J=Z,W=Q;if(J instanceof j)return e(W);else{let G=J.head;Z=J.tail,Q=B9(G,W)}}}function LX(Z){return TX(Z,R([]))}function S9(Z,Q){return LX(kZ(Z,Q))}function LZ(Z,Q,J){while(!0){let W=Z,G=Q,K=J;if(W instanceof j)return G;else{let X=W.head;Z=W.tail,Q=K(G,X),J=K}}}function HG(Z,Q){while(!0){let J=Z,W=Q;if(J instanceof j)return new b(void 0);else{let{head:G,tail:K}=J,X=W(G);if(X instanceof x)return X;else Z=K,Q=W}}}function i9(Z,Q){while(!0){let J=Z,W=Q;if(J instanceof j)return!0;else{let{head:G,tail:K}=J,X=W(G);if(X)Z=K,Q=W;else return X}}}function a9(Z,Q){while(!0){let J=Z,W=Q;if(J instanceof j)return!1;else{let{head:G,tail:K}=J,X=W(G);if(X)return X;else Z=K,Q=W}}}function CX(Z,Q,J,W,G,K){while(!0){let X=Z,V=Q,Y=J,M=W,F=G,H=K,I=D(F,Y);if(X instanceof j)if(M instanceof TZ)return D(e(I),H);else return D(I,H);else{let{head:q,tail:N}=X,S=V(F,q);if(M instanceof TZ)if(S instanceof GZ)Z=N,Q=V,J=I,W=M,G=q,K=H;else if(S instanceof KZ)Z=N,Q=V,J=I,W=M,G=q,K=H;else{let O;if(M instanceof TZ)O=D(e(I),H);else O=D(I,H);let L=O;if(N instanceof j)return D(R([q]),L);else{let{head:P,tail:k}=N,T,z=V(q,P);if(z instanceof GZ)T=new TZ;else if(z instanceof KZ)T=new TZ;else T=new j9;let w=T;Z=k,Q=V,J=R([q]),W=w,G=P,K=L}}else if(S instanceof GZ){let O;if(M instanceof TZ)O=D(e(I),H);else O=D(I,H);let L=O;if(N instanceof j)return D(R([q]),L);else{let{head:P,tail:k}=N,T,z=V(q,P);if(z instanceof GZ)T=new TZ;else if(z instanceof KZ)T=new TZ;else T=new j9;let w=T;Z=k,Q=V,J=R([q]),W=w,G=P,K=L}}else if(S instanceof KZ){let O;if(M instanceof TZ)O=D(e(I),H);else O=D(I,H);let L=O;if(N instanceof j)return D(R([q]),L);else{let{head:P,tail:k}=N,T,z=V(q,P);if(z instanceof GZ)T=new TZ;else if(z instanceof KZ)T=new TZ;else T=new j9;let w=T;Z=k,Q=V,J=R([q]),W=w,G=P,K=L}}else Z=N,Q=V,J=I,W=M,G=q,K=H}}}function EX(Z,Q,J,W){while(!0){let G=Z,K=Q,X=J,V=W;if(G instanceof j)return B9(K,V);else if(K instanceof j)return B9(G,V);else{let{head:Y,tail:M}=G,F=K.head,H=K.tail,I=X(Y,F);if(I instanceof GZ)Z=M,Q=K,J=X,W=D(Y,V);else if(I instanceof KZ)Z=G,Q=H,J=X,W=D(F,V);else Z=G,Q=H,J=X,W=D(F,V)}}}function wX(Z,Q,J){while(!0){let W=Z,G=Q,K=J;if(W instanceof j)return e(K);else{let X=W.tail;if(X instanceof j){let V=W.head;return e(D(e(V),K))}else{let V=W.head,Y=X.head,M=X.tail,F=EX(V,Y,G,R([]));Z=M,Q=G,J=D(F,K)}}}}function xX(Z,Q,J,W){while(!0){let G=Z,K=Q,X=J,V=W;if(G instanceof j)return B9(K,V);else if(K instanceof j)return B9(G,V);else{let{head:Y,tail:M}=G,F=K.head,H=K.tail,I=X(Y,F);if(I instanceof GZ)Z=G,Q=H,J=X,W=D(F,V);else if(I instanceof KZ)Z=M,Q=K,J=X,W=D(Y,V);else Z=M,Q=K,J=X,W=D(Y,V)}}}function kX(Z,Q,J){while(!0){let W=Z,G=Q,K=J;if(W instanceof j)return e(K);else{let X=W.tail;if(X instanceof j){let V=W.head;return e(D(e(V),K))}else{let V=W.head,Y=X.head,M=X.tail,F=xX(V,Y,G,R([]));Z=M,Q=G,J=D(F,K)}}}}function yX(Z,Q,J){while(!0){let W=Z,G=Q,K=J;if(W instanceof j)return W;else if(G instanceof TZ)if(W.tail instanceof j)return W.head;else Z=wX(W,K,R([])),Q=new j9,J=K;else if(W.tail instanceof j){let V=W.head;return e(V)}else Z=kX(W,K,R([])),Q=new TZ,J=K}}function UG(Z,Q){if(Z instanceof j)return Z;else{let J=Z.tail;if(J instanceof j)return Z;else{let W=Z.head,G=J.head,K=J.tail,X,V=Q(W,G);if(V instanceof GZ)X=new TZ;else if(V instanceof KZ)X=new TZ;else X=new j9;let Y=X,M=CX(K,Q,R([W]),Y,G,R([]));return yX(M,new TZ,Q)}}}function FG(Z,Q){while(!0){let J=Z,W=Q;if(J instanceof j)return;else{let{head:G,tail:K}=J;W(G),Z=K,Q=W}}}function uX(Z,Q){while(!0){let J=Z,W=Q;if(J instanceof j)return W;else{let G=J.head;Z=J.tail,Q=W+G}}}function IG(Z){return uX(Z,"")}class h8 extends U{constructor(Z){super();this.function=Z}}function X9(Z,Q){let J=Q.function(Z),W,G;if(W=J[0],G=J[1],G instanceof j)return new x(W);else return new b(G)}function v8(Z){return new h8((Q)=>{return[Z,R([])]})}function wJ(Z,Q){return new h8((J)=>{let W=Z.function(J),G,K;return G=W[0],K=W[1],[Q(G),K]})}var dX=void 0,NG={};function lQ(Z){return Z.toString()}function f8(Z,Q){return Z.startsWith(Q)}var DG=[" ","\t",`
`,"\v","\f","\r","","\u2028","\u2029"].join(""),hY=new RegExp(`^[${DG}]*`),vY=new RegExp(`[${DG}]*$`);function aZ(){return wZ.new()}function nQ(Z){return Z.size}function V9(Z){return ZQ.fromArray(Z.entries())}function OG(Z,Q){return Q.delete(Z)}function NZ(Z,Q){let J=Z.get(Q,NG);if(J===NG)return new b(dX);return new x(J)}function jG(Z,Q,J){return J.set(Z,Q)}function VG(Z){let Q=Z.toString().replace("+","");if(Q.indexOf(".")>=0)return Q;else{let J=Q.indexOf("e");if(J>=0)return Q.slice(0,J)+".0"+Q.slice(J);else return Q+".0"}}class sX{#Z=new Set;inspect(Z){let Q=typeof Z;if(Z===!0)return"True";if(Z===!1)return"False";if(Z===null)return"//js(null)";if(Z===void 0)return"Nil";if(Q==="string")return this.#K(Z);if(Q==="bigint"||Number.isInteger(Z))return Z.toString();if(Q==="number")return VG(Z);if(Z instanceof d9)return this.#X(Z);if(Z instanceof O9)return this.#Y(Z);if(Z instanceof RegExp)return`//js(${Z})`;if(Z instanceof Date)return`//js(Date("${Z.toISOString()}"))`;if(Z instanceof globalThis.Error)return`//js(${Z.toString()})`;if(Z instanceof Function){let W=[];for(let G of Array(Z.length).keys())W.push(String.fromCharCode(G+97));return`//fn(${W.join(", ")}) { ... }`}if(this.#Z.size===this.#Z.add(Z).size)return"//js(circular reference)";let J;if(Array.isArray(Z))J=`#(${Z.map((W)=>this.inspect(W)).join(", ")})`;else if(Z instanceof ZQ)J=this.#Q(Z);else if(Z instanceof U)J=this.#J(Z);else if(Z instanceof wZ)J=this.#W(Z);else if(Z instanceof Set)return`//js(Set(${[...Z].map((W)=>this.inspect(W)).join(", ")}))`;else J=this.#G(Z);return this.#Z.delete(Z),J}#G(Z){let Q=Object.getPrototypeOf(Z)?.constructor?.name||"Object",J=[];for(let K of Object.keys(Z))J.push(`${this.inspect(K)}: ${this.inspect(Z[K])}`);let W=J.length?" "+J.join(", ")+" ":"";return`//js(${Q==="Object"?"":Q+" "}{${W}})`}#W(Z){let Q="dict.from_list([",J=!0;return Z.forEach((W,G)=>{if(!J)Q=Q+", ";Q=Q+"#("+this.inspect(G)+", "+this.inspect(W)+")",J=!1}),Q+"])"}#J(Z){let Q=Object.keys(Z).map((J)=>{let W=this.inspect(Z[J]);return isNaN(parseInt(J))?`${J}: ${W}`:W}).join(", ");return Q?`${Z.constructor.name}(${Q})`:Z.constructor.name}#Q(Z){if(Z instanceof j)return"[]";let Q='charlist.from_string("',J="[",W=Z;while(W instanceof cZ){let G=W.head;if(W=W.tail,J!=="[")J+=", ";if(J+=this.inspect(G),Q)if(Number.isInteger(G)&&G>=32&&G<=126)Q+=String.fromCharCode(G);else Q=null}if(Q)return Q+'")';else return J+"]"}#K(Z){let Q='"';for(let J=0;J<Z.length;J++){let W=Z[J];switch(W){case`
`:Q+="\\n";break;case"\r":Q+="\\r";break;case"\t":Q+="\\t";break;case"\f":Q+="\\f";break;case"\\":Q+="\\\\";break;case'"':Q+="\\\"";break;default:if(W<" "||W>"~"&&W<" ")Q+="\\u{"+W.charCodeAt(0).toString(16).toUpperCase().padStart(4,"0")+"}";else Q+=W}}return Q+='"',Q}#X(Z){return`//utfcodepoint(${String.fromCodePoint(Z.value)})`}#Y(Z){if(Z.bitSize===0)return"<<>>";let Q="<<";for(let J=0;J<Z.byteSize-1;J++)Q+=Z.byteAt(J).toString(),Q+=", ";if(Z.byteSize*8===Z.bitSize)Q+=Z.byteAt(Z.byteSize-1).toString();else{let J=Z.bitSize%8;Q+=Z.byteAt(Z.byteSize-1)>>8-J,Q+=`:size(${J})`}return Q+=">>",Q}}function b8(Z){return nQ(Z)===0}function jZ(Z,Q,J){return jG(Q,J,Z)}function lX(Z,Q){while(!0){let J=Z,W=Q;if(J instanceof j)return W;else{let G=J.tail,K=J.head[0],X=J.head[1];Z=G,Q=jZ(W,K,X)}}}function K9(Z){return lX(Z,aZ())}function nX(Z,Q){while(!0){let J=Z,W=Q;if(J instanceof j)return W;else{let G=J.head;Z=J.tail,Q=D(G,W)}}}function rX(Z,Q){while(!0){let J=Z,W=Q;if(J instanceof j)return nX(W,R([]));else{let G=J.tail,K=J.head[0];Z=G,Q=D(K,W)}}}function IQ(Z){return rX(V9(Z),R([]))}function tZ(Z,Q){return OG(Q,Z)}function iX(Z,Q,J){while(!0){let W=Z,G=Q,K=J;if(W instanceof j)return G;else{let X=W.tail,V=W.head[0],Y=W.head[1];Z=X,Q=K(G,V,Y),J=K}}}function o9(Z,Q,J){return iX(V9(Z),Q,J)}function aX(Z,Q){let J=(W,G,K)=>{if(Z(G,K))return jZ(W,G,K);else return W};return o9(Q,aZ(),J)}function BG(Z,Q){return aX(Q,Z)}function AG(Z){if(Z instanceof x)return!0;else return!1}function g8(Z,Q){if(Z instanceof x){let J=Z[0];return new x(Q(J))}else return Z}function Y9(Z,Q){if(Z instanceof x)return Z;else{let J=Z[0];return new b(Q(J))}}function CQ(Z,Q){if(Z instanceof x){let J=Z[0];return Q(J)}else return Z}function xJ(Z,Q){if(Z instanceof x)return Z[0];else return Q}function T9(Z,Q){if(Z instanceof x)return Z[0];else return Q()}class e9 extends U{constructor(Z){super();this.dict=Z}}function CZ(){return new e9(aZ())}function PG(Z){return A(Z,CZ())}function ZJ(Z,Q){let J=Z.dict,W=NZ(J,Q);return AG(W)}function L9(Z){return IQ(Z.dict)}function rQ(Z,Q,J){return o9(Z.dict,Q,(W,G,K)=>{return J(W,G)})}function SG(Z,Q){return new e9(BG(Z.dict,(J,W)=>{return Q(J)}))}function tX(Z,Q){if(nQ(Z.dict)>nQ(Q.dict))return[Z,Q];else return[Q,Z]}var TG=void 0;function QJ(Z,Q){return new e9(jZ(Z.dict,Q,TG))}function _Z(Z){let Q=LZ(Z,aZ(),(J,W)=>{return jZ(J,W,TG)});return new e9(Q)}function EZ(Z,Q){return rQ(Z,CZ(),(J,W)=>{return QJ(J,Q(W))})}function iQ(Z,Q){let J=tX(Z,Q),W,G;return W=J[0],G=J[1],rQ(G,W,QJ)}class _8 extends U{constructor(Z){super();this.dict=Z}}function C9(){return new _8(aZ())}function u8(Z,Q){let J=Z.dict,W=NZ(J,Q);return xJ(W,0)}function E9(Z,Q){let J=u8(Z,Q)+1,W=jZ(Z.dict,Q,J);return new _8(W)}var r="src/chess.gleam";class m8 extends U{constructor(Z,Q,J,W){super();this.internal=Z,this.history=Q,this.status=J,this.starting_position=W}}class fZ extends U{constructor(Z,Q,J,W,G,K,X,V,Y){super();this.board=Z,this.moving_player=Q,this.en_passant_possible=J,this.short_castle_disqualified_white=W,this.long_castle_disqualified_white=G,this.short_castle_disqualified_black=K,this.long_castle_disqualified_black=X,this.fifty_move_rule_counter=V,this.threefold_repetition_counter=Y}}class CG extends U{constructor(Z,Q,J,W,G,K,X){super();this.board=Z,this.moving_player=Q,this.en_passant_possible=J,this.short_castle_disqualified_white=W,this.long_castle_disqualified_white=G,this.short_castle_disqualified_black=K,this.long_castle_disqualified_black=X}}class yQ extends U{constructor(Z){super();this.info=Z}}class GJ extends U{constructor(Z){super();this.next_player=Z}}class yJ extends U{constructor(Z,Q){super();this.winner=Z,this.by=Q}}class WJ extends U{constructor(Z){super();this.by=Z}}class bJ extends U{}class EG extends U{}class wG extends U{}class xG extends U{}class kG extends U{}class QQ extends U{constructor(Z,Q,J){super();this.white_king=Z,this.black_king=Q,this.other_figures=J}}class s extends U{}class oZ extends U{}class uZ extends U{}class FZ extends U{}class JQ extends U{}class EQ extends U{}class h extends U{}class XZ extends U{}class B extends U{constructor(Z,Q){super();this.file=Z,this.row=Q}}class DZ extends U{}class BZ extends U{}class QZ extends U{}class RZ extends U{}class p extends U{}class IZ extends U{}class JZ extends U{}class $Z extends U{}class v extends U{}class HZ extends U{}class dZ extends U{}class yZ extends U{}class bZ extends U{}class sZ extends U{}class UZ extends U{}class $ extends U{}class qQ extends U{constructor(Z,Q){super();this.from=Z,this.to=Q}}class wQ extends U{constructor(Z,Q,J){super();this.from=Z,this.to=Q,this.new_figure=J}}class xQ extends U{constructor(Z,Q){super();this.from=Z,this.to=Q}}class kQ extends U{}class fJ extends U{}class yG extends U{}class bG extends U{}class hJ extends U{}class vJ extends U{constructor(Z){super();this.reason=Z}}class fG extends U{}class hG extends U{}class vG extends U{constructor(Z){super();this.reason=Z}}class hZ extends U{constructor(Z){super();this.to=Z}}class NQ extends U{constructor(Z){super();this.to=Z}}class DQ extends U{constructor(Z){super();this.to=Z}}class OQ extends U{}class c8 extends U{}class gJ extends U{constructor(Z,Q,J){super();this.origin=Z,this.offset=Q,this.attacker=J}}class _J extends U{constructor(Z,Q,J){super();this.origin=Z,this.direction=Q,this.attacker=J}}class gG extends U{}class _G extends U{}function p8(Z){return nQ(Z.internal.board.other_figures)+2}function KJ(Z){return Z.status}function eX(Z){return Z.fifty_move_rule_counter>=100}function Z6(){return new QQ(new B(new p,new v),new B(new p,new $),K9(R([[new B(new DZ,new v),[new FZ,new h]],[new B(new BZ,new v),[new oZ,new h]],[new B(new QZ,new v),[new uZ,new h]],[new B(new RZ,new v),[new JQ,new h]],[new B(new IZ,new v),[new uZ,new h]],[new B(new JZ,new v),[new oZ,new h]],[new B(new $Z,new v),[new FZ,new h]],[new B(new DZ,new HZ),[new s,new h]],[new B(new BZ,new HZ),[new s,new h]],[new B(new QZ,new HZ),[new s,new h]],[new B(new RZ,new HZ),[new s,new h]],[new B(new p,new HZ),[new s,new h]],[new B(new IZ,new HZ),[new s,new h]],[new B(new JZ,new HZ),[new s,new h]],[new B(new $Z,new HZ),[new s,new h]],[new B(new DZ,new $),[new FZ,new XZ]],[new B(new BZ,new $),[new oZ,new XZ]],[new B(new QZ,new $),[new uZ,new XZ]],[new B(new RZ,new $),[new JQ,new XZ]],[new B(new IZ,new $),[new uZ,new XZ]],[new B(new JZ,new $),[new oZ,new XZ]],[new B(new $Z,new $),[new FZ,new XZ]],[new B(new DZ,new UZ),[new s,new XZ]],[new B(new BZ,new UZ),[new s,new XZ]],[new B(new QZ,new UZ),[new s,new XZ]],[new B(new RZ,new UZ),[new s,new XZ]],[new B(new p,new UZ),[new s,new XZ]],[new B(new IZ,new UZ),[new s,new XZ]],[new B(new JZ,new UZ),[new s,new XZ]],[new B(new $Z,new UZ),[new s,new XZ]]])))}function uG(){let Z=new fZ(Z6(),new h,new y,!1,!1,!1,!1,0,C9());return new m8(Z,R([]),new GJ(new h),Z)}function n(Z,Q){let J=Z.white_king;if(A(J,Q))return new E([new EQ,new h]);else{let W=Z.black_king;if(A(W,Q))return new E([new EQ,new XZ]);else{let K=Z.other_figures,X=NZ(K,Q);return j8(X)}}}function bQ(Z,Q){let J=Z.internal.board;return n(J,Q)}function LG(Z){let Q,J=Z.file;if(J instanceof DZ)Q=0;else if(J instanceof BZ)Q=1;else if(J instanceof QZ)Q=2;else if(J instanceof RZ)Q=3;else if(J instanceof p)Q=4;else if(J instanceof IZ)Q=5;else if(J instanceof JZ)Q=6;else Q=7;let W=Q,G,K=Z.row;if(K instanceof v)G=0;else if(K instanceof HZ)G=1;else if(K instanceof dZ)G=2;else if(K instanceof yZ)G=3;else if(K instanceof bZ)G=4;else if(K instanceof sZ)G=5;else if(K instanceof UZ)G=6;else G=7;let V=(W+G)%2;if(V===0)return new _G;else if(V===1)return new gG;else throw g("panic",r,"chess",1803,"coord_colour","`panic` expression evaluated.",{})}function Q6(Z){let Q=V9(Z.other_figures);if(Q instanceof j)return!0;else{let J=Q.tail;if(J instanceof j){let W=Q.head[1][0];if(W instanceof oZ)return!0;else if(W instanceof uZ)return!0;else return!1}else if(J.tail instanceof j)if(J.head[1][0]instanceof uZ)if(Q.head[1][0]instanceof uZ){let X=J.head[1][1],V=Q.head[1][1];if(!A(V,X)){let Y=J.head[0],M=Q.head[0];return A(LG(M),LG(Y))}else return!1}else return!1;else return!1;else return!1}}function J6(Z,Q){while(!0){let J=Z,W=Q,G=LJ(W,0);if(G instanceof GZ)if(J instanceof v)return new y;else if(J instanceof HZ)Z=new v,Q=W+1;else if(J instanceof dZ)Z=new HZ,Q=W+1;else if(J instanceof yZ)Z=new dZ,Q=W+1;else if(J instanceof bZ)Z=new yZ,Q=W+1;else if(J instanceof sZ)Z=new bZ,Q=W+1;else if(J instanceof UZ)Z=new sZ,Q=W+1;else Z=new UZ,Q=W+1;else if(G instanceof KZ)return new E(J);else if(J instanceof v)Z=new HZ,Q=W-1;else if(J instanceof HZ)Z=new dZ,Q=W-1;else if(J instanceof dZ)Z=new yZ,Q=W-1;else if(J instanceof yZ)Z=new bZ,Q=W-1;else if(J instanceof bZ)Z=new sZ,Q=W-1;else if(J instanceof sZ)Z=new UZ,Q=W-1;else if(J instanceof UZ)Z=new $,Q=W-1;else return new y}}function $8(Z,Q){while(!0){let J=Z,W=Q,G=LJ(W,0);if(G instanceof GZ)if(J instanceof DZ)return new y;else if(J instanceof BZ)Z=new DZ,Q=W+1;else if(J instanceof QZ)Z=new BZ,Q=W+1;else if(J instanceof RZ)Z=new QZ,Q=W+1;else if(J instanceof p)Z=new RZ,Q=W+1;else if(J instanceof IZ)Z=new p,Q=W+1;else if(J instanceof JZ)Z=new IZ,Q=W+1;else Z=new JZ,Q=W+1;else if(G instanceof KZ)return new E(J);else if(J instanceof DZ)Z=new BZ,Q=W-1;else if(J instanceof BZ)Z=new QZ,Q=W-1;else if(J instanceof QZ)Z=new RZ,Q=W-1;else if(J instanceof RZ)Z=new p,Q=W-1;else if(J instanceof p)Z=new IZ,Q=W-1;else if(J instanceof IZ)Z=new JZ,Q=W-1;else if(J instanceof JZ)Z=new $Z,Q=W-1;else return new y}}function W6(Z,Q){return SQ(Z.en_passant_possible,(J)=>{let W=R([$8(J,-1),$8(J,1)]),G=W9(W),K=HG(G,(X)=>{let V;if(Z.moving_player instanceof h)V=[new B(X,new bZ),new B(J,new sZ)];else V=[new B(X,new yZ),new B(J,new dZ)];let M=V,F,H;if(F=M[0],H=M[1],A(Q,F))return new x(new DQ(H));else return new b(void 0)});return j8(K)})}function w9(Z,Q,J){return SQ($8(Z.file,Q),(W)=>{return SQ(J6(Z.row,J),(G)=>{return new E(new B(W,G))})})}function G6(Z,Q){let J;if(Z.moving_player instanceof h)J=1;else J=-1;let G=J,K=SQ(w9(Q,0,G),(T)=>{if(n(Z.board,T)instanceof E)return new y;else return new E(T)}),X=SQ(K,(T)=>{let z;if(Z.moving_player instanceof h)z=new yZ;else z=new bZ;let C=z;return SQ(w9(T,0,G),(f)=>{return qZ(!A(f.row,C),new y,()=>{if(n(Z.board,f)instanceof E)return new y;else return new E(f)})})}),V=SQ(w9(Q,-1,G),(T)=>{let z=n(Z.board,T);if(z instanceof E){let w=z[0][1];if(A(w,Z.moving_player))return new y;else return new E(T)}else return z}),Y=SQ(w9(Q,1,G),(T)=>{let z=n(Z.board,T);if(z instanceof E){let w=z[0][1];if(A(w,Z.moving_player))return new y;else return new E(T)}else return z}),M,F=R([K,X,V,Y]),H=W9(F),I=kZ(H,(T)=>{let z;if(Z.moving_player instanceof h)z=new $;else z=new v;let C=z,f=T.row;if(A(f,C))return new NQ(T);else return new hZ(T)});M=_Z(I);let q=M,N=W6(Z,Q),S,O=R([N]),L=W9(O),P=_Z(L);return S=iQ(P,q),S}function K6(Z,Q,J,W,G){while(!0){let K=Z,X=Q,V=J,Y=W,M=G,F=w9(X,V[0],V[1]);if(F instanceof E){let H=F[0],I=n(K,H);if(I instanceof E){let q=I[0][1];if(A(q,Y))return M;else return QJ(M,H)}else Z=K,Q=H,J=V,W=Y,G=QJ(M,H)}else return M}}function XJ(Z,Q){if(Q instanceof gJ){let{origin:J,attacker:W}=Q,G=Q.offset[0],K=Q.offset[1],X=w9(J,G,K);if(X instanceof E){let V=X[0],Y=n(Z,V);if(Y instanceof E){let M=Y[0][1];if(A(M,W))return CZ();else return _Z(R([V]))}else return _Z(R([V]))}else return CZ()}else{let{origin:J,direction:W,attacker:G}=Q;return K6(Z,J,W,G,CZ())}}function X6(Z,Q,J){let W=R([[1,2],[2,1],[2,-1],[1,-2],[-1,-2],[-2,-1],[-2,1],[-1,2]]),G=_Z(W),K=EZ(G,(Y)=>{return new gJ(Q,Y,J)}),X=EZ(K,(Y)=>{return XJ(Z,Y)}),V=rQ(X,CZ(),iQ);return EZ(V,(Y)=>{return new hZ(Y)})}function V6(Z,Q,J){let W=R([[0,1],[1,0],[0,-1],[-1,0]]),G=_Z(W),K=EZ(G,(Y)=>{return new _J(Q,Y,J)}),X=EZ(K,(Y)=>{return XJ(Z,Y)}),V=rQ(X,CZ(),iQ);return EZ(V,(Y)=>{return new hZ(Y)})}function Y6(Z,Q,J){let W=R([[1,1],[1,-1],[-1,-1],[-1,1]]),G=_Z(W),K=EZ(G,(Y)=>{return new _J(Q,Y,J)}),X=EZ(K,(Y)=>{return XJ(Z,Y)}),V=rQ(X,CZ(),iQ);return EZ(V,(Y)=>{return new hZ(Y)})}function M6(Z,Q,J){let W=R([[0,1],[1,0],[0,-1],[-1,0],[1,1],[1,-1],[-1,-1],[-1,1]]),G=_Z(W),K=EZ(G,(Y)=>{return new _J(Q,Y,J)}),X=EZ(K,(Y)=>{return XJ(Z,Y)}),V=rQ(X,CZ(),iQ);return EZ(V,(Y)=>{return new hZ(Y)})}function x9(Z){if(Z instanceof h)return new XZ;else return new h}function k9(Z){return new CG(Z.board,Z.moving_player,Z.en_passant_possible,Z.short_castle_disqualified_white,Z.long_castle_disqualified_white,Z.short_castle_disqualified_black,Z.long_castle_disqualified_black)}function H6(Z){let Q=new fZ(Z.board,x9(Z.moving_player),Z.en_passant_possible,Z.short_castle_disqualified_white,Z.long_castle_disqualified_white,Z.short_castle_disqualified_black,Z.long_castle_disqualified_black,Z.fifty_move_rule_counter,Z.threefold_repetition_counter),J=k9(Q);return(()=>{let W=Q.threefold_repetition_counter;return u8(W,J)})()>=2}var t=`Critical internal error!
This is not your fault (unless you mutated the internal state!).
If you see this message then this likely means, that something in this package's logic is incorrect.
Please open an issue at https://github.com/OlZe/Functional-Chess with a detailled description to help improve this package.
Sorry for the inconvience.`;function U6(Z,Q,J){let W;if(NZ(Z.board.other_figures,J)instanceof x)W=!0;else W=!1;let K=W,X,V=NZ(Z.board.other_figures,Q);if(V instanceof x)if(V[0][0]instanceof s)X=!0;else X=!1;else X=!1;let Y=X,M=qZ(Y,0,()=>{return qZ(K,0,()=>{return Z.fifty_move_rule_counter+1})}),F=qZ(K,C9(),()=>{return qZ(Y,C9(),()=>{let q=Z.threefold_repetition_counter;return E9(q,k9(Z))})}),H=Z.board,I=H.white_king;if(A(I,Q)){let{black_king:q,other_figures:N}=H;return new fZ(new QQ(J,q,tZ(N,J)),Z.moving_player,new y,!0,!0,Z.short_castle_disqualified_black,Z.long_castle_disqualified_black,M,F)}else{let q=H.black_king;if(A(q,Q)){let{white_king:N,other_figures:S}=H;return new fZ(new QQ(N,J,tZ(S,J)),Z.moving_player,new y,Z.short_castle_disqualified_white,Z.long_castle_disqualified_white,!0,!0,M,F)}else{let{white_king:N,black_king:S,other_figures:O}=H,L=NZ(O,Q),P;if(L instanceof x)P=L[0];else throw g("let_assert",r,"chess",1522,"do_move_standard_figure_move",t,{value:L,start:46713,end:46773,pattern_start:46724,pattern_end:46741});let k;if(P[1]instanceof h)if(P[0]instanceof s&&(A(Q.row,new HZ)&&A(J.row,new yZ))&&A(Q.file,J.file))k=new E(J.file);else k=new y;else if(P[0]instanceof s&&(A(Q.row,new UZ)&&A(J.row,new bZ))&&A(Q.file,J.file))k=new E(J.file);else k=new y;let z=k,w=Z.short_castle_disqualified_white||A(Q,new B(new $Z,new v)),C=Z.long_castle_disqualified_white||A(Q,new B(new DZ,new v)),f=Z.short_castle_disqualified_black||A(Q,new B(new $Z,new $)),m=Z.long_castle_disqualified_black||A(Q,new B(new DZ,new $));return new fZ(new QQ(N,S,(()=>{let VZ=tZ(O,Q);return jZ(VZ,J,P)})()),Z.moving_player,z,w,C,f,m,M,F)}}}function F6(Z,Q,J,W){let{board:G,moving_player:K}=Z,X=n(G,Q),V=new E([new s,K]);if(!A(X,V))throw g("assert",r,"chess",1580,"do_move_pawn_promotion",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:X,start:48608,end:48630},right:{kind:"expression",value:V,start:48634,end:48662},start:48601,end:48662,expression_start:48608});return new fZ(new QQ(G.white_king,G.black_king,(()=>{let Y=G.other_figures,M=tZ(Y,Q);return jZ(M,J,[W,K])})()),Z.moving_player,new y,Z.short_castle_disqualified_white,Z.long_castle_disqualified_white,Z.short_castle_disqualified_black,Z.long_castle_disqualified_black,0,C9())}function R6(Z,Q,J){let{board:W,moving_player:G}=Z,K=new B(J.file,Q.row),X=n(W,Q),V=new E([new s,G]);if(!A(X,V))throw g("assert",r,"chess",1609,"do_move_en_passant",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:X,start:49461,end:49483},right:{kind:"expression",value:V,start:49487,end:49515},start:49454,end:49515,expression_start:49461});let Y=n(W,K),M=new E([new s,x9(G)]);if(!A(Y,M))throw g("assert",r,"chess",1612,"do_move_en_passant",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:Y,start:49553,end:49587},right:{kind:"expression",value:M,start:49595,end:49636},start:49546,end:49636,expression_start:49553});let F=n(W,J);if(!A(F,new y))throw g("assert",r,"chess",1616,"do_move_en_passant",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:F,start:49674,end:49694},right:{kind:"literal",value:new y,start:49698,end:49702},start:49667,end:49702,expression_start:49674});return new fZ(new QQ(W.white_king,W.black_king,(()=>{let H=W.other_figures,I=tZ(H,Q),q=tZ(I,K);return jZ(q,J,[new s,G])})()),Z.moving_player,new y,Z.short_castle_disqualified_white,Z.long_castle_disqualified_white,Z.short_castle_disqualified_black,Z.long_castle_disqualified_black,0,C9())}function I6(Z){let{board:Q,moving_player:J}=Z,W;if(J instanceof h)W=new v;else W=new $;let G=W,K=new B(new p,G),X=new B(new JZ,G),V=new B(new $Z,G),Y=new B(new IZ,G),M=n(Q,K),F=new E([new EQ,J]);if(!A(M,F))throw g("assert",r,"chess",1649,"do_move_short_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:M,start:50651,end:50678},right:{kind:"expression",value:F,start:50682,end:50710},start:50644,end:50710,expression_start:50651});let H=n(Q,X);if(!A(H,new y))throw g("assert",r,"chess",1651,"do_move_short_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:H,start:50747,end:50772},right:{kind:"literal",value:new y,start:50776,end:50780},start:50740,end:50780,expression_start:50747});let I=n(Q,V),q=new E([new FZ,J]);if(!A(I,q))throw g("assert",r,"chess",1652,"do_move_short_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:I,start:50813,end:50840},right:{kind:"expression",value:q,start:50844,end:50872},start:50806,end:50872,expression_start:50813});let N=n(Q,Y);if(!A(N,new y))throw g("assert",r,"chess",1654,"do_move_short_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:N,start:50909,end:50934},right:{kind:"literal",value:new y,start:50938,end:50942},start:50902,end:50942,expression_start:50909});if(J instanceof h)return new fZ(new QQ(X,Q.black_king,(()=>{let S=Q.other_figures,O=tZ(S,V);return jZ(O,Y,[new FZ,J])})()),Z.moving_player,new y,!0,!0,Z.short_castle_disqualified_black,Z.long_castle_disqualified_black,Z.fifty_move_rule_counter,(()=>{let S=Z.threefold_repetition_counter;return E9(S,k9(Z))})());else return new fZ(new QQ(Q.white_king,X,(()=>{let S=Q.other_figures,O=tZ(S,V);return jZ(O,Y,[new FZ,J])})()),Z.moving_player,new y,Z.short_castle_disqualified_white,Z.long_castle_disqualified_white,!0,!0,Z.fifty_move_rule_counter,(()=>{let S=Z.threefold_repetition_counter;return E9(S,k9(Z))})())}function z6(Z){let{board:Q,moving_player:J}=Z,W;if(J instanceof h)W=new v;else W=new $;let G=W,K=new B(new p,G),X=new B(new QZ,G),V=new B(new DZ,G),Y=new B(new RZ,G),M=new B(new BZ,G),F=n(Q,K),H=new E([new EQ,J]);if(!A(F,H))throw g("assert",r,"chess",1712,"do_move_long_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:F,start:52732,end:52759},right:{kind:"expression",value:H,start:52763,end:52791},start:52725,end:52791,expression_start:52732});let I=n(Q,X);if(!A(I,new y))throw g("assert",r,"chess",1714,"do_move_long_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:I,start:52828,end:52853},right:{kind:"literal",value:new y,start:52857,end:52861},start:52821,end:52861,expression_start:52828});let q=n(Q,V),N=new E([new FZ,J]);if(!A(q,N))throw g("assert",r,"chess",1715,"do_move_long_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:q,start:52894,end:52921},right:{kind:"expression",value:N,start:52925,end:52953},start:52887,end:52953,expression_start:52894});let S=n(Q,Y);if(!A(S,new y))throw g("assert",r,"chess",1717,"do_move_long_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:S,start:52990,end:53015},right:{kind:"literal",value:new y,start:53019,end:53023},start:52983,end:53023,expression_start:52990});let O=n(Q,M);if(!A(O,new y))throw g("assert",r,"chess",1718,"do_move_long_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:O,start:53056,end:53083},right:{kind:"literal",value:new y,start:53087,end:53091},start:53049,end:53091,expression_start:53056});if(J instanceof h)return new fZ(new QQ(X,Q.black_king,(()=>{let L=Q.other_figures,P=tZ(L,V);return jZ(P,Y,[new FZ,J])})()),Z.moving_player,new y,!0,!0,Z.short_castle_disqualified_black,Z.long_castle_disqualified_black,Z.fifty_move_rule_counter,(()=>{let L=Z.threefold_repetition_counter;return E9(L,k9(Z))})());else return new fZ(new QQ(Q.white_king,X,(()=>{let L=Q.other_figures,P=tZ(L,V);return jZ(P,Y,[new FZ,J])})()),Z.moving_player,new y,Z.short_castle_disqualified_white,Z.long_castle_disqualified_white,!0,!0,Z.fifty_move_rule_counter,(()=>{let L=Z.threefold_repetition_counter;return E9(L,k9(Z))})())}function d8(Z,Q){if(Q instanceof qQ){let{from:J,to:W}=Q;return U6(Z,J,W)}else if(Q instanceof wQ){let{from:J,to:W,new_figure:G}=Q;return F6(Z,J,W,G)}else if(Q instanceof xQ){let{from:J,to:W}=Q;return R6(Z,J,W)}else if(Q instanceof kQ)return I6(Z);else return z6(Z)}function kJ(Z,Q,J){let W;return W=i9(Q,(X)=>{let V=n(Z.board,X);return aW(V)}),qZ(!W,!1,()=>{let X;if(Z.moving_player instanceof h)X=new B(new p,new v);else X=new B(new p,new $);let Y=X,M,H=kZ(J,(N)=>{return new qQ(Y,N)}),I=kZ(H,(N)=>{return d8(Z,N)});return M=a9(I,uJ),!M})}function uJ(Z){let Q;if(Z.moving_player instanceof h)Q=Z.board.white_king;else Q=Z.board.black_king;let W=Q,G=x9(Z.moving_player),K=Z.board.other_figures,X=V9(K),V=A9(X,(H)=>{return A(H[1][1],G)}),Y=kZ(V,(H)=>{return H[0]}),M=S9(Y,(H)=>{let I=$G(new fZ(Z.board,G,Z.en_passant_possible,Z.short_castle_disqualified_white,Z.long_castle_disqualified_white,Z.short_castle_disqualified_black,Z.long_castle_disqualified_black,Z.fifty_move_rule_counter,Z.threefold_repetition_counter),H),q=g8(I,L9);return xJ(q,R([]))}),F=CJ(M,(H)=>{if(H instanceof hZ){let I=H.to;return new x(I)}else if(H instanceof NQ){let I=H.to;return new x(I)}else if(H instanceof DQ)return new b(void 0);else if(H instanceof OQ)return new b(void 0);else return new b(void 0)});return a9(F,(H)=>{return A(H,W)})}function $G(Z,Q){let J,W=n(Z.board,Q);return J=tW(W,new yG),CQ(J,(K)=>{let X,V;return X=K[0],V=K[1],qZ(!A(V,Z.moving_player),new b(new bG),()=>{let Y;if(X instanceof s)Y=G6(Z,Q);else if(X instanceof oZ)Y=X6(Z.board,Q,Z.moving_player);else if(X instanceof uZ)Y=Y6(Z.board,Q,Z.moving_player);else if(X instanceof FZ)Y=V6(Z.board,Q,Z.moving_player);else if(X instanceof JQ)Y=M6(Z.board,Q,Z.moving_player);else Y=q6(Z,Q);return new x(Y)})})}function q6(Z,Q){let J,W=R([[0,1],[1,1],[1,0],[1,-1],[0,-1],[-1,-1],[-1,0],[-1,1]]),G=_Z(W),K=EZ(G,(T)=>{return new gJ(Q,T,Z.moving_player)}),X=EZ(K,(T)=>{return XJ(Z.board,T)}),V=rQ(X,CZ(),iQ);J=EZ(V,(T)=>{return new hZ(T)});let Y=J,M;if(N6(Z))M=new E(new OQ);else M=new y;let H=M,I;if(B6(Z))I=new E(new c8);else I=new y;let N=I,S,O=R([H,N]),L=W9(O),P=_Z(L);return S=iQ(P,Y),S}function N6(Z){if(Z.moving_player instanceof h)return qZ(Z.short_castle_disqualified_white,!1,()=>{let J=n(Z.board,new B(new p,new v)),W=new E([new EQ,new h]);if(!A(J,W))throw g("assert",r,"chess",1080,"can_short_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:J,start:32415,end:32461},right:{kind:"literal",value:W,start:32473,end:32493},start:32408,end:32493,expression_start:32415});let G=n(Z.board,new B(new $Z,new v)),K=new E([new FZ,new h]);if(!A(G,K))throw g("assert",r,"chess",1084,"can_short_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:G,start:32539,end:32585},right:{kind:"literal",value:K,start:32597,end:32617},start:32532,end:32617,expression_start:32539});return kJ(Z,R([new B(new IZ,new v),new B(new JZ,new v)]),R([new B(new p,new v),new B(new IZ,new v),new B(new JZ,new v)]))});else return qZ(Z.short_castle_disqualified_black,!1,()=>{let J=n(Z.board,new B(new p,new $)),W=new E([new EQ,new XZ]);if(!A(J,W))throw g("assert",r,"chess",1106,"can_short_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:J,start:33208,end:33254},right:{kind:"literal",value:W,start:33266,end:33286},start:33201,end:33286,expression_start:33208});let G=n(Z.board,new B(new $Z,new $)),K=new E([new FZ,new XZ]);if(!A(G,K))throw g("assert",r,"chess",1110,"can_short_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:G,start:33332,end:33378},right:{kind:"literal",value:K,start:33390,end:33410},start:33325,end:33410,expression_start:33332});return kJ(Z,R([new B(new IZ,new $),new B(new JZ,new $)]),R([new B(new p,new $),new B(new IZ,new $),new B(new JZ,new $)]))})}function $J(Z){return uJ(Z.internal)}function s8(Z,Q){return CQ($G(Z,Q),(J)=>{let G=SG(J,(K)=>{let X;if(K instanceof hZ){let H=K.to;X=new qQ(Q,H)}else if(K instanceof NQ){let H=K.to;X=new wQ(Q,H,new JQ)}else if(K instanceof DQ){let H=K.to;X=new xQ(Q,H)}else if(K instanceof OQ)X=new kQ;else X=new fJ;let M=d8(Z,X),F=uJ(M);return sW(F)});return new x(G)})}function mG(Z,Q){let J=Z.status;if(J instanceof yQ)return new b(new hG);else{let W=Z.internal,G=J.next_player,K=W.moving_player;if(!A(K,G))throw g("assert",r,"chess",486,"get_moves",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:K,start:14480,end:14498},right:{kind:"expression",value:G,start:14502,end:14515},start:14473,end:14515,expression_start:14480});let X=s8(W,Q);return Y9(X,(V)=>{return new vG(V)})}}function cG(Z){let Q;if(Z.moving_player instanceof h)Q=Z.board.white_king;else Q=Z.board.black_king;let W=Q,G,K=Z.board.other_figures,X=V9(K),V=CJ(X,(N)=>{let S,O;if(S=N[0],O=N[1][1],A(O,Z.moving_player))return new x(S);else return new b(void 0)});G=P9(V,R([W]));let Y=G,M,H=kZ(Y,(N)=>{let S,O=s8(Z,N);return S=T9(O,()=>{throw g("panic",r,"chess",821,"get_all_moves_internal",t,{})}),[N,S]}),I=A9(H,(N)=>{let S;return S=N[1],!PG(S)});return M=K9(I),M}function pG(Z){let Q=Z.status;if(Q instanceof yQ)return new b(void 0);else{let J=Z.internal,W=Q.next_player,G=J.moving_player;if(!A(G,W))throw g("assert",r,"chess",508,"get_all_moves",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:G,start:15284,end:15302},right:{kind:"expression",value:W,start:15306,end:15319},start:15277,end:15319,expression_start:15284});return new x(cG(J))}}function D6(Z){let Q=x9(Z.moving_player),J=new fZ(Z.board,Q,Z.en_passant_possible,Z.short_castle_disqualified_white,Z.long_castle_disqualified_white,Z.short_castle_disqualified_black,Z.long_castle_disqualified_black,Z.fifty_move_rule_counter,Z.threefold_repetition_counter),W,G=cG(J);W=b8(G);let K=W,X=uJ(J);if(K)if(X)return new E(new yJ(Z.moving_player,new bJ));else return new E(new WJ(new EG));else return new y}function O6(Z){let Q;if(Q6(Z.board))Q=new E(new WJ(new wG));else Q=new y;return l9(Q,()=>{let G=D6(Z);return l9(G,()=>{let K;if(H6(Z))K=new E(new WJ(new xG));else K=new y;return l9(K,()=>{let Y;if(eX(Z))Y=new E(new WJ(new kG));else Y=new y;return l9(Y,()=>{return new y})})})})}function j6(Z,Q){{let J,W;{let X;if(Q instanceof qQ)X=Q.from;else if(Q instanceof wQ)X=Q.from;else if(Q instanceof xQ)X=Q.from;else if(Q instanceof kQ)if(Z.moving_player instanceof h)X=new B(new p,new v);else X=new B(new p,new $);else if(Z.moving_player instanceof h)X=new B(new p,new v);else X=new B(new p,new $);W=s8(Z,X)}return J=Y9(W,(X)=>{return new vJ(X)}),CQ(J,(X)=>{let V;{let M;if(Q instanceof qQ){let H=Q.to;M=new hZ(H)}else if(Q instanceof wQ){let H=Q.to;M=new NQ(H)}else if(Q instanceof xQ){let H=Q.to;M=new DQ(H)}else if(Q instanceof kQ)M=new OQ;else M=new c8;V=ZJ(X,M)}return qZ(!V,new b(new fG),()=>{let M=d8(Z,Q),F,H=O6(M);if(H instanceof E){let N=H[0];F=new yQ(N)}else F=new GJ(x9(M.moving_player));let I=F,q=new fZ(M.board,x9(M.moving_player),M.en_passant_possible,M.short_castle_disqualified_white,M.long_castle_disqualified_white,M.short_castle_disqualified_black,M.long_castle_disqualified_black,M.fifty_move_rule_counter,M.threefold_repetition_counter);return new x([q,I])})})}}function mJ(Z,Q){let J=Z.status;if(J instanceof yQ)return new b(new hJ);else{let W=Z.internal,G=J.next_player,K=W.moving_player;if(!A(K,G))throw g("assert",r,"chess",418,"player_move",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:K,start:12251,end:12278},right:{kind:"expression",value:G,start:12282,end:12295},start:12244,end:12295,expression_start:12251});return CQ(j6(W,Q),(X)=>{let V,Y;return V=X[0],Y=X[1],new x(new m8(V,(()=>{let M=Z.history;return P9(M,R([[Q,G]]))})(),Y,Z.starting_position))})}}function B6(Z){if(Z.moving_player instanceof h)return qZ(Z.long_castle_disqualified_white,!1,()=>{let J=n(Z.board,new B(new p,new v)),W=new E([new EQ,new h]);if(!A(J,W))throw g("assert",r,"chess",1138,"can_long_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:J,start:34151,end:34197},right:{kind:"literal",value:W,start:34209,end:34229},start:34144,end:34229,expression_start:34151});let G=n(Z.board,new B(new DZ,new v)),K=new E([new FZ,new h]);if(!A(G,K))throw g("assert",r,"chess",1142,"can_long_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:G,start:34275,end:34321},right:{kind:"literal",value:K,start:34333,end:34353},start:34268,end:34353,expression_start:34275});return kJ(Z,R([new B(new RZ,new v),new B(new QZ,new v),new B(new BZ,new v)]),R([new B(new p,new v),new B(new RZ,new v),new B(new QZ,new v)]))});else return qZ(Z.long_castle_disqualified_black,!1,()=>{let J=n(Z.board,new B(new p,new $)),W=new E([new EQ,new XZ]);if(!A(J,W))throw g("assert",r,"chess",1168,"can_long_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:J,start:35009,end:35055},right:{kind:"literal",value:W,start:35067,end:35087},start:35002,end:35087,expression_start:35009});let G=n(Z.board,new B(new DZ,new $)),K=new E([new FZ,new XZ]);if(!A(G,K))throw g("assert",r,"chess",1172,"can_long_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:G,start:35133,end:35179},right:{kind:"literal",value:K,start:35191,end:35211},start:35126,end:35211,expression_start:35133});return kJ(Z,R([new B(new RZ,new $),new B(new QZ,new $),new B(new BZ,new $)]),R([new B(new p,new $),new B(new RZ,new $),new B(new QZ,new $)]))})}function OZ(Z){return Z}var eZ=()=>globalThis?.document,pJ="http://www.w3.org/1999/xhtml",dJ=1,n8=3;var nG=!!globalThis.HTMLElement?.prototype?.moveBefore;var _=R([]),sJ=new y;var w6=new TQ,x6=new GZ,k6=new KZ;function lJ(Z,Q){if(Z.name===Q.name)return k6;else if(Z.name<Q.name)return x6;else return w6}class jQ extends U{constructor(Z,Q,J){super();this.kind=Z,this.name=Q,this.value=J}}class nJ extends U{constructor(Z,Q,J){super();this.kind=Z,this.name=Q,this.value=J}}class mZ extends U{constructor(Z,Q,J,W,G,K,X,V,Y){super();this.kind=Z,this.name=Q,this.handler=J,this.include=W,this.prevent_default=G,this.stop_propagation=K,this.immediate=X,this.debounce=V,this.throttle=Y}}class YJ extends U{constructor(Z,Q,J){super();this.prevent_default=Z,this.stop_propagation=Q,this.message=J}}class oG extends U{constructor(Z){super();this.kind=Z}}function g6(Z,Q){while(!0){let J=Z,W=Q;if(J instanceof j)return W;else{let G=J.head;if(G instanceof jQ){let K=G.name;if(K==="")Z=J.tail,Q=W;else if(K==="class"){let X=G.value;if(X==="")Z=J.tail,Q=W;else{let V=J.tail;if(V instanceof j){let Y=G;Z=V,Q=D(Y,W)}else{let Y=V.head;if(Y instanceof jQ)if(Y.name==="class"){let F=G.kind,H=X,I=V.tail,q=Y.value,N=H+" "+q,S=new jQ(F,"class",N);Z=D(S,I),Q=W}else{let F=G;Z=V,Q=D(F,W)}else{let M=G;Z=V,Q=D(M,W)}}}}else if(K==="style"){let X=G.value;if(X==="")Z=J.tail,Q=W;else{let V=J.tail;if(V instanceof j){let Y=G;Z=V,Q=D(Y,W)}else{let Y=V.head;if(Y instanceof jQ)if(Y.name==="style"){let F=G.kind,H=X,I=V.tail,q=Y.value,N=H+";"+q,S=new jQ(F,"style",N);Z=D(S,I),Q=W}else{let F=G;Z=V,Q=D(F,W)}else{let M=G;Z=V,Q=D(M,W)}}}}else{let X=G;Z=J.tail,Q=D(X,W)}}else{let K=G;Z=J.tail,Q=D(K,W)}}}}function eG(Z){if(Z instanceof j)return Z;else if(Z.tail instanceof j)return Z;else{let W=UG(Z,(G,K)=>{return lJ(K,G)});return g6(W,_)}}var a8=0;function Z0(Z,Q){return new jQ(a8,Z,Q)}var Q0=1;var t8=2;function J0(Z,Q,J,W,G,K,X,V){return new mZ(t8,Z,Q,J,W,G,K,X,V)}var o8=0;var e8=new oG(o8);var ZW=2;function hQ(Z,Q){return Z0(Z,Q)}function PZ(Z){return hQ("class",Z)}function W0(Z,Q){while(!0){let J=Z,W=Q;if(J instanceof j)return W;else if(J.head[1]){let K=J.tail,X=J.head[0];return W+X+" "+W0(K,W)}else Z=J.tail,Q=W}}function f9(Z){return PZ(W0(Z,""))}function rJ(Z){return hQ("draggable",(()=>{if(Z)return"true";else return"false"})())}function iJ(Z){return hQ("href",Z)}function aJ(Z){return hQ("target",Z)}function tJ(Z){return hQ("alt",Z)}function oJ(Z){return hQ("src",Z)}class Z8 extends U{constructor(Z,Q,J){super();this.synchronous=Z,this.before_paint=Q,this.after_paint=J}}class G0 extends U{constructor(Z,Q,J,W,G){super();this.dispatch=Z,this.emit=Q,this.select=J,this.root=W,this.provide=G}}function K0(Z,Q,J,W,G,K){let X=new G0(Q,J,W,G,K);return FG(Z.synchronous,(V)=>{return V(X)})}var eJ=new Z8(R([]),R([]),R([]));function MJ(){return eJ}function X0(Z){return new Z8(R([(J)=>{let W=J.dispatch;return Z(W)}]),eJ.before_paint,eJ.after_paint)}function V0(Z){return LZ(Z,eJ,(Q,J)=>{return new Z8(LZ(J.synchronous,Q.synchronous,EJ),LZ(J.before_paint,Q.before_paint,EJ),LZ(J.after_paint,Q.after_paint,EJ))})}function lZ(){return null}function HJ(Z,Q){let J=Z?.get(Q);if(J!=null)return new x(J);else return new b(void 0)}function UJ(Z,Q){return Z&&Z.has(Q)}function M9(Z,Q,J){return Z??=new Map,Z.set(Q,J),Z}function QW(Z,Q){return Z?.delete(Q),Z}class JW extends U{}class WW extends U{constructor(Z,Q){super();this.key=Z,this.parent=Q}}class Y0 extends U{constructor(Z,Q){super();this.index=Z,this.parent=Q}}function m6(Z,Q){while(!0){let J=Z,W=Q;if(W instanceof j)return!1;else{let{head:G,tail:K}=W,X=f8(J,G);if(X)return X;else Z=J,Q=K}}}function GQ(Z,Q,J){if(J==="")return new Y0(Q,Z);else return new WW(J,Z)}var Q8=new JW,RJ="\t";function M0(Z,Q){while(!0){let J=Z,W=Q;if(J instanceof JW)if(W instanceof j)return"";else{let G=W.tail;return IG(G)}else if(J instanceof WW){let G=J.key;Z=J.parent,Q=D(RJ,D(G,W))}else{let G=J.index;Z=J.parent,Q=D(RJ,D(lQ(G),W))}}}function c6(Z){return M0(Z,R([]))}function H0(Z,Q){if(Q instanceof j)return!1;else return m6(c6(Z),Q)}var GW=`
`;function KW(Z,Q){return M0(Z,R([GW,Q]))}class KQ extends U{constructor(Z,Q,J,W,G){super();this.kind=Z,this.key=Q,this.mapper=J,this.children=W,this.keyed_children=G}}class XQ extends U{constructor(Z,Q,J,W,G,K,X,V,Y,M){super();this.kind=Z,this.key=Q,this.mapper=J,this.namespace=W,this.tag=G,this.attributes=K,this.children=X,this.keyed_children=V,this.self_closing=Y,this.void=M}}class VQ extends U{constructor(Z,Q,J,W){super();this.kind=Z,this.key=Q,this.mapper=J,this.content=W}}class v9 extends U{constructor(Z,Q,J,W,G,K,X){super();this.kind=Z,this.key=Q,this.mapper=J,this.namespace=W,this.tag=G,this.attributes=K,this.inner_html=X}}function s6(Z,Q){if(Q==="")if(Z==="area")return!0;else if(Z==="base")return!0;else if(Z==="br")return!0;else if(Z==="col")return!0;else if(Z==="embed")return!0;else if(Z==="hr")return!0;else if(Z==="img")return!0;else if(Z==="input")return!0;else if(Z==="link")return!0;else if(Z==="meta")return!0;else if(Z==="param")return!0;else if(Z==="source")return!0;else if(Z==="track")return!0;else if(Z==="wbr")return!0;else return!1;else return!1}function F0(Z,Q){if(Q instanceof KQ)return new KQ(Q.kind,Z,Q.mapper,Q.children,Q.keyed_children);else if(Q instanceof XQ)return new XQ(Q.kind,Z,Q.mapper,Q.namespace,Q.tag,Q.attributes,Q.children,Q.keyed_children,Q.self_closing,Q.void);else if(Q instanceof VQ)return new VQ(Q.kind,Z,Q.mapper,Q.content);else return new v9(Q.kind,Z,Q.mapper,Q.namespace,Q.tag,Q.attributes,Q.inner_html)}var YQ=0;function XW(Z,Q,J,W){return new KQ(YQ,Z,Q,J,W)}var H9=1;function IJ(Z,Q,J,W,G,K,X,V,Y){return new XQ(H9,Z,Q,J,W,eG(G),K,X,V,Y||s6(W,J))}var g9=2;function VW(Z,Q,J){return new VQ(g9,Z,Q,J)}var R0=3;var YW=(Z,Q)=>Z===Q,F9=(Z,Q)=>{if(Z===Q)return!0;if(Z==null||Q==null)return!1;let J=typeof Z;if(J!==typeof Q)return!1;if(J!=="object")return!1;if(Z.constructor!==Q.constructor)return!1;if(Array.isArray(Z))return l6(Z,Q);return n6(Z,Q)},l6=(Z,Q)=>{let J=Z.length;if(J!==Q.length)return!1;while(J--)if(!F9(Z[J],Q[J]))return!1;return!0},n6=(Z,Q)=>{let J=Object.keys(Z),W=J.length;if(Object.keys(Q).length!==W)return!1;while(W--){let G=J[W];if(!Object.hasOwn(Q,G))return!1;if(!F9(Z[G],Q[G]))return!1}return!0};class gQ extends U{constructor(Z,Q,J){super();this.handlers=Z,this.dispatched_paths=Q,this.next_dispatched_paths=J}}function HW(){return new gQ(lZ(),_,_)}function N0(Z){return new gQ(Z.handlers,Z.next_dispatched_paths,_)}function D0(Z,Q,J){return QW(Z,KW(Q,J))}function zJ(Z,Q,J){let W=D0(Z.handlers,Q,J);return new gQ(W,Z.dispatched_paths,Z.next_dispatched_paths)}function I0(Z,Q,J){return LZ(J,Z,(W,G)=>{if(G instanceof mZ){let K=G.name;return D0(W,Q,K)}else return W})}function qJ(Z,Q,J,W){let G=D(Q,Z.next_dispatched_paths),K=new gQ(Z.handlers,Z.dispatched_paths,G),X=HJ(K.handlers,Q+GW+J);if(X instanceof x){let V=X[0];return[K,X9(W,V)]}else return[K,new b(R([]))]}function J8(Z,Q){return H0(Q,Z.dispatched_paths)}function O0(Z,Q,J,W,G){return M9(Z,KW(J,W),wJ(G,(K)=>{return new YJ(K.prevent_default,K.stop_propagation,OZ(Q)(K.message))}))}function NJ(Z,Q,J,W,G){let K=O0(Z.handlers,Q,J,W,G);return new gQ(K,Z.dispatched_paths,Z.next_dispatched_paths)}function z0(Z,Q,J,W){return LZ(W,Z,(G,K)=>{if(K instanceof mZ){let{name:X,handler:V}=K;return O0(G,Q,J,X,V)}else return G})}function aQ(Z,Q){let J=YW(Z,OZ);if(YW(Q,OZ))return Z;else if(J)return Q;else return(G)=>{return Z(Q(G))}}function q0(Z,Q,J,W){while(!0){let G=Z,K=Q,X=J,V=W;if(V instanceof j)return G;else{let{head:Y,tail:M}=V;Z=j0(G,K,X,Y),Q=K,J=X+1,W=M}}}function j0(Z,Q,J,W){if(W instanceof KQ){let G=W.children,K=GQ(Q,J,W.key);return q0(Z,K,0,G)}else if(W instanceof XQ){let{attributes:G,children:K}=W,X=GQ(Q,J,W.key),Y=I0(Z,X,G);return q0(Y,X,0,K)}else if(W instanceof VQ)return Z;else{let G=W.attributes,K=GQ(Q,J,W.key);return I0(Z,K,G)}}function _Q(Z,Q,J,W){let G=j0(Z.handlers,Q,J,W);return new gQ(G,Z.dispatched_paths,Z.next_dispatched_paths)}function MW(Z,Q,J,W,G){while(!0){let K=Z,X=Q,V=J,Y=W,M=G;if(M instanceof j)return K;else{let{head:F,tail:H}=M;Z=B0(K,X,V,Y,F),Q=X,J=V,W=Y+1,G=H}}}function B0(Z,Q,J,W,G){if(G instanceof KQ){let K=G.children,X=GQ(J,W,G.key),V=aQ(Q,G.mapper);return MW(Z,V,X,0,K)}else if(G instanceof XQ){let{attributes:K,children:X}=G,V=GQ(J,W,G.key),Y=aQ(Q,G.mapper),F=z0(Z,Y,V,K);return MW(F,Y,V,0,X)}else if(G instanceof VQ)return Z;else{let K=G.attributes,X=GQ(J,W,G.key),V=aQ(Q,G.mapper);return z0(Z,V,X,K)}}function uQ(Z,Q,J,W,G){let K=B0(Z.handlers,Q,J,W,G);return new gQ(K,Z.dispatched_paths,Z.next_dispatched_paths)}function A0(Z){return uQ(HW(),OZ,Q8,0,Z)}function P0(Z,Q,J,W,G){let K=MW(Z.handlers,Q,J,W,G);return new gQ(K,Z.dispatched_paths,Z.next_dispatched_paths)}function $Q(Z,Q,J){return IJ("",OZ,"",Z,Q,J,lZ(),!1,!1)}function W8(Z){return VW("",OZ,Z)}function S0(){return VW("",OZ,"")}function BQ(Z){return W8(Z)}function T0(Z,Q){return $Q("body",Z,Q)}function L0(Z,Q){return $Q("aside",Z,Q)}function C0(Z,Q){return $Q("main",Z,Q)}function oQ(Z,Q){return $Q("div",Z,Q)}function u9(Z,Q){return $Q("p",Z,Q)}function G8(Z,Q){return $Q("a",Z,Q)}function K8(Z){return $Q("img",Z,_)}class OJ extends U{constructor(Z,Q,J,W){super();this.index=Z,this.removed=Q,this.changes=J,this.children=W}}class E0 extends U{constructor(Z,Q){super();this.kind=Z,this.content=Q}}class w0 extends U{constructor(Z,Q){super();this.kind=Z,this.inner_html=Q}}class x0 extends U{constructor(Z,Q,J){super();this.kind=Z,this.added=Q,this.removed=J}}class k0 extends U{constructor(Z,Q,J){super();this.kind=Z,this.key=Q,this.before=J}}class y0 extends U{constructor(Z,Q,J){super();this.kind=Z,this.index=Q,this.with=J}}class b0 extends U{constructor(Z,Q){super();this.kind=Z,this.index=Q}}class f0 extends U{constructor(Z,Q,J){super();this.kind=Z,this.children=Q,this.before=J}}function UW(Z,Q,J,W){return new OJ(Z,Q,J,W)}var FW=0;function h0(Z){return new E0(FW,Z)}var RW=1;function v0(Z){return new w0(RW,Z)}var IW=2;function zW(Z,Q){return new x0(IW,Z,Q)}var qW=3;function g0(Z,Q){return new k0(qW,Z,Q)}var NW=4;function _0(Z){return new b0(NW,Z)}var DW=5;function R9(Z,Q){return new y0(DW,Z,Q)}var OW=6;function jW(Z,Q){return new f0(OW,Z,Q)}class $0 extends U{constructor(Z,Q,J,W,G,K,X,V){super();this.kind=Z,this.open_shadow_root=Q,this.will_adopt_styles=J,this.observed_attributes=W,this.observed_properties=G,this.requested_contexts=K,this.provided_contexts=X,this.vdom=V}}class m0 extends U{constructor(Z,Q){super();this.kind=Z,this.patch=Q}}class c0 extends U{constructor(Z,Q,J){super();this.kind=Z,this.name=Q,this.data=J}}class p0 extends U{constructor(Z,Q,J){super();this.kind=Z,this.key=Q,this.value=J}}class X8 extends U{constructor(Z,Q){super();this.kind=Z,this.messages=Q}}class V8 extends U{constructor(Z,Q,J){super();this.kind=Z,this.name=Q,this.value=J}}class Y8 extends U{constructor(Z,Q,J){super();this.kind=Z,this.name=Q,this.value=J}}class M8 extends U{constructor(Z,Q,J,W){super();this.kind=Z,this.path=Q,this.name=J,this.event=W}}class BW extends U{constructor(Z,Q,J){super();this.kind=Z,this.key=Q,this.value=J}}var o6=0;function d0(Z,Q,J,W,G,K,X){return new $0(o6,Z,Q,J,W,G,K,X)}var e6=1;function AW(Z){return new m0(e6,Z)}var Z7=2;function s0(Z,Q){return new c0(Z7,Z,Q)}var Q7=3;function l0(Z,Q){return new p0(Q7,Z,Q)}class H8 extends U{constructor(Z,Q){super();this.patch=Z,this.events=Q}}class i0 extends U{constructor(Z,Q,J){super();this.added=Z,this.removed=Q,this.events=J}}function J7(Z,Q,J,W){if(J==="input"&&Q==="")return J8(Z,W);else if(J==="select"&&Q==="")return J8(Z,W);else if(J==="textarea"&&Q==="")return J8(Z,W);else return!1}function r0(Z,Q,J,W,G,K,X,V){while(!0){let Y=Z,M=Q,F=J,H=W,I=G,q=K,N=X,S=V;if(q instanceof j)if(I instanceof j)return new i0(N,S,H);else{let O=I.head;if(O instanceof mZ){let L=O,P=I.tail,k=O.name,T=D(L,S),z=zJ(H,M,k);Z=Y,Q=M,J=F,W=z,G=P,K=q,X=N,V=T}else{let L=O,P=I.tail,k=D(L,S);Z=Y,Q=M,J=F,W=H,G=P,K=q,X=N,V=k}}else if(I instanceof j){let O=q.head;if(O instanceof mZ){let L=O,P=q.tail,k=O.name,T=O.handler,z=D(L,N),w=NJ(H,F,M,k,T);Z=Y,Q=M,J=F,W=w,G=I,K=P,X=z,V=S}else{let L=O,P=q.tail,k=D(L,N);Z=Y,Q=M,J=F,W=H,G=I,K=P,X=k,V=S}}else{let{head:O,tail:L}=q,P=I.head,k=I.tail,T=lJ(P,O);if(T instanceof GZ)if(P instanceof mZ){let z=P.name,w=D(P,S),C=zJ(H,M,z);Z=Y,Q=M,J=F,W=C,G=k,K=q,X=N,V=w}else{let z=D(P,S);Z=Y,Q=M,J=F,W=H,G=k,K=q,X=N,V=z}else if(T instanceof KZ)if(O instanceof jQ)if(P instanceof jQ){let z,w=O.name;if(w==="value")z=Y||P.value!==O.value;else if(w==="checked")z=Y||P.value!==O.value;else if(w==="selected")z=Y||P.value!==O.value;else z=P.value!==O.value;let C=z,f;if(C)f=D(O,N);else f=N;let m=f;Z=Y,Q=M,J=F,W=H,G=k,K=L,X=m,V=S}else if(P instanceof mZ){let z=P.name,w=D(O,N),C=D(P,S),f=zJ(H,M,z);Z=Y,Q=M,J=F,W=f,G=k,K=L,X=w,V=C}else{let z=D(O,N),w=D(P,S);Z=Y,Q=M,J=F,W=H,G=k,K=L,X=z,V=w}else if(O instanceof nJ)if(P instanceof nJ){let z,w=O.name;if(w==="scrollLeft")z=!0;else if(w==="scrollRight")z=!0;else if(w==="value")z=Y||!F9(P.value,O.value);else if(w==="checked")z=Y||!F9(P.value,O.value);else if(w==="selected")z=Y||!F9(P.value,O.value);else z=!F9(P.value,O.value);let C=z,f;if(C)f=D(O,N);else f=N;let m=f;Z=Y,Q=M,J=F,W=H,G=k,K=L,X=m,V=S}else if(P instanceof mZ){let z=P.name,w=D(O,N),C=D(P,S),f=zJ(H,M,z);Z=Y,Q=M,J=F,W=f,G=k,K=L,X=w,V=C}else{let z=D(O,N),w=D(P,S);Z=Y,Q=M,J=F,W=H,G=k,K=L,X=z,V=w}else if(P instanceof mZ){let{name:z,handler:w}=O,C=P.prevent_default.kind!==O.prevent_default.kind||P.stop_propagation.kind!==O.stop_propagation.kind||P.immediate!==O.immediate||P.debounce!==O.debounce||P.throttle!==O.throttle,f;if(C)f=D(O,N);else f=N;let m=f,c=NJ(H,F,M,z,w);Z=Y,Q=M,J=F,W=c,G=k,K=L,X=m,V=S}else{let{name:z,handler:w}=O,C=D(O,N),f=D(P,S),m=NJ(H,F,M,z,w);Z=Y,Q=M,J=F,W=m,G=k,K=L,X=C,V=f}else if(O instanceof mZ){let{name:z,handler:w}=O,C=D(O,N),f=NJ(H,F,M,z,w);Z=Y,Q=M,J=F,W=f,G=I,K=L,X=C,V=S}else{let z=D(O,N);Z=Y,Q=M,J=F,W=H,G=I,K=L,X=z,V=S}}}}function PW(Z,Q,J,W,G,K,X,V,Y,M,F,H,I,q){while(!0){let N=Z,S=Q,O=J,L=W,P=G,k=K,T=X,z=V,w=Y,C=M,f=F,m=H,c=I,VZ=q;if(O instanceof j)if(N instanceof j)return new H8(new OJ(w,T,f,m),VZ);else{let{head:vZ,tail:AQ}=N,YZ;if(vZ.key===""||!UJ(P,vZ.key))YZ=T+1;else YZ=T;let u=YZ,ZZ=_Q(VZ,C,z,vZ);Z=AQ,Q=S,J=O,W=L,G=P,K=k,X=u,V=z,Y=w,M=C,F=f,H=m,I=c,q=ZZ}else if(N instanceof j){let vZ=P0(VZ,c,C,z,O),AQ=jW(O,z-k),YZ=D(AQ,f);return new H8(new OJ(w,T,YZ,m),vZ)}else{let vZ=O.head,AQ=N.head;if(AQ.key!==vZ.key){let YZ=O.tail,WZ=N.tail,u=HJ(S,vZ.key),ZZ=UJ(L,AQ.key);if(u instanceof x)if(ZZ){let l=u[0];if(UJ(P,AQ.key))Z=WZ,Q=S,J=O,W=L,G=P,K=k-1,X=T,V=z,Y=w,M=C,F=f,H=m,I=c,q=VZ;else{let o=z-k,d=D(g0(vZ.key,o),f),MZ=M9(P,vZ.key,void 0),a=k+1;Z=D(l,N),Q=S,J=O,W=L,G=MZ,K=a,X=T,V=z,Y=w,M=C,F=d,H=m,I=c,q=VZ}}else{let l=z-k,i=D(_0(l),f),o=_Q(VZ,C,z,AQ),d=k-1;Z=WZ,Q=S,J=O,W=L,G=P,K=d,X=T,V=z,Y=w,M=C,F=i,H=m,I=c,q=o}else if(ZZ){let l=z-k,i=uQ(VZ,c,C,z,vZ),o=jW(R([vZ]),l),d=D(o,f);Z=N,Q=S,J=YZ,W=L,G=P,K=k+1,X=T,V=z+1,Y=w,M=C,F=d,H=m,I=c,q=i}else{let l=R9(z-k,vZ),i,d=_Q(VZ,C,z,AQ);i=uQ(d,c,C,z,vZ);let MZ=i;Z=WZ,Q=S,J=YZ,W=L,G=P,K=k,X=T,V=z+1,Y=w,M=C,F=D(l,f),H=m,I=c,q=MZ}}else{let YZ=N.head;if(YZ instanceof KQ){let WZ=O.head;if(WZ instanceof KQ){let u=WZ,ZZ=O.tail,l=YZ,i=N.tail,o=aQ(c,u.mapper),d=GQ(C,z,u.key),MZ=PW(l.children,l.keyed_children,u.children,u.keyed_children,lZ(),0,0,0,z,d,_,_,o,VZ),a,zZ=MZ.patch;if(zZ.children instanceof j)if(zZ.changes instanceof j)if(zZ.removed===0)a=m;else a=D(MZ.patch,m);else a=D(MZ.patch,m);else a=D(MZ.patch,m);let MQ=a;Z=i,Q=S,J=ZZ,W=L,G=P,K=k,X=T,V=z+1,Y=w,M=C,F=f,H=MQ,I=c,q=MZ.events}else{let u=WZ,ZZ=O.tail,l=YZ,i=N.tail,o=R9(z-k,u),d,a=_Q(VZ,C,z,l);d=uQ(a,c,C,z,u);let zZ=d;Z=i,Q=S,J=ZZ,W=L,G=P,K=k,X=T,V=z+1,Y=w,M=C,F=D(o,f),H=m,I=c,q=zZ}}else if(YZ instanceof XQ){let WZ=O.head;if(WZ instanceof XQ){let u=WZ,ZZ=YZ;if(ZZ.namespace===u.namespace&&ZZ.tag===u.tag){let l=O.tail,i=N.tail,o=aQ(c,u.mapper),d=GQ(C,z,u.key),MZ=J7(VZ,u.namespace,u.tag,d),a=r0(MZ,d,o,VZ,ZZ.attributes,u.attributes,_,_),zZ,PQ,MQ;zZ=a.added,PQ=a.removed,MQ=a.events;let Q9;if(PQ instanceof j&&zZ instanceof j)Q9=_;else Q9=R([zW(zZ,PQ)]);let N9=Q9,D9=PW(ZZ.children,ZZ.keyed_children,u.children,u.keyed_children,lZ(),0,0,0,z,d,N9,_,o,MQ),pQ,J9=D9.patch;if(J9.children instanceof j)if(J9.changes instanceof j)if(J9.removed===0)pQ=m;else pQ=D(D9.patch,m);else pQ=D(D9.patch,m);else pQ=D(D9.patch,m);let mK=pQ;Z=i,Q=S,J=l,W=L,G=P,K=k,X=T,V=z+1,Y=w,M=C,F=f,H=mK,I=c,q=D9.events}else{let l=WZ,i=O.tail,o=YZ,d=N.tail,MZ=R9(z-k,l),a,PQ=_Q(VZ,C,z,o);a=uQ(PQ,c,C,z,l);let MQ=a;Z=d,Q=S,J=i,W=L,G=P,K=k,X=T,V=z+1,Y=w,M=C,F=D(MZ,f),H=m,I=c,q=MQ}}else{let u=WZ,ZZ=O.tail,l=YZ,i=N.tail,o=R9(z-k,u),d,a=_Q(VZ,C,z,l);d=uQ(a,c,C,z,u);let zZ=d;Z=i,Q=S,J=ZZ,W=L,G=P,K=k,X=T,V=z+1,Y=w,M=C,F=D(o,f),H=m,I=c,q=zZ}}else if(YZ instanceof VQ){let WZ=O.head;if(WZ instanceof VQ){let u=WZ;if(YZ.content===u.content){let l=O.tail;Z=N.tail,Q=S,J=l,W=L,G=P,K=k,X=T,V=z+1,Y=w,M=C,F=f,H=m,I=c,q=VZ}else{let l=WZ,i=O.tail,o=N.tail,d=UW(z,0,R([h0(l.content)]),_);Z=o,Q=S,J=i,W=L,G=P,K=k,X=T,V=z+1,Y=w,M=C,F=f,H=D(d,m),I=c,q=VZ}}else{let u=WZ,ZZ=O.tail,l=YZ,i=N.tail,o=R9(z-k,u),d,a=_Q(VZ,C,z,l);d=uQ(a,c,C,z,u);let zZ=d;Z=i,Q=S,J=ZZ,W=L,G=P,K=k,X=T,V=z+1,Y=w,M=C,F=D(o,f),H=m,I=c,q=zZ}}else{let WZ=O.head;if(WZ instanceof v9){let u=WZ,ZZ=O.tail,l=YZ,i=N.tail,o=aQ(c,u.mapper),d=GQ(C,z,u.key),MZ=r0(!1,d,o,VZ,l.attributes,u.attributes,_,_),a,zZ,PQ;a=MZ.added,zZ=MZ.removed,PQ=MZ.events;let MQ;if(zZ instanceof j&&a instanceof j)MQ=_;else MQ=R([zW(a,zZ)]);let Q9=MQ,N9;if(l.inner_html===u.inner_html)N9=Q9;else N9=D(v0(u.inner_html),Q9);let pQ=N9,J9;if(pQ instanceof j)J9=m;else J9=D(UW(z,0,pQ,R([])),m);let dW=J9;Z=i,Q=S,J=ZZ,W=L,G=P,K=k,X=T,V=z+1,Y=w,M=C,F=f,H=dW,I=c,q=PQ}else{let u=WZ,ZZ=O.tail,l=YZ,i=N.tail,o=R9(z-k,u),d,a=_Q(VZ,C,z,l);d=uQ(a,c,C,z,u);let zZ=d;Z=i,Q=S,J=ZZ,W=L,G=P,K=k,X=T,V=z+1,Y=w,M=C,F=D(o,f),H=m,I=c,q=zZ}}}}}}function $9(Z,Q,J){return PW(R([Q]),lZ(),R([J]),lZ(),lZ(),0,0,0,0,Q8,_,_,OZ,N0(Z))}var{setTimeout:W7,clearTimeout:SW}=globalThis,G7=(Z,Q)=>eZ().createElementNS(Z,Q),K7=(Z)=>eZ().createTextNode(Z),X7=()=>eZ().createDocumentFragment(),m9=(Z,Q,J)=>Z.insertBefore(Q,J),t0=nG?(Z,Q,J)=>Z.moveBefore(Q,J):m9,V7=(Z,Q)=>Z.removeChild(Q),Y7=(Z,Q)=>Z.getAttribute(Q),o0=(Z,Q,J)=>Z.setAttribute(Q,J),M7=(Z,Q)=>Z.removeAttribute(Q),H7=(Z,Q,J,W)=>Z.addEventListener(Q,J,W),e0=(Z,Q,J)=>Z.removeEventListener(Q,J),U7=(Z,Q)=>Z.innerHTML=Q,F7=(Z,Q)=>Z.data=Q,mQ=Symbol("lustre");class JK{constructor(Z,Q,J,W){this.kind=Z,this.key=W,this.parent=Q,this.children=[],this.node=J,this.handlers=new Map,this.throttles=new Map,this.debouncers=new Map}get parentNode(){return this.kind===YQ?this.node.parentNode:this.node}}var cQ=(Z,Q,J,W,G)=>{let K=new JK(Z,Q,J,G);return J[mQ]=K,Q?.children.splice(W,0,K),K},R7=(Z)=>{let Q="";for(let J=Z[mQ];J.parent;J=J.parent)if(J.key)Q=`${RJ}${J.key}${Q}`;else{let W=J.parent.children.indexOf(J);Q=`${RJ}${W}${Q}`}return Q.slice(1)};class LW{#Z=null;#G=()=>{};#W=!1;#J=!1;constructor(Z,Q,{useServerEvents:J=!1,exposeKeys:W=!1}={}){this.#Z=Z,this.#G=Q,this.#W=J,this.#J=W}mount(Z){cQ(H9,null,this.#Z,0,null),this.#D(this.#Z,null,this.#Z[mQ],0,Z)}push(Z){this.#Q.push({node:this.#Z[mQ],patch:Z}),this.#K()}#Q=[];#K(){let Z=this.#Q;while(Z.length){let{node:Q,patch:J}=Z.pop(),{children:W}=Q,{changes:G,removed:K,children:X}=J;if(I9(G,(V)=>this.#X(Q,V)),K)this.#I(Q,W.length-K,K);I9(X,(V)=>{let Y=W[V.index|0];this.#Q.push({node:Y,patch:V})})}}#X(Z,Q){switch(Q.kind){case FW:this.#P(Z,Q);break;case RW:this.#O(Z,Q);break;case IW:this.#z(Z,Q);break;case qW:this.#U(Z,Q);break;case NW:this.#F(Z,Q);break;case DW:this.#H(Z,Q);break;case OW:this.#Y(Z,Q);break}}#Y(Z,{children:Q,before:J}){let W=X7(),G=this.#M(Z,J);this.#N(W,null,Z,J|0,Q),m9(Z.parentNode,W,G)}#H(Z,{index:Q,with:J}){this.#I(Z,Q|0,1);let W=this.#M(Z,Q);this.#D(Z.parentNode,W,Z,Q|0,J)}#M(Z,Q){Q=Q|0;let{children:J}=Z,W=J.length;if(Q<W)return J[Q].node;let G=J[W-1];if(!G&&Z.kind!==YQ)return null;if(!G)G=Z;while(G.kind===YQ&&G.children.length)G=G.children[G.children.length-1];return G.node.nextSibling}#U(Z,{key:Q,before:J}){J=J|0;let{children:W,parentNode:G}=Z,K=W[J].node,X=W[J];for(let F=J+1;F<W.length;++F){let H=W[F];if(W[F]=X,X=H,H.key===Q){W[J]=H;break}}let{kind:V,node:Y,children:M}=X;if(t0(G,Y,K),V===YQ)this.#V(G,M,K)}#V(Z,Q,J){for(let W=0;W<Q.length;++W){let{kind:G,node:K,children:X}=Q[W];if(t0(Z,K,J),G===YQ)this.#V(Z,X,J)}}#F(Z,{index:Q}){this.#I(Z,Q,1)}#I(Z,Q,J){let{children:W,parentNode:G}=Z,K=W.splice(Q,J);for(let X=0;X<K.length;++X){let{kind:V,node:Y,children:M}=K[X];if(V7(G,Y),this.#R(K[X]),V===YQ)K.push(...M)}}#R(Z){let{debouncers:Q,children:J}=Z;for(let{timeout:W}of Q.values())if(W)SW(W);Q.clear(),I9(J,(W)=>this.#R(W))}#z({node:Z,handlers:Q,throttles:J,debouncers:W},{added:G,removed:K}){I9(K,({name:X})=>{if(Q.delete(X))e0(Z,X,TW),this.#q(J,X,0),this.#q(W,X,0);else M7(Z,X),QK[X]?.removed?.(Z,X)}),I9(G,(X)=>this.#A(Z,X))}#P({node:Z},{content:Q}){F7(Z,Q??"")}#O({node:Z},{inner_html:Q}){U7(Z,Q??"")}#N(Z,Q,J,W,G){I9(G,(K)=>this.#D(Z,Q,J,W++,K))}#D(Z,Q,J,W,G){switch(G.kind){case H9:{let K=this.#j(J,W,G);this.#N(K,null,K[mQ],0,G.children),m9(Z,K,Q);break}case g9:{let K=this.#B(J,W,G);m9(Z,K,Q);break}case YQ:{let K=this.#B(J,W,G);m9(Z,K,Q),this.#N(Z,Q,K[mQ],0,G.children);break}case R0:{let K=this.#j(J,W,G);this.#O({node:K},G),m9(Z,K,Q);break}}}#j(Z,Q,{kind:J,key:W,tag:G,namespace:K,attributes:X}){let V=G7(K||pJ,G);if(cQ(J,Z,V,Q,W),this.#J&&W)o0(V,"data-lustre-key",W);return I9(X,(Y)=>this.#A(V,Y)),V}#B(Z,Q,{kind:J,key:W,content:G}){let K=K7(G??"");return cQ(J,Z,K,Q,W),K}#A(Z,Q){let{debouncers:J,handlers:W,throttles:G}=Z[mQ],{kind:K,name:X,value:V,prevent_default:Y,debounce:M,throttle:F}=Q;switch(K){case a8:{let H=V??"";if(X==="virtual:defaultValue"){Z.defaultValue=H;return}if(H!==Y7(Z,X))o0(Z,X,H);QK[X]?.added?.(Z,H);break}case Q0:Z[X]=V;break;case t8:{if(W.has(X))e0(Z,X,TW);let H=Y.kind===o8;H7(Z,X,TW,{passive:H}),this.#q(G,X,F),this.#q(J,X,M),W.set(X,(I)=>this.#S(Q,I));break}}}#q(Z,Q,J){let W=Z.get(Q);if(J>0)if(W)W.delay=J;else Z.set(Q,{delay:J});else if(W){let{timeout:G}=W;if(G)SW(G);Z.delete(Q)}}#S(Z,Q){let{currentTarget:J,type:W}=Q,{debouncers:G,throttles:K}=J[mQ],X=R7(J),{prevent_default:V,stop_propagation:Y,include:M,immediate:F}=Z;if(V.kind===ZW)Q.preventDefault();if(Y.kind===ZW)Q.stopPropagation();if(W==="submit")Q.detail??={},Q.detail.formData=[...new FormData(Q.target,Q.submitter).entries()];let H=this.#W?I7(Q,M??[]):Q,I=K.get(W);if(I){let N=Date.now(),S=I.last||0;if(N>S+I.delay)I.last=N,I.lastEvent=Q,this.#G(H,X,W,F)}let q=G.get(W);if(q)SW(q.timeout),q.timeout=W7(()=>{if(Q===K.get(W)?.lastEvent)return;this.#G(H,X,W,F)},q.delay);if(!I&&!q)this.#G(H,X,W,F)}}var I9=(Z,Q)=>{if(Array.isArray(Z))for(let J=0;J<Z.length;J++)Q(Z[J]);else if(Z)for(Z;Z.head;Z=Z.tail)Q(Z.head)},TW=(Z)=>{let{currentTarget:Q,type:J}=Z;Q[mQ].handlers.get(J)(Z)},I7=(Z,Q=[])=>{let J={};if(Z.type==="input"||Z.type==="change")Q.push("target.value");if(Z.type==="submit")Q.push("detail.formData");for(let W of Q){let G=W.split(".");for(let K=0,X=Z,V=J;K<G.length;K++){if(K===G.length-1){V[G[K]]=X[G[K]];break}V=V[G[K]]??={},X=X[G[K]]}}return J},ZK=(Z)=>{return{added(Q){Q[Z]=!0},removed(Q){Q[Z]=!1}}},z7=(Z)=>{return{added(Q,J){Q[Z]=J}}},QK={checked:ZK("checked"),selected:ZK("selected"),value:z7("value"),autofocus:{added(Z){queueMicrotask(()=>{Z.focus?.()})}},autoplay:{added(Z){try{Z.play?.()}catch(Q){console.error(Q)}}}};function q7(Z,Q,J){while(!0){let W=Z,G=Q,K=J;if(W instanceof j)return[G,e(K)];else{let X=W.tail,V=W.head[0],Y=W.head[1],M=F0(V,Y),F;if(V==="")F=G;else F=M9(G,V,M);let H=F,I=D(M,K);Z=X,Q=H,J=I}}}function CW(Z){return q7(Z,lZ(),_)}function WK(Z,Q,J){let W=CW(J),G,K;return G=W[0],K=W[1],IJ("",OZ,"",Z,Q,K,G,!1,!1)}function GK(Z,Q,J,W){let G=CW(W),K,X;return K=G[0],X=G[1],IJ("",OZ,Z,Q,J,X,K,!1,!1)}function KK(Z){let Q=CW(Z),J,W;return J=Q[0],W=Q[1],XW("",OZ,W,J)}var XK=(Z)=>{let Q=cQ(H9,null,Z,0,null),J=0;for(let X=Z.firstChild;X;X=X.nextSibling)if(VK(X))J+=1;if(J===0){let X=eZ().createTextNode("");return cQ(g9,Q,X,0,null),Z.replaceChildren(X),S0()}if(J===1)return EW(Q,Z).head[1];let W=eZ().createTextNode(""),G=cQ(YQ,Q,W,0,null),K=EW(G,Z);return Z.insertBefore(W,Z.firstChild),KK(K)},VK=(Z)=>{switch(Z.nodeType){case dJ:return!0;case n8:return!!Z.data;default:return!1}},N7=(Z,Q,J,W)=>{if(!VK(Q))return null;switch(Q.nodeType){case dJ:{let G=cQ(H9,Z,Q,W,J),K=Q.localName,X=Q.namespaceURI,V=!X||X===pJ;if(V&&D7.includes(K))O7(K,Q);let Y=j7(Q),M=EW(G,Q);return V?WK(K,Y,M):GK(X,K,Y,M)}case n8:return cQ(g9,Z,Q,W,null),W8(Q.data);default:return null}},D7=["input","select","textarea"],O7=(Z,Q)=>{let{value:J,checked:W}=Q;if(Z==="input"&&Q.type==="checkbox"&&!W)return;if(Z==="input"&&Q.type==="radio"&&!W)return;if(Q.type!=="checkbox"&&Q.type!=="radio"&&!J)return;queueMicrotask(()=>{if(Q.value=J,Q.checked=W,Q.dispatchEvent(new Event("input",{bubbles:!0})),Q.dispatchEvent(new Event("change",{bubbles:!0})),eZ().activeElement!==Q)Q.dispatchEvent(new Event("blur",{bubbles:!0}))})},EW=(Z,Q)=>{let J=null,W=Q.firstChild,G=null,K=0;while(W){let X=W.nodeType===dJ?W.getAttribute("data-lustre-key"):null;if(X!=null)W.removeAttribute("data-lustre-key");let V=N7(Z,W,X,K),Y=W.nextSibling;if(V){let M=new cZ([X??"",V],null);if(G)G=G.tail=M;else G=J=M;K+=1}else Q.removeChild(W);W=Y}if(!G)return _;return G.tail=_,J},j7=(Z)=>{let Q=Z.attributes.length,J=_;while(Q-- >0){let W=Z.attributes[Q];if(W.name==="xmlns")continue;J=new cZ(B7(W),J)}return J},B7=(Z)=>{let{localName:Q,value:J}=Z;return hQ(Q,J)};var jJ=()=>!!eZ();class U8{constructor(Z,[Q,J],W,G){this.root=Z,this.#Z=Q,this.#G=W,this.#W=G,this.root.addEventListener("context-request",(K)=>{if(!(K.context&&K.callback))return;if(!this.#X.has(K.context))return;K.stopImmediatePropagation();let X=this.#X.get(K.context);if(K.subscribe){let V=()=>{X.subscribers=X.subscribers.filter((Y)=>Y!==K.callback)};X.subscribers.push([K.callback,V]),K.callback(X.value,V)}else K.callback(X.value)}),this.#K=new LW(this.root,(K,X,V)=>{let[Y,M]=qJ(this.#Q,X,V,K);if(this.#Q=Y,M.isOk()){let F=M[0];if(F.stop_propagation)K.stopPropagation();if(F.prevent_default)K.preventDefault();this.dispatch(F.message,!1)}}),this.#J=XK(this.root),this.#Q=HW(),this.#F=!0,this.#R(J)}root=null;dispatch(Z,Q=!1){if(this.#F||=Q,this.#Y)this.#H.push(Z);else{let[J,W]=this.#W(this.#Z,Z);this.#Z=J,this.#R(W)}}emit(Z,Q){(this.root.host??this.root).dispatchEvent(new CustomEvent(Z,{detail:Q,bubbles:!0,composed:!0}))}provide(Z,Q){if(!this.#X.has(Z))this.#X.set(Z,{value:Q,subscribers:[]});else{let J=this.#X.get(Z);J.value=Q;for(let W=J.subscribers.length-1;W>=0;W--){let[G,K]=J.subscribers[W];if(!G){J.subscribers.splice(W,1);continue}G(Q,K)}}}#Z;#G;#W;#J;#Q;#K;#X=new Map;#Y=!1;#H=[];#M=_;#U=_;#V=null;#F=!1;#I={dispatch:(Z,Q)=>this.dispatch(Z,Q),emit:(Z,Q)=>this.emit(Z,Q),select:()=>{},root:()=>this.root,provide:(Z,Q)=>this.provide(Z,Q)};#R(Z){this.#Y=!0;while(!0){for(let Q=Z.synchronous;Q.tail;Q=Q.tail)Q.head(this.#I);if(this.#M=MK(this.#M,Z.before_paint),this.#U=MK(this.#U,Z.after_paint),!this.#H.length)break;[this.#Z,Z]=this.#W(this.#Z,this.#H.shift())}if(this.#Y=!1,this.#F)cancelAnimationFrame(this.#V),this.#z();else if(!this.#V)this.#V=requestAnimationFrame(()=>{this.#z()})}#z(){this.#F=!1,this.#V=null;let Z=this.#G(this.#Z),{patch:Q,events:J}=$9(this.#Q,this.#J,Z);if(this.#Q=J,this.#J=Z,this.#K.push(Q),this.#M instanceof cZ){let W=YK(this.#M);this.#M=_,queueMicrotask(()=>{this.#F=!0,this.#R(W)})}if(this.#U instanceof cZ){let W=YK(this.#U);this.#U=_,requestAnimationFrame(()=>{this.#F=!0,this.#R(W)})}}}function YK(Z){return{synchronous:Z,after_paint:_,before_paint:_}}function MK(Z,Q){if(Z instanceof j)return Q;else if(Q instanceof j)return Z;else return P9(Z,Q)}class xW extends U{constructor(Z){super();this.message=Z}}class kW extends U{constructor(Z){super();this.callback=Z}}class yW extends U{constructor(Z){super();this.callback=Z}}class eQ extends U{constructor(Z){super();this.message=Z}}class z9 extends U{constructor(Z,Q){super();this.name=Z,this.data=Q}}class F8 extends U{constructor(Z,Q){super();this.key=Z,this.value=Q}}class q9 extends U{}class UK extends U{constructor(Z,Q,J,W,G,K,X,V,Y,M){super();this.open_shadow_root=Z,this.adopt_styles=Q,this.delegates_focus=J,this.attributes=W,this.properties=G,this.contexts=K,this.is_form_associated=X,this.on_form_autofill=V,this.on_form_reset=Y,this.on_form_restore=M}}function FK(Z){let Q=new UK(!0,!0,!1,_,_,_,!1,sJ,sJ,sJ);return LZ(Z,Q,(J,W)=>{return W.apply(J)})}class IK{#Z;constructor(Z,[Q,J],W,G){this.#Z=new U8(Z,[Q,J],G,W)}send(Z){switch(Z.constructor){case eQ:{this.dispatch(Z.message,!1);break}case z9:{this.emit(Z.name,Z.data);break}case q9:break}}dispatch(Z,Q){this.#Z.dispatch(Z,Q)}emit(Z,Q){this.#Z.emit(Z,Q)}}var zK=({init:Z,update:Q,view:J},W,G)=>{if(!jJ())return new b(new BJ);let K=W instanceof HTMLElement?W:eZ().querySelector(W);if(!K)return new b(new bW(W));return new x(new IK(K,Z(G),Q,J))};class A7{#Z;#G;#W;#J;#Q;#K;#X=aZ();#Y=new Set;constructor([Z,Q],J,W,G){this.#Z=Z,this.#G=J,this.#W=W,this.#J=G,this.#Q=this.#W(this.#Z),this.#K=A0(this.#Q),this.#V(Q)}send(Z){switch(Z.constructor){case xW:{let{message:Q}=Z,J=this.#H(Q),W=$9(this.#K,this.#Q,J);this.#Q=J,this.#K=W.events,this.broadcast(AW(W.patch));return}case kW:{let{callback:Q}=Z;this.#Y.add(Q),Q(d0(this.#J.open_shadow_root,this.#J.adopt_styles,IQ(this.#J.attributes),IQ(this.#J.properties),IQ(this.#J.contexts),this.#X,this.#Q));return}case yW:{let{callback:Q}=Z;this.#Y.delete(Q);return}case eQ:{let{message:Q}=Z,[J,W]=this.#G(this.#Z,Q),G=this.#W(J),K=$9(this.#K,this.#Q,G);this.#V(W),this.#Z=J,this.#Q=G,this.#K=K.events,this.broadcast(AW(K.patch));return}case z9:{let{name:Q,data:J}=Z;this.broadcast(s0(Q,J));return}case F8:{let{key:Q,value:J}=Z;this.#X=jZ(this.#X,Q,J),this.broadcast(l0(Q,J));return}case q9:{this.#Z=null,this.#G=null,this.#W=null,this.#J=null,this.#Q=null,this.#K=null,this.#X=null,this.#Y.clear();return}default:return}}broadcast(Z){for(let Q of this.#Y)Q(Z)}#H(Z){switch(Z.constructor){case X8:{let{messages:Q}=Z,J=this.#Z,W=MJ();for(let G=Q;G.head;G=G.tail){let K=this.#H(G.head);if(K instanceof x){J=K[0][0],W=V0(ZQ.fromArray([W,K[0][1]]));break}}return this.#V(W),this.#Z=J,this.#W(this.#Z)}case V8:{let{name:Q,value:J}=Z,W=this.#M(Q,J);if(W instanceof b)return this.#Q;else{let[G,K]=this.#G(this.#Z,W[0]);return this.#V(K),this.#Z=G,this.#W(this.#Z)}}case Y8:{let{name:Q,value:J}=Z,W=this.#U(Q,J);if(W instanceof b)return this.#Q;else{let[G,K]=this.#G(this.#Z,W[0]);return this.#V(K),this.#Z=G,this.#W(this.#Z)}}case M8:{let{path:Q,name:J,event:W}=Z,[G,K]=qJ(this.#K,Q,J,W);if(this.#K=G,K instanceof b)return this.#Q;else{let[X,V]=this.#G(this.#Z,K[0].message);return this.#V(V),this.#Z=X,this.#W(this.#Z)}}case BW:{let{key:Q,value:J}=Z,W=NZ(this.#J.contexts,Q);if(W instanceof b)return this.#Q;if(W=X9(J,W[0]),W instanceof b)return this.#Q;let[G,K]=this.#G(this.#Z,W[0]);return this.#V(K),this.#Z=G,this.#W(this.#Z)}}}#M(Z,Q){let J=NZ(this.#J.attributes,Z);switch(J.constructor){case x:return J[0](Q);case b:return new b(void 0)}}#U(Z,Q){let J=NZ(this.#J.properties,Z);switch(J.constructor){case x:return J[0](Q);case b:return new b(void 0)}}#V(Z){let Q=(X)=>this.send(new eQ(X)),J=(X,V)=>this.send(new z9(X,V)),W=()=>{return},G=()=>{return},K=(X,V)=>this.send(new F8(X,V));globalThis.queueMicrotask(()=>{K0(Z,Q,J,W,G,K)})}}class qK extends U{constructor(Z,Q,J,W){super();this.init=Z,this.update=Q,this.view=J,this.config=W}}class bW extends U{constructor(Z){super();this.selector=Z}}class BJ extends U{}function NK(Z,Q,J){return new qK(Z,Q,J,FK(_))}function DK(Z,Q,J){return qZ(!jJ(),new b(new BJ),()=>{return zK(Z,Q,J)})}function fW(Z){window.addEventListener("resize",()=>Z())}function OK(){return[window.innerWidth,window.innerHeight]}function jK(){let Z=parseFloat(getComputedStyle(document.documentElement).fontSize),Q=getComputedStyle(document.documentElement).getPropertyValue("--layout-sidebar-min-width");if(!Q||Q.indexOf("rem")===-1)throw Error("CSS variable --layout-sidebar-min-width missing or invalid format.");return parseFloat(Q.slice(0,Q.indexOf("rem")))*Z}function hW(){let Z=OK(),Q,J;Q=Z[0],J=Z[1];let W=jK();return Q-W>=J}var c9="src/chess/algebraic_notation.gleam";class BK extends U{}class uW extends U{}class mW extends U{}class AJ extends U{}class R8 extends U{}function T7(Z){if(Z instanceof mW)return"#";else if(Z instanceof AJ)return"+";else return""}function vW(Z){if(Z)return"x";else return""}function I8(Z){if(Z instanceof s)return"";else if(Z instanceof oZ)return"N";else if(Z instanceof uZ)return"B";else if(Z instanceof FZ)return"R";else if(Z instanceof JQ)return"Q";else return"K"}function L7(Z){return"="+I8(Z)}function AK(Z){if(Z instanceof v)return"1";else if(Z instanceof HZ)return"2";else if(Z instanceof dZ)return"3";else if(Z instanceof yZ)return"4";else if(Z instanceof bZ)return"5";else if(Z instanceof sZ)return"6";else if(Z instanceof UZ)return"7";else return"8"}function $W(Z){if(Z instanceof DZ)return"a";else if(Z instanceof BZ)return"b";else if(Z instanceof QZ)return"c";else if(Z instanceof RZ)return"d";else if(Z instanceof p)return"e";else if(Z instanceof IZ)return"f";else if(Z instanceof JZ)return"g";else return"h"}function PK(Z){let Q=$W(Z.file),J=AK(Z.row);return Q+J}function gW(Z){return PK(Z)}function _W(Z,Q,J,W,G){let K=bQ(Z,J),X;if(K instanceof E)X=K[0];else throw g("let_assert",c9,"chess/algebraic_notation",196,"disambiguation","Pattern match failed, no pattern matched the value.",{value:K,start:5423,end:5473,pattern_start:5434,pattern_end:5446});let V=X[0];if(V instanceof s&&G)return $W(J.file);else{let Y=V,M=X[1],F,I=IQ(Q);F=A9(I,(L)=>{return qZ(A(L,J),!1,()=>{let P=bQ(Z,L);return A(P,new E([Y,M]))})});let q=F,N;N=A9(q,(L)=>{let k=NZ(Q,L),T=T9(k,()=>{throw g("panic",c9,"chess/algebraic_notation",219,"disambiguation","`panic` expression evaluated.",{})}),z=L9(T);return a9(z,(w)=>{if(w instanceof hZ){let C=w.to;return A(C,W)}else if(w instanceof NQ){let C=w.to;return A(C,W)}else if(w instanceof DQ){let C=w.to;return A(C,W)}else if(w instanceof OQ)return!1;else return!1})});let O=N;return qZ(YG(O),"",()=>{let L;return L=i9(O,(T)=>{return!A(T.file,J.file)}),qZ(L,(()=>{let T=J.file;return $W(T)})(),()=>{let T;return T=i9(O,(C)=>{return!A(C.row,J.row)}),qZ(T,(()=>{let C=J.row;return AK(C)})(),()=>{return PK(J)})})})}}function C7(Z,Q,J,W){let G;{let H=p8(Q);G=p8(Z)>H}let K=G,X;if(W instanceof qQ){let{from:H,to:I}=W,q=bQ(Z,H),N;if(q instanceof E)N=q[0][0];else throw g("let_assert",c9,"chess/algebraic_notation",123,"describe_internal","Pattern match failed, no pattern matched the value.",{value:q,start:3633,end:3696,pattern_start:3644,pattern_end:3669});X=I8(N)+_W(Z,J,H,I,K)+vW(K)+gW(I)}else if(W instanceof wQ){let{from:H,to:I,new_figure:q}=W,N=bQ(Z,H),S;if(N instanceof E)S=N[0][0];else throw g("let_assert",c9,"chess/algebraic_notation",137,"describe_internal","Pattern match failed, no pattern matched the value.",{value:N,start:4164,end:4227,pattern_start:4175,pattern_end:4200});X=I8(S)+_W(Z,J,H,I,K)+vW(K)+gW(I)+L7(q)}else if(W instanceof xQ){let{from:H,to:I}=W,q=bQ(Z,H),N;if(q instanceof E)N=q[0][0];else throw g("let_assert",c9,"chess/algebraic_notation",130,"describe_internal","Pattern match failed, no pattern matched the value.",{value:q,start:3890,end:3953,pattern_start:3901,pattern_end:3926});X=I8(N)+_W(Z,J,H,I,K)+vW(K)+gW(I)}else if(W instanceof kQ)X="O-O";else X="O-O-O";let V=X,Y,M=KJ(Q);if(M instanceof yQ){let H=M.info;if(H instanceof yJ)if(H.by instanceof bJ)Y=new mW;else{let q;if(q=$J(Q),q)Y=new AJ;else Y=new R8}else{let I;if(I=$J(Q),I)Y=new AJ;else Y=new R8}}else{let H;if(H=$J(Q),H)Y=new AJ;else Y=new R8}return V+T7(Y)}function SK(Z,Q){let J,W=mJ(Z,Q);return J=Y9(W,(K)=>{if(K instanceof hJ)return new BK;else if(K instanceof vJ)return new uW;else return new uW}),CQ(J,(K)=>{let X,V=pG(Z);return X=Y9(V,(M)=>{throw g("panic",c9,"chess/algebraic_notation",99,"describe","`panic` expression evaluated.",{})}),CQ(X,(M)=>{let F=C7(Z,K,M,Q);return new x(F)})})}var LK=new B(new QZ,new v);var CK=new B(new QZ,new $);var EK=new B(new JZ,new v);var wK=new B(new JZ,new $);function x7(Z){if(Z==="input")return!0;else if(Z==="change")return!0;else if(Z==="focus")return!0;else if(Z==="focusin")return!0;else if(Z==="focusout")return!0;else if(Z==="blur")return!0;else if(Z==="select")return!0;else return!1}function k7(Z,Q){return J0(Z,wJ(Q,(J)=>{return new YJ(!1,!1,J)}),_,e8,e8,x7(Z),0,0)}function xK(Z){return k7("mousedown",v8(Z))}var z8="src/web_chess/internal/views/board.gleam";class Z9 extends U{constructor(Z,Q){super();this.state=Z,this.move_history=Q}}class yK extends U{constructor(Z,Q,J,W){super();this.state=Z,this.move_history=Q,this.selected_figure=J,this.moves=W}}class PJ extends U{constructor(Z,Q){super();this.white=Z,this.black=Q}}class cW extends U{constructor(Z){super();this.white=Z}}class q8 extends U{}class N8 extends U{}function b7(Z){if(Z)return K8(R([PZ("absolute inset-0 h-full w-full"),oJ("/indicators/capture.svg"),tJ("This figure can be captured"),rJ(!1)]));else return K8(R([PZ("absolute inset-0 h-full w-full"),oJ("/indicators/move.svg"),tJ("Can move to here"),rJ(!1)]))}function f7(Z){let Q;if(Z[1]instanceof h){let X=Z[0];if(X instanceof s)Q=["/figures/pawn_white.svg","White Bishop"];else if(X instanceof oZ)Q=["/figures/knight_white.svg","White Knight"];else if(X instanceof uZ)Q=["/figures/bishop_white.svg","White Bishop"];else if(X instanceof FZ)Q=["/figures/rook_white.svg","White Rook"];else if(X instanceof JQ)Q=["/figures/queen_white.svg","White Queen"];else Q=["/figures/king_white.svg","White King"]}else{let X=Z[0];if(X instanceof s)Q=["/figures/pawn_black.svg","Black Pawn"];else if(X instanceof oZ)Q=["/figures/knight_black.svg","Black Knight"];else if(X instanceof uZ)Q=["/figures/bishop_black.svg","Black Bishop"];else if(X instanceof FZ)Q=["/figures/rook_black.svg","Black Rook"];else if(X instanceof JQ)Q=["/figures/queen_black.svg","Black Queen"];else Q=["/figures/king_black.svg","Black King"]}let W=Q,G,K;return G=W[0],K=W[1],K8(R([PZ("absolute inset-0 h-full w-full"),oJ(G),tJ(K),rJ(!1)]))}function h7(Z,Q,J,W,G){let K;if(Q instanceof E){let M=Q[0];K=new E(f7(M))}else K=Q;let X=K,V;if(G)V=new E(b7(!A(X,new y)));else V=new y;let Y=V;return oQ(R([f9(R([["relative",!0],["bg-[var(--color-square-dark)]",A(Z,new N8)&&!W],["bg-[var(--color-square-light)]",A(Z,new q8)&&!W],["bg-[var(--color-square-dark-highlighted)]",A(Z,new N8)&&W],["bg-[var(--color-square-light-highlighted)]",A(Z,new q8)&&W]])),xK(J())]),(()=>{let M=R([X,Y]);return W9(M)})())}function v7(Z){let Q,J=Z.file;if(J instanceof DZ)Q=0;else if(J instanceof BZ)Q=1;else if(J instanceof QZ)Q=2;else if(J instanceof RZ)Q=3;else if(J instanceof p)Q=4;else if(J instanceof IZ)Q=5;else if(J instanceof JZ)Q=6;else Q=7;let W=Q,G,K=Z.row;if(K instanceof v)G=0;else if(K instanceof HZ)G=1;else if(K instanceof dZ)G=2;else if(K instanceof yZ)G=3;else if(K instanceof bZ)G=4;else if(K instanceof sZ)G=5;else if(K instanceof UZ)G=6;else G=7;let V=(W+G)%2;if(V===0)return new N8;else if(V===1)return new q8;else throw g("panic",z8,"web_chess/internal/views/board",202,"coordinate_colour","`panic` expression evaluated.",{})}function g7(){let Z=R([new DZ,new BZ,new QZ,new RZ,new p,new IZ,new JZ,new $Z]),J=R([new $,new UZ,new sZ,new bZ,new yZ,new dZ,new HZ,new v]);return S9(J,(W)=>{return kZ(Z,(K)=>{return new B(K,W)})})}function bK(Z,Q){let J;if(Z instanceof Z9)J=[CZ(),CZ()];else{let{selected_figure:X,moves:V}=Z;J=[(()=>{let Y=R([X]);return _Z(Y)})(),(()=>{let M=IQ(V);return _Z(M)})()]}let W=J,G,K;return G=W[0],K=W[1],oQ(R([PZ("grid h-[100vmin] w-[100vmin] grid-cols-8 grid-rows-8 select-none")]),kZ(g7(),(X)=>{return h7(v7(X),bQ(Z.state,X),()=>{return Q(X)},(()=>{return ZJ(G,X)})(),(()=>{return ZJ(K,X)})())}))}function _7(Z,Q,J,W){let G;if(W instanceof hZ){let V=W.to;G=new qQ(J,V)}else if(W instanceof NQ){let V=W.to;G=new wQ(J,V,new JQ)}else if(W instanceof DQ){let V=W.to;G=new xQ(J,V)}else if(W instanceof OQ)G=new kQ;else G=new fJ;let K=G,X=mJ(Z,K);if(X instanceof x){let V=X[0],Y=SK(Z,K),M;if(Y instanceof x)M=Y[0];else throw g("let_assert",z8,"web_chess/internal/views/board",273,"try_do_move","Pattern match failed, no pattern matched the value.",{value:Y,start:7222,end:7288,pattern_start:7233,pattern_end:7253});let F;if(Q instanceof j)F=R([new cW(M)]);else{let I=Q.head;if(I instanceof PJ)F=D(new cW(M),Q);else{let q=Q.tail,N=I.white;F=D(new PJ(N,M),q)}}return new Z9(V,F)}else{let V=X[0];throw u7(V,void 0,"src/web_chess/internal/views/board.gleam",268),g("panic",z8,"web_chess/internal/views/board",269,"try_do_move","error executing move",{})}}function kK(Z,Q,J){let W=KJ(Z),G;if(W instanceof GJ)G=W.next_player;else throw g("let_assert",z8,"web_chess/internal/views/board",298,"try_select","Pattern match failed, no pattern matched the value.",{value:W,start:7998,end:8073,pattern_start:8009,pattern_end:8047});let K=bQ(Z,J);if(K instanceof E){let X=K[0][1];if(A(X,G)){let V,Y=mG(Z,J),M=T9(Y,()=>{return CZ()}),F=L9(M),H=kZ(F,(q)=>{if(q instanceof hZ)return[q.to,q];else if(q instanceof NQ)return[q.to,q];else if(q instanceof DQ)return[q.to,q];else if(q instanceof OQ)if(G instanceof h)return[EK,q];else return[wK,q];else if(G instanceof h)return[LK,q];else return[CK,q]});return V=K9(H),new yK(Z,Q,J,V)}else return new Z9(Z,Q)}else return new Z9(Z,Q)}function fK(Z,Q){if((()=>{let W=Z.state;return KJ(W)})()instanceof yQ)return Z;else if(Z instanceof Z9){let{state:W,move_history:G}=Z;return kK(W,G,Q)}else{let{state:W,move_history:G,selected_figure:K,moves:X}=Z,V=NZ(X,Q);if(V instanceof x){let Y=V[0];return _7(Z.state,G,K,Y)}else return kK(W,G,Q)}}function u7(Z,Q,J,W){let X=`${J}:${W}`,Y=new hK().inspect(Z),M=Q===void 0?"":" "+Q;if(globalThis.process?.stderr?.write){let F=`\x1B[90m${X}\x1B[39m${M}
${Y}
`;globalThis.process.stderr.write(F)}else if(globalThis.Deno){let F=`\x1B[90m${X}\x1B[39m${M}
${Y}
`;globalThis.Deno.stderr.writeSync(new TextEncoder().encode(F))}else{let F=`${X}
${Y}`;globalThis.console.log(F)}return Z}class hK{#Z=new Set;#G(Z){try{return Z instanceof wZ}catch{return!1}}#W(Z){let Q=Z.toString().replace("+","");if(Q.indexOf(".")>=0)return Q;else{let J=Q.indexOf("e");if(J>=0)return Q.slice(0,J)+".0"+Q.slice(J);else return Q+".0"}}inspect(Z){let Q=typeof Z;if(Z===!0)return"True";if(Z===!1)return"False";if(Z===null)return"//js(null)";if(Z===void 0)return"Nil";if(Q==="string")return this.#Y(Z);if(Q==="bigint"||Number.isInteger(Z))return Z.toString();if(Q==="number")return this.#W(Z);if(Z instanceof d9)return this.#H(Z);if(Z instanceof O9)return this.#M(Z);if(Z instanceof RegExp)return`//js(${Z})`;if(Z instanceof Date)return`//js(Date("${Z.toISOString()}"))`;if(Z instanceof globalThis.Error)return`//js(${Z.toString()})`;if(Z instanceof Function){let W=[];for(let G of Array(Z.length).keys())W.push(String.fromCharCode(G+97));return`//fn(${W.join(", ")}) { ... }`}if(this.#Z.size===this.#Z.add(Z).size)return"//js(circular reference)";let J;if(Array.isArray(Z))J=`#(${Z.map((W)=>this.inspect(W)).join(", ")})`;else if(Z instanceof ZQ)J=this.#X(Z);else if(Z instanceof U)J=this.#K(Z);else if(this.#G(Z))J=this.#Q(Z);else if(Z instanceof Set)return`//js(Set(${[...Z].map((W)=>this.inspect(W)).join(", ")}))`;else J=this.#J(Z);return this.#Z.delete(Z),J}#J(Z){let Q=Object.getPrototypeOf(Z)?.constructor?.name||"Object",J=[];for(let K of Object.keys(Z))J.push(`${this.inspect(K)}: ${this.inspect(Z[K])}`);let W=J.length?" "+J.join(", ")+" ":"";return`//js(${Q==="Object"?"":Q+" "}{${W}})`}#Q(Z){let Q="dict.from_list([",J=!0,W=[];return Z.forEach((G,K)=>{W.push([K,G])}),W.sort(),W.forEach(([G,K])=>{if(!J)Q=Q+", ";Q=Q+"#("+this.inspect(G)+", "+this.inspect(K)+")",J=!1}),Q+"])"}#K(Z){let Q=Object.keys(Z).map((J)=>{let W=this.inspect(Z[J]);return isNaN(parseInt(J))?`${J}: ${W}`:W}).join(", ");return Q?`${Z.constructor.name}(${Q})`:Z.constructor.name}#X(Z){if(Z instanceof j)return"[]";let Q='charlist.from_string("',J="[",W=Z;while(W instanceof cZ){let G=W.head;if(W=W.tail,J!=="[")J+=", ";if(J+=this.inspect(G),Q)if(Number.isInteger(G)&&G>=32&&G<=126)Q+=String.fromCharCode(G);else Q=null}if(Q)return Q+'")';else return J+"]"}#Y(Z){let Q='"';for(let J=0;J<Z.length;J++){let W=Z[J];switch(W){case`
`:Q+="\\n";break;case"\r":Q+="\\r";break;case"\t":Q+="\\t";break;case"\f":Q+="\\f";break;case"\\":Q+="\\\\";break;case'"':Q+="\\\"";break;default:if(W<" "||W>"~"&&W<" ")Q+="\\u{"+W.charCodeAt(0).toString(16).toUpperCase().padStart(4,"0")+"}";else Q+=W}}return Q+='"',Q}#H(Z){return`//utfcodepoint(${String.fromCodePoint(Z.value)})`}#M(Z){if(Z.bitSize===0)return"<<>>";let Q="<<";for(let J=0;J<Z.byteSize-1;J++)Q+=Z.byteAt(J).toString(),Q+=", ";if(Z.byteSize*8===Z.bitSize)Q+=Z.byteAt(Z.byteSize-1).toString();else{let J=Z.bitSize%8;Q+=Z.byteAt(Z.byteSize-1)>>8-J,Q+=`:size(${J})`}return Q+=">>",Q}}function gK(){return u9(R([PZ("m-1 text-xs")]),R([G8(R([PZ("whitespace-nowrap"),iJ("https://commons.wikimedia.org/wiki/Category:SVG_chess_pieces"),aJ("_blank")]),R([BQ("Chess icons")])),BQ(" by "),G8(R([iJ("https://commons.wikimedia.org/wiki/User:Cburnett"),aJ("_blank")]),R([BQ("Cburnett")])),BQ(" "),G8(R([PZ("whitespace-nowrap"),iJ("https://creativecommons.org/licenses/by-sa/3.0/deed.en"),aJ("_blank")]),R([BQ("CC BY-SA 3.0")]))]))}function _K(Z){let Q,W=e(Z);Q=MG(W,(K,X)=>{let V=X+1;if(K instanceof PJ){let{white:Y,black:M}=K;return[V,Y,M]}else{let Y=K.white;return[V,Y,""]}});let G=Q;return oQ(R([PZ("grid [grid-template-columns:1.5rem_4.5rem_4.5rem] justify-center gap-y-1 gap-x-1.5 pt-2 pb-2")]),(()=>{return S9(G,(X)=>{let V,Y,M;return V=X[0],Y=X[1],M=X[2],R([u9(R([]),R([BQ(lQ(V)+".")])),u9(R([PZ("font-bold")]),R([BQ(Y)])),u9(R([PZ("font-bold")]),R([BQ(M)]))])})})())}var c7="src/app.gleam";class D8 extends U{constructor(Z,Q){super();this.is_layout_sideways=Z,this.game=Q}}class pW extends U{}class uK extends U{constructor(Z){super();this.square=Z}}function p7(Z){let Q=new D8(hW(),new Z9(uG(),R([]))),J=X0((W)=>{return fW(()=>{return W(new pW)})});return[Q,J]}function d7(Z){return new D8(hW(),Z.game)}function s7(Z,Q){let J;if(Q instanceof pW)J=d7(Z);else{let G=Q.square;J=new D8(Z.is_layout_sideways,fK(Z.game,G))}return[J,MJ()]}function l7(Z){return T0(R([PZ("flex bg-background text-text font-sans h-screen w-screen overflow-x-hidden"),f9(R([["flex-row items-stretch",Z.is_layout_sideways],["flex-col items-stretch",!Z.is_layout_sideways]]))]),R([oQ(R([PZ("h-[calc(50vh-50vmin)] flex-none")]),R([])),C0(R([f9(R([["flex justify-center",!0],["flex-1",Z.is_layout_sideways],["h-[100vmin] min-h-[100vmin]",!Z.is_layout_sideways]]))]),R([bK(Z.game,(Q)=>{return new uK(Q)})])),L0(R([f9(R([["flex flex-col justify-between",!0],["h-full w-[var(--layout-sidebar-min-width)] overflow-y-scroll",Z.is_layout_sideways],["w-full flex-1",!Z.is_layout_sideways]]))]),R([_K(Z.game.move_history),oQ(R([PZ("text-center")]),R([gK()]))]))]))}function $K(){let Z=NK(p7,s7,l7),Q=DK(Z,"#app",void 0);if(!(Q instanceof x))throw g("let_assert",c7,"app",14,"main","Pattern match failed, no pattern matched the value.",{value:Q,start:397,end:446,pattern_start:408,pattern_end:413});return}$K();

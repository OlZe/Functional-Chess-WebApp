function XG(Z){return!Z}function KZ(Z,Q,J){if(Z)return Q;else return J()}class F{withFields(Z){let Q=Object.keys(this).map((J)=>(J in Z)?Z[J]:this[J]);return new this.constructor(...Q)}}class WQ{static fromArray(Z,Q){let J=Q||new B;for(let W=Z.length-1;W>=0;--W)J=new pZ(Z[W],J);return J}[Symbol.iterator](){return new MG(this)}toArray(){return[...this]}atLeastLength(Z){let Q=this;while(Z-- >0&&Q)Q=Q.tail;return Q!==void 0}hasLength(Z){let Q=this;while(Z-- >0&&Q)Q=Q.tail;return Z===-1&&Q instanceof B}countLength(){let Z=this,Q=0;while(Z)Z=Z.tail,Q++;return Q-1}}function D(Z,Q){return new pZ(Z,Q)}function z(Z,Q){return WQ.fromArray(Z,Q)}class MG{#Z;constructor(Z){this.#Z=Z}next(){if(this.#Z instanceof B)return{done:!0};else{let{head:Z,tail:Q}=this.#Z;return this.#Z=Q,{value:Z,done:!1}}}}class B extends WQ{}class pZ extends WQ{constructor(Z,Q){super();this.head=Z,this.tail=Q}}class L9{bitSize;byteSize;bitOffset;rawBuffer;constructor(Z,Q,J){if(!(Z instanceof Uint8Array))throw globalThis.Error("BitArray can only be constructed from a Uint8Array");if(this.bitSize=Q??Z.length*8,this.byteSize=Math.trunc((this.bitSize+7)/8),this.bitOffset=J??0,this.bitSize<0)throw globalThis.Error(`BitArray bit size is invalid: ${this.bitSize}`);if(this.bitOffset<0||this.bitOffset>7)throw globalThis.Error(`BitArray bit offset is invalid: ${this.bitOffset}`);if(Z.length!==Math.trunc((this.bitOffset+this.bitSize+7)/8))throw globalThis.Error("BitArray buffer length is invalid");this.rawBuffer=Z}byteAt(Z){if(Z<0||Z>=this.byteSize)return;return t9(this.rawBuffer,this.bitOffset,Z)}equals(Z){if(this.bitSize!==Z.bitSize)return!1;let Q=Math.trunc(this.bitSize/8);if(this.bitOffset===0&&Z.bitOffset===0){for(let W=0;W<Q;W++)if(this.rawBuffer[W]!==Z.rawBuffer[W])return!1;let J=this.bitSize%8;if(J){let W=8-J;if(this.rawBuffer[Q]>>W!==Z.rawBuffer[Q]>>W)return!1}}else{for(let W=0;W<Q;W++){let G=t9(this.rawBuffer,this.bitOffset,W),K=t9(Z.rawBuffer,Z.bitOffset,W);if(G!==K)return!1}let J=this.bitSize%8;if(J){let W=t9(this.rawBuffer,this.bitOffset,Q),G=t9(Z.rawBuffer,Z.bitOffset,Q),K=8-J;if(W>>K!==G>>K)return!1}}return!0}get buffer(){if(YG("buffer","Use BitArray.byteAt() or BitArray.rawBuffer instead"),this.bitOffset!==0||this.bitSize%8!==0)throw new globalThis.Error("BitArray.buffer does not support unaligned bit arrays");return this.rawBuffer}get length(){if(YG("length","Use BitArray.bitSize or BitArray.byteSize instead"),this.bitOffset!==0||this.bitSize%8!==0)throw new globalThis.Error("BitArray.length does not support unaligned bit arrays");return this.rawBuffer.length}}function t9(Z,Q,J){if(Q===0)return Z[J]??0;else{let W=Z[J]<<Q&255,G=Z[J+1]>>8-Q;return W|G}}class o9{constructor(Z){this.value=Z}}var VG={};function YG(Z,Q){if(VG[Z])return;console.warn(`Deprecated BitArray.${Z} property used in JavaScript FFI code. ${Q}.`),VG[Z]=!0}class e9 extends F{static isResult(Z){return Z instanceof e9}}class x extends e9{constructor(Z){super();this[0]=Z}isOk(){return!0}}class b extends e9{constructor(Z){super();this[0]=Z}isOk(){return!1}}function A(Z,Q){let J=[Z,Q];while(J.length){let W=J.pop(),G=J.pop();if(W===G)continue;if(!HG(W)||!HG(G))return!1;if(!MX(W,G)||GX(W,G)||KX(W,G)||XX(W,G)||VX(W,G)||YX(W,G)||HX(W,G))return!1;let X=Object.getPrototypeOf(W);if(X!==null&&typeof X.equals==="function")try{if(W.equals(G))continue;else return!1}catch{}let[V,Y]=WX(W),H=V(W),U=V(G);if(H.length!==U.length)return!1;for(let M of H)J.push(Y(W,M),Y(G,M))}return!0}function WX(Z){if(Z instanceof Map)return[(Q)=>Q.keys(),(Q,J)=>Q.get(J)];else{let Q=Z instanceof globalThis.Error?["message"]:[];return[(J)=>[...Q,...Object.keys(J)],(J,W)=>J[W]]}}function GX(Z,Q){return Z instanceof Date&&(Z>Q||Z<Q)}function KX(Z,Q){return!(Z instanceof L9)&&Z.buffer instanceof ArrayBuffer&&Z.BYTES_PER_ELEMENT&&!(Z.byteLength===Q.byteLength&&Z.every((J,W)=>J===Q[W]))}function XX(Z,Q){return Array.isArray(Z)&&Z.length!==Q.length}function VX(Z,Q){return Z instanceof Map&&Z.size!==Q.size}function YX(Z,Q){return Z instanceof Set&&(Z.size!=Q.size||[...Z].some((J)=>!Q.has(J)))}function HX(Z,Q){return Z instanceof RegExp&&(Z.source!==Q.source||Z.flags!==Q.flags)}function HG(Z){return typeof Z==="object"&&Z!==null}function MX(Z,Q){if(typeof Z!=="object"&&typeof Q!=="object"&&(!Z||!Q))return!1;if([Promise,WeakSet,WeakMap,Function].some((W)=>Z instanceof W))return!1;return Z.constructor===Q.constructor}function g(Z,Q,J,W,G,K,X){let V=new globalThis.Error(K);V.gleam_error=Z,V.file=Q,V.module=J,V.line=W,V.function=G,V.fn=G;for(let Y in X)V[Y]=X[Y];return V}class S extends F{constructor(Z){super();this[0]=Z}}class y extends F{}function UX(Z,Q){while(!0){let J=Z,W=Q;if(J instanceof B)return W;else{let G=J.head;Z=J.tail,Q=D(G,W)}}}function FX(Z){return UX(Z,z([]))}function UG(Z){return A(Z,new y)}function FG(Z,Q){if(Z instanceof S){let J=Z[0];return new x(J)}else return new b(Q)}function S8(Z){if(Z instanceof x){let Q=Z[0];return new S(Q)}else return new y}function CQ(Z,Q){if(Z instanceof S){let J=Z[0];return Q(J)}else return Z}function ZJ(Z,Q){if(Z instanceof S)return Z;else return Q()}function RX(Z,Q){while(!0){let J=Z,W=Q;if(J instanceof B)return FX(W);else{let G=J.head;if(G instanceof S){let K=J.tail,X=G[0];Z=K,Q=D(X,W)}else Z=J.tail,Q=W}}}function nQ(Z){return RX(Z,z([]))}var RG=new WeakMap,L8=new DataView(new ArrayBuffer(8)),C8=0;function E8(Z){let Q=RG.get(Z);if(Q!==void 0)return Q;let J=C8++;if(C8===2147483647)C8=0;return RG.set(Z,J),J}function w8(Z,Q){return Z^Q+2654435769+(Z<<6)+(Z>>2)|0}function k8(Z){let Q=0,J=Z.length;for(let W=0;W<J;W++)Q=Math.imul(31,Q)+Z.charCodeAt(W)|0;return Q}function zG(Z){L8.setFloat64(0,Z);let Q=L8.getInt32(0),J=L8.getInt32(4);return Math.imul(73244475,Q>>16^Q)^J}function IX(Z){return k8(Z.toString())}function zX(Z){let Q=Object.getPrototypeOf(Z);if(Q!==null&&typeof Q.hashCode==="function")try{let W=Z.hashCode(Z);if(typeof W==="number")return W}catch{}if(Z instanceof Promise||Z instanceof WeakSet||Z instanceof WeakMap)return E8(Z);if(Z instanceof Date)return zG(Z.getTime());let J=0;if(Z instanceof ArrayBuffer)Z=new Uint8Array(Z);if(Array.isArray(Z)||Z instanceof Uint8Array)for(let W=0;W<Z.length;W++)J=Math.imul(31,J)+rZ(Z[W])|0;else if(Z instanceof Set)Z.forEach((W)=>{J=J+rZ(W)|0});else if(Z instanceof Map)Z.forEach((W,G)=>{J=J+w8(rZ(W),rZ(G))|0});else{let W=Object.keys(Z);for(let G=0;G<W.length;G++){let K=W[G],X=Z[K];J=J+w8(rZ(X),k8(K))|0}}return J}function rZ(Z){if(Z===null)return 1108378658;if(Z===void 0)return 1108378659;if(Z===!0)return 1108378657;if(Z===!1)return 1108378656;switch(typeof Z){case"number":return zG(Z);case"string":return k8(Z);case"bigint":return IX(Z);case"object":return zX(Z);case"symbol":return E8(Z);case"function":return E8(Z);default:return 0}}var jQ=5,y8=Math.pow(2,jQ),qX=y8-1,NX=y8/2,DX=y8/4,hZ=0,OQ=1,dZ=2,Y9=3,b8={type:dZ,bitmap:0,array:[]};function QJ(Z,Q){return Z>>>Q&qX}function kJ(Z,Q){return 1<<QJ(Z,Q)}function OX(Z){return Z-=Z>>1&1431655765,Z=(Z&858993459)+(Z>>2&858993459),Z=Z+(Z>>4)&252645135,Z+=Z>>8,Z+=Z>>16,Z&127}function f8(Z,Q){return OX(Z&Q-1)}function iZ(Z,Q,J){let W=Z.length,G=Array(W);for(let K=0;K<W;++K)G[K]=Z[K];return G[Q]=J,G}function jX(Z,Q,J){let W=Z.length,G=Array(W+1),K=0,X=0;while(K<Q)G[X++]=Z[K++];G[X++]=J;while(K<W)G[X++]=Z[K++];return G}function x8(Z,Q){let J=Z.length,W=Array(J-1),G=0,K=0;while(G<Q)W[K++]=Z[G++];++G;while(G<J)W[K++]=Z[G++];return W}function qG(Z,Q,J,W,G,K){let X=rZ(Q);if(X===W)return{type:Y9,hash:X,array:[{type:hZ,k:Q,v:J},{type:hZ,k:G,v:K}]};let V={val:!1};return JJ(h8(b8,Z,X,Q,J,V),Z,W,G,K,V)}function JJ(Z,Q,J,W,G,K){switch(Z.type){case OQ:return BX(Z,Q,J,W,G,K);case dZ:return h8(Z,Q,J,W,G,K);case Y9:return AX(Z,Q,J,W,G,K)}}function BX(Z,Q,J,W,G,K){let X=QJ(J,Q),V=Z.array[X];if(V===void 0)return K.val=!0,{type:OQ,size:Z.size+1,array:iZ(Z.array,X,{type:hZ,k:W,v:G})};if(V.type===hZ){if(A(W,V.k)){if(G===V.v)return Z;return{type:OQ,size:Z.size,array:iZ(Z.array,X,{type:hZ,k:W,v:G})}}return K.val=!0,{type:OQ,size:Z.size,array:iZ(Z.array,X,qG(Q+jQ,V.k,V.v,J,W,G))}}let Y=JJ(V,Q+jQ,J,W,G,K);if(Y===V)return Z;return{type:OQ,size:Z.size,array:iZ(Z.array,X,Y)}}function h8(Z,Q,J,W,G,K){let X=kJ(J,Q),V=f8(Z.bitmap,X);if((Z.bitmap&X)!==0){let Y=Z.array[V];if(Y.type!==hZ){let U=JJ(Y,Q+jQ,J,W,G,K);if(U===Y)return Z;return{type:dZ,bitmap:Z.bitmap,array:iZ(Z.array,V,U)}}let H=Y.k;if(A(W,H)){if(G===Y.v)return Z;return{type:dZ,bitmap:Z.bitmap,array:iZ(Z.array,V,{type:hZ,k:W,v:G})}}return K.val=!0,{type:dZ,bitmap:Z.bitmap,array:iZ(Z.array,V,qG(Q+jQ,H,Y.v,J,W,G))}}else{let Y=Z.array.length;if(Y>=NX){let H=Array(32),U=QJ(J,Q);H[U]=h8(b8,Q+jQ,J,W,G,K);let M=0,R=Z.bitmap;for(let q=0;q<32;q++){if((R&1)!==0){let I=Z.array[M++];H[q]=I}R=R>>>1}return{type:OQ,size:Y+1,array:H}}else{let H=jX(Z.array,V,{type:hZ,k:W,v:G});return K.val=!0,{type:dZ,bitmap:Z.bitmap|X,array:H}}}}function AX(Z,Q,J,W,G,K){if(J===Z.hash){let X=v8(Z,W);if(X!==-1){if(Z.array[X].v===G)return Z;return{type:Y9,hash:J,array:iZ(Z.array,X,{type:hZ,k:W,v:G})}}let V=Z.array.length;return K.val=!0,{type:Y9,hash:J,array:iZ(Z.array,V,{type:hZ,k:W,v:G})}}return JJ({type:dZ,bitmap:kJ(Z.hash,Q),array:[Z]},Q,J,W,G,K)}function v8(Z,Q){let J=Z.array.length;for(let W=0;W<J;W++)if(A(Q,Z.array[W].k))return W;return-1}function xJ(Z,Q,J,W){switch(Z.type){case OQ:return PX(Z,Q,J,W);case dZ:return TX(Z,Q,J,W);case Y9:return SX(Z,W)}}function PX(Z,Q,J,W){let G=QJ(J,Q),K=Z.array[G];if(K===void 0)return;if(K.type!==hZ)return xJ(K,Q+jQ,J,W);if(A(W,K.k))return K;return}function TX(Z,Q,J,W){let G=kJ(J,Q);if((Z.bitmap&G)===0)return;let K=f8(Z.bitmap,G),X=Z.array[K];if(X.type!==hZ)return xJ(X,Q+jQ,J,W);if(A(W,X.k))return X;return}function SX(Z,Q){let J=v8(Z,Q);if(J<0)return;return Z.array[J]}function g8(Z,Q,J,W){switch(Z.type){case OQ:return LX(Z,Q,J,W);case dZ:return CX(Z,Q,J,W);case Y9:return EX(Z,W)}}function LX(Z,Q,J,W){let G=QJ(J,Q),K=Z.array[G];if(K===void 0)return Z;let X=void 0;if(K.type===hZ){if(!A(K.k,W))return Z}else if(X=g8(K,Q+jQ,J,W),X===K)return Z;if(X===void 0){if(Z.size<=DX){let V=Z.array,Y=Array(Z.size-1),H=0,U=0,M=0;while(H<G){let R=V[H];if(R!==void 0)Y[U]=R,M|=1<<H,++U;++H}++H;while(H<V.length){let R=V[H];if(R!==void 0)Y[U]=R,M|=1<<H,++U;++H}return{type:dZ,bitmap:M,array:Y}}return{type:OQ,size:Z.size-1,array:iZ(Z.array,G,X)}}return{type:OQ,size:Z.size,array:iZ(Z.array,G,X)}}function CX(Z,Q,J,W){let G=kJ(J,Q);if((Z.bitmap&G)===0)return Z;let K=f8(Z.bitmap,G),X=Z.array[K];if(X.type!==hZ){let V=g8(X,Q+jQ,J,W);if(V===X)return Z;if(V!==void 0)return{type:dZ,bitmap:Z.bitmap,array:iZ(Z.array,K,V)};if(Z.bitmap===G)return;return{type:dZ,bitmap:Z.bitmap^G,array:x8(Z.array,K)}}if(A(W,X.k)){if(Z.bitmap===G)return;return{type:dZ,bitmap:Z.bitmap^G,array:x8(Z.array,K)}}return Z}function EX(Z,Q){let J=v8(Z,Q);if(J<0)return Z;if(Z.array.length===1)return;return{type:Y9,hash:Z.hash,array:x8(Z.array,J)}}function NG(Z,Q){if(Z===void 0)return;let J=Z.array,W=J.length;for(let G=0;G<W;G++){let K=J[G];if(K===void 0)continue;if(K.type===hZ){Q(K.v,K.k);continue}NG(K,Q)}}class fZ{static fromObject(Z){let Q=Object.keys(Z),J=fZ.new();for(let W=0;W<Q.length;W++){let G=Q[W];J=J.set(G,Z[G])}return J}static fromMap(Z){let Q=fZ.new();return Z.forEach((J,W)=>{Q=Q.set(W,J)}),Q}static new(){return new fZ(void 0,0)}constructor(Z,Q){this.root=Z,this.size=Q}get(Z,Q){if(this.root===void 0)return Q;let J=xJ(this.root,0,rZ(Z),Z);if(J===void 0)return Q;return J.v}set(Z,Q){let J={val:!1},W=this.root===void 0?b8:this.root,G=JJ(W,0,rZ(Z),Z,Q,J);if(G===this.root)return this;return new fZ(G,J.val?this.size+1:this.size)}delete(Z){if(this.root===void 0)return this;let Q=g8(this.root,0,rZ(Z),Z);if(Q===this.root)return this;if(Q===void 0)return fZ.new();return new fZ(Q,this.size-1)}has(Z){if(this.root===void 0)return!1;return xJ(this.root,0,rZ(Z),Z)!==void 0}entries(){if(this.root===void 0)return[];let Z=[];return this.forEach((Q,J)=>Z.push([J,Q])),Z}forEach(Z){NG(this.root,Z)}hashCode(){let Z=0;return this.forEach((Q,J)=>{Z=Z+w8(rZ(Q),rZ(J))|0}),Z}equals(Z){if(!(Z instanceof fZ)||this.size!==Z.size)return!1;try{return this.forEach((Q,J)=>{if(!A(Z.get(J,!Q),Q))throw IG}),!0}catch(Q){if(Q===IG)return!1;throw Q}}}var IG=Symbol();class XZ extends F{}class VZ extends F{}class EQ extends F{}function yJ(Z,Q){if(Z===Q)return new VZ;else if(Z<Q)return new XZ;else return new EQ}class CZ extends F{}class C9 extends F{}function E9(Z,Q){while(!0){let J=Z,W=Q;if(J instanceof B)return W;else{let G=J.head;Z=J.tail,Q=D(G,W)}}}function e(Z){return E9(Z,z([]))}function PG(Z){return A(Z,z([]))}function hX(Z,Q,J){while(!0){let W=Z,G=Q,K=J;if(W instanceof B)return e(K);else{let{head:X,tail:V}=W,Y;if(G(X))Y=D(X,K);else Y=K;let U=Y;Z=V,Q=G,J=U}}}function w9(Z,Q){return hX(Z,Q,z([]))}function vX(Z,Q,J){while(!0){let W=Z,G=Q,K=J;if(W instanceof B)return e(K);else{let{head:X,tail:V}=W,Y,H=G(X);if(H instanceof x){let M=H[0];Y=D(M,K)}else Y=K;let U=Y;Z=V,Q=G,J=U}}}function bJ(Z,Q){return vX(Z,Q,z([]))}function gX(Z,Q,J){while(!0){let W=Z,G=Q,K=J;if(W instanceof B)return e(K);else{let X=W.head;Z=W.tail,Q=G,J=D(G(X),K)}}}function EZ(Z,Q){return gX(Z,Q,z([]))}function uX(Z,Q,J,W){while(!0){let G=Z,K=Q,X=J,V=W;if(G instanceof B)return e(V);else{let{head:Y,tail:H}=G,U=D(K(Y,X),V);Z=H,Q=K,J=X+1,W=U}}}function TG(Z,Q){return uX(Z,Q,0,z([]))}function _X(Z,Q){while(!0){let J=Z,W=Q;if(J instanceof B)return W;else{let G=J.head;Z=J.tail,Q=D(G,W)}}}function x9(Z,Q){return _X(e(Z),Q)}function fJ(Z,Q){return D(Q,Z)}function $X(Z,Q){while(!0){let J=Z,W=Q;if(J instanceof B)return e(W);else{let G=J.head;Z=J.tail,Q=E9(G,W)}}}function mX(Z){return $X(Z,z([]))}function k9(Z,Q){return mX(EZ(Z,Q))}function wZ(Z,Q,J){while(!0){let W=Z,G=Q,K=J;if(W instanceof B)return G;else{let X=W.head;Z=W.tail,Q=K(G,X),J=K}}}function SG(Z,Q){while(!0){let J=Z,W=Q;if(J instanceof B)return new b(void 0);else{let{head:G,tail:K}=J,X=W(G);if(X instanceof x)return X;else Z=K,Q=W}}}function WJ(Z,Q){while(!0){let J=Z,W=Q;if(J instanceof B)return!0;else{let{head:G,tail:K}=J,X=W(G);if(X)Z=K,Q=W;else return X}}}function GJ(Z,Q){while(!0){let J=Z,W=Q;if(J instanceof B)return!1;else{let{head:G,tail:K}=J,X=W(G);if(X)return X;else Z=K,Q=W}}}function cX(Z,Q,J,W,G,K){while(!0){let X=Z,V=Q,Y=J,H=W,U=G,M=K,R=D(U,Y);if(X instanceof B)if(H instanceof CZ)return D(e(R),M);else return D(R,M);else{let{head:q,tail:I}=X,P=V(U,q);if(H instanceof CZ)if(P instanceof XZ)Z=I,Q=V,J=R,W=H,G=q,K=M;else if(P instanceof VZ)Z=I,Q=V,J=R,W=H,G=q,K=M;else{let O;if(H instanceof CZ)O=D(e(R),M);else O=D(R,M);let L=O;if(I instanceof B)return D(z([q]),L);else{let{head:T,tail:k}=I,C,N=V(q,T);if(N instanceof XZ)C=new CZ;else if(N instanceof VZ)C=new CZ;else C=new C9;let w=C;Z=k,Q=V,J=z([q]),W=w,G=T,K=L}}else if(P instanceof XZ){let O;if(H instanceof CZ)O=D(e(R),M);else O=D(R,M);let L=O;if(I instanceof B)return D(z([q]),L);else{let{head:T,tail:k}=I,C,N=V(q,T);if(N instanceof XZ)C=new CZ;else if(N instanceof VZ)C=new CZ;else C=new C9;let w=C;Z=k,Q=V,J=z([q]),W=w,G=T,K=L}}else if(P instanceof VZ){let O;if(H instanceof CZ)O=D(e(R),M);else O=D(R,M);let L=O;if(I instanceof B)return D(z([q]),L);else{let{head:T,tail:k}=I,C,N=V(q,T);if(N instanceof XZ)C=new CZ;else if(N instanceof VZ)C=new CZ;else C=new C9;let w=C;Z=k,Q=V,J=z([q]),W=w,G=T,K=L}}else Z=I,Q=V,J=R,W=H,G=q,K=M}}}function pX(Z,Q,J,W){while(!0){let G=Z,K=Q,X=J,V=W;if(G instanceof B)return E9(K,V);else if(K instanceof B)return E9(G,V);else{let{head:Y,tail:H}=G,U=K.head,M=K.tail,R=X(Y,U);if(R instanceof XZ)Z=H,Q=K,J=X,W=D(Y,V);else if(R instanceof VZ)Z=G,Q=M,J=X,W=D(U,V);else Z=G,Q=M,J=X,W=D(U,V)}}}function dX(Z,Q,J){while(!0){let W=Z,G=Q,K=J;if(W instanceof B)return e(K);else{let X=W.tail;if(X instanceof B){let V=W.head;return e(D(e(V),K))}else{let V=W.head,Y=X.head,H=X.tail,U=pX(V,Y,G,z([]));Z=H,Q=G,J=D(U,K)}}}}function sX(Z,Q,J,W){while(!0){let G=Z,K=Q,X=J,V=W;if(G instanceof B)return E9(K,V);else if(K instanceof B)return E9(G,V);else{let{head:Y,tail:H}=G,U=K.head,M=K.tail,R=X(Y,U);if(R instanceof XZ)Z=G,Q=M,J=X,W=D(U,V);else if(R instanceof VZ)Z=H,Q=K,J=X,W=D(Y,V);else Z=H,Q=K,J=X,W=D(Y,V)}}}function nX(Z,Q,J){while(!0){let W=Z,G=Q,K=J;if(W instanceof B)return e(K);else{let X=W.tail;if(X instanceof B){let V=W.head;return e(D(e(V),K))}else{let V=W.head,Y=X.head,H=X.tail,U=sX(V,Y,G,z([]));Z=H,Q=G,J=D(U,K)}}}}function lX(Z,Q,J){while(!0){let W=Z,G=Q,K=J;if(W instanceof B)return W;else if(G instanceof CZ)if(W.tail instanceof B)return W.head;else Z=dX(W,K,z([])),Q=new C9,J=K;else if(W.tail instanceof B){let V=W.head;return e(V)}else Z=nX(W,K,z([])),Q=new CZ,J=K}}function LG(Z,Q){if(Z instanceof B)return Z;else{let J=Z.tail;if(J instanceof B)return Z;else{let W=Z.head,G=J.head,K=J.tail,X,V=Q(W,G);if(V instanceof XZ)X=new CZ;else if(V instanceof VZ)X=new CZ;else X=new C9;let Y=X,H=cX(K,Q,z([W]),Y,G,z([]));return lX(H,new CZ,Q)}}}function CG(Z,Q){while(!0){let J=Z,W=Q;if(J instanceof B)return;else{let{head:G,tail:K}=J;W(G),Z=K,Q=W}}}function Z6(Z,Q){while(!0){let J=Z,W=Q;if(J instanceof B)return W;else{let G=J.head;Z=J.tail,Q=W+G}}}function wG(Z){return Z6(Z,"")}class $8 extends F{constructor(Z){super();this.function=Z}}function H9(Z,Q){let J=Q.function(Z),W,G;if(W=J[0],G=J[1],G instanceof B)return new x(W);else return new b(G)}function xQ(Z){return new $8((Q)=>{return[Z,z([])]})}function hJ(Z,Q){return new $8((J)=>{let W=Z.function(J),G,K;return G=W[0],K=W[1],[Q(G),K]})}var K6=void 0,yG={};function aQ(Z){return Z.toString()}function _8(Z,Q){return Z.startsWith(Q)}var bG=[" ","\t",`
`,"\v","\f","\r","","\u2028","\u2029"].join(""),aY=new RegExp(`^[${bG}]*`),tY=new RegExp(`[${bG}]*$`);function tZ(){return fZ.new()}function tQ(Z){return Z.size}function M9(Z){return WQ.fromArray(Z.entries())}function fG(Z,Q){return Q.delete(Z)}function FZ(Z,Q){let J=Z.get(Q,yG);if(J===yG)return new b(K6);return new x(J)}function hG(Z,Q,J){return J.set(Z,Q)}function AG(Z){let Q=Z.toString().replace("+","");if(Q.indexOf(".")>=0)return Q;else{let J=Q.indexOf("e");if(J>=0)return Q.slice(0,J)+".0"+Q.slice(J);else return Q+".0"}}class X6{#Z=new Set;inspect(Z){let Q=typeof Z;if(Z===!0)return"True";if(Z===!1)return"False";if(Z===null)return"//js(null)";if(Z===void 0)return"Nil";if(Q==="string")return this.#K(Z);if(Q==="bigint"||Number.isInteger(Z))return Z.toString();if(Q==="number")return AG(Z);if(Z instanceof o9)return this.#X(Z);if(Z instanceof L9)return this.#Y(Z);if(Z instanceof RegExp)return`//js(${Z})`;if(Z instanceof Date)return`//js(Date("${Z.toISOString()}"))`;if(Z instanceof globalThis.Error)return`//js(${Z.toString()})`;if(Z instanceof Function){let W=[];for(let G of Array(Z.length).keys())W.push(String.fromCharCode(G+97));return`//fn(${W.join(", ")}) { ... }`}if(this.#Z.size===this.#Z.add(Z).size)return"//js(circular reference)";let J;if(Array.isArray(Z))J=`#(${Z.map((W)=>this.inspect(W)).join(", ")})`;else if(Z instanceof WQ)J=this.#Q(Z);else if(Z instanceof F)J=this.#J(Z);else if(Z instanceof fZ)J=this.#W(Z);else if(Z instanceof Set)return`//js(Set(${[...Z].map((W)=>this.inspect(W)).join(", ")}))`;else J=this.#G(Z);return this.#Z.delete(Z),J}#G(Z){let Q=Object.getPrototypeOf(Z)?.constructor?.name||"Object",J=[];for(let K of Object.keys(Z))J.push(`${this.inspect(K)}: ${this.inspect(Z[K])}`);let W=J.length?" "+J.join(", ")+" ":"";return`//js(${Q==="Object"?"":Q+" "}{${W}})`}#W(Z){let Q="dict.from_list([",J=!0;return Z.forEach((W,G)=>{if(!J)Q=Q+", ";Q=Q+"#("+this.inspect(G)+", "+this.inspect(W)+")",J=!1}),Q+"])"}#J(Z){let Q=Object.keys(Z).map((J)=>{let W=this.inspect(Z[J]);return isNaN(parseInt(J))?`${J}: ${W}`:W}).join(", ");return Q?`${Z.constructor.name}(${Q})`:Z.constructor.name}#Q(Z){if(Z instanceof B)return"[]";let Q='charlist.from_string("',J="[",W=Z;while(W instanceof pZ){let G=W.head;if(W=W.tail,J!=="[")J+=", ";if(J+=this.inspect(G),Q)if(Number.isInteger(G)&&G>=32&&G<=126)Q+=String.fromCharCode(G);else Q=null}if(Q)return Q+'")';else return J+"]"}#K(Z){let Q='"';for(let J=0;J<Z.length;J++){let W=Z[J];switch(W){case`
`:Q+="\\n";break;case"\r":Q+="\\r";break;case"\t":Q+="\\t";break;case"\f":Q+="\\f";break;case"\\":Q+="\\\\";break;case'"':Q+="\\\"";break;default:if(W<" "||W>"~"&&W<" ")Q+="\\u{"+W.charCodeAt(0).toString(16).toUpperCase().padStart(4,"0")+"}";else Q+=W}}return Q+='"',Q}#X(Z){return`//utfcodepoint(${String.fromCodePoint(Z.value)})`}#Y(Z){if(Z.bitSize===0)return"<<>>";let Q="<<";for(let J=0;J<Z.byteSize-1;J++)Q+=Z.byteAt(J).toString(),Q+=", ";if(Z.byteSize*8===Z.bitSize)Q+=Z.byteAt(Z.byteSize-1).toString();else{let J=Z.bitSize%8;Q+=Z.byteAt(Z.byteSize-1)>>8-J,Q+=`:size(${J})`}return Q+=">>",Q}}function u8(Z){return tQ(Z)===0}function BZ(Z,Q,J){return hG(Q,J,Z)}function V6(Z,Q){while(!0){let J=Z,W=Q;if(J instanceof B)return W;else{let G=J.tail,K=J.head[0],X=J.head[1];Z=G,Q=BZ(W,K,X)}}}function lQ(Z){return V6(Z,tZ())}function Y6(Z,Q){while(!0){let J=Z,W=Q;if(J instanceof B)return W;else{let G=J.head;Z=J.tail,Q=D(G,W)}}}function H6(Z,Q){while(!0){let J=Z,W=Q;if(J instanceof B)return Y6(W,z([]));else{let G=J.tail,K=J.head[0];Z=G,Q=D(K,W)}}}function KQ(Z){return H6(M9(Z),z([]))}function eZ(Z,Q){return fG(Q,Z)}function M6(Z,Q,J){while(!0){let W=Z,G=Q,K=J;if(W instanceof B)return G;else{let X=W.tail,V=W.head[0],Y=W.head[1];Z=X,Q=K(G,V,Y),J=K}}}function XJ(Z,Q,J){return M6(M9(Z),Q,J)}function U6(Z,Q){let J=(W,G,K)=>{if(Z(G,K))return BZ(W,G,K);else return W};return XJ(Q,tZ(),J)}function vG(Z,Q){return U6(Q,Z)}function gG(Z){if(Z instanceof x)return!0;else return!1}function m8(Z,Q){if(Z instanceof x){let J=Z[0];return new x(Q(J))}else return Z}function U9(Z,Q){if(Z instanceof x)return Z;else{let J=Z[0];return new b(Q(J))}}function kQ(Z,Q){if(Z instanceof x){let J=Z[0];return Q(J)}else return Z}function vJ(Z,Q){if(Z instanceof x)return Z[0];else return Q}function F9(Z,Q){if(Z instanceof x)return Z[0];else return Q()}class VJ extends F{constructor(Z){super();this.dict=Z}}function PZ(){return new VJ(tZ())}function uG(Z){return A(Z,PZ())}function YJ(Z,Q){let J=Z.dict,W=FZ(J,Q);return gG(W)}function R9(Z){return KQ(Z.dict)}function oQ(Z,Q,J){return XJ(Z.dict,Q,(W,G,K)=>{return J(W,G)})}function _G(Z,Q){return new VJ(vG(Z.dict,(J,W)=>{return Q(J)}))}function F6(Z,Q){if(tQ(Z.dict)>tQ(Q.dict))return[Z,Q];else return[Q,Z]}var $G=void 0;function HJ(Z,Q){return new VJ(BZ(Z.dict,Q,$G))}function xZ(Z){let Q=wZ(Z,tZ(),(J,W)=>{return BZ(J,W,$G)});return new VJ(Q)}function kZ(Z,Q){return oQ(Z,PZ(),(J,W)=>{return HJ(J,Q(W))})}function eQ(Z,Q){let J=F6(Z,Q),W,G;return W=J[0],G=J[1],oQ(G,W,HJ)}class c8 extends F{constructor(Z){super();this.dict=Z}}function b9(){return new c8(tZ())}function p8(Z,Q){let J=Z.dict,W=FZ(J,Q);return vJ(W,0)}function f9(Z,Q){let J=p8(Z,Q)+1,W=BZ(Z.dict,Q,J);return new c8(W)}var r="src/chess.gleam";class s8 extends F{constructor(Z,Q,J,W){super();this.internal=Z,this.history=Q,this.status=J,this.starting_position=W}}class _Z extends F{constructor(Z,Q,J,W,G,K,X,V,Y){super();this.board=Z,this.moving_player=Q,this.en_passant_possible=J,this.short_castle_disqualified_white=W,this.long_castle_disqualified_white=G,this.short_castle_disqualified_black=K,this.long_castle_disqualified_black=X,this.fifty_move_rule_counter=V,this.threefold_repetition_counter=Y}}class cG extends F{constructor(Z,Q,J,W,G,K,X){super();this.board=Z,this.moving_player=Q,this.en_passant_possible=J,this.short_castle_disqualified_white=W,this.long_castle_disqualified_white=G,this.short_castle_disqualified_black=K,this.long_castle_disqualified_black=X}}class VQ extends F{constructor(Z){super();this.info=Z}}class u9 extends F{constructor(Z){super();this.next_player=Z}}class uJ extends F{constructor(Z,Q){super();this.winner=Z,this.by=Q}}class MJ extends F{constructor(Z){super();this.by=Z}}class _J extends F{}class pG extends F{}class dG extends F{}class sG extends F{}class nG extends F{}class XQ extends F{constructor(Z,Q,J){super();this.white_king=Z,this.black_king=Q,this.other_figures=J}}class s extends F{}class ZQ extends F{}class mZ extends F{}class zZ extends F{}class QQ extends F{}class yQ extends F{}class f extends F{}class YZ extends F{}class j extends F{constructor(Z,Q){super();this.file=Z,this.row=Q}}class ZZ extends F{}class AZ extends F{}class JZ extends F{}class qZ extends F{}class p extends F{}class NZ extends F{}class WZ extends F{}class TZ extends F{}class h extends F{}class RZ extends F{}class sZ extends F{}class gZ extends F{}class uZ extends F{}class nZ extends F{}class IZ extends F{}class _ extends F{}class AQ extends F{constructor(Z,Q){super();this.from=Z,this.to=Q}}class bQ extends F{constructor(Z,Q,J){super();this.from=Z,this.to=Q,this.new_figure=J}}class fQ extends F{constructor(Z,Q){super();this.from=Z,this.to=Q}}class hQ extends F{}class $J extends F{}class lG extends F{}class rG extends F{}class mJ extends F{}class cJ extends F{constructor(Z){super();this.reason=Z}}class iG extends F{}class aG extends F{}class tG extends F{constructor(Z){super();this.reason=Z}}class yZ extends F{constructor(Z){super();this.to=Z}}class YQ extends F{constructor(Z){super();this.to=Z}}class HQ extends F{constructor(Z){super();this.to=Z}}class MQ extends F{}class n8 extends F{}class pJ extends F{constructor(Z,Q,J){super();this.origin=Z,this.offset=Q,this.attacker=J}}class dJ extends F{constructor(Z,Q,J){super();this.origin=Z,this.direction=Q,this.attacker=J}}class oG extends F{}class eG extends F{}function l8(Z){return tQ(Z.internal.board.other_figures)+2}function Z9(Z){return Z.status}function I6(Z){return Z.fifty_move_rule_counter>=100}function z6(){return new XQ(new j(new p,new h),new j(new p,new _),lQ(z([[new j(new ZZ,new h),[new zZ,new f]],[new j(new AZ,new h),[new ZQ,new f]],[new j(new JZ,new h),[new mZ,new f]],[new j(new qZ,new h),[new QQ,new f]],[new j(new NZ,new h),[new mZ,new f]],[new j(new WZ,new h),[new ZQ,new f]],[new j(new TZ,new h),[new zZ,new f]],[new j(new ZZ,new RZ),[new s,new f]],[new j(new AZ,new RZ),[new s,new f]],[new j(new JZ,new RZ),[new s,new f]],[new j(new qZ,new RZ),[new s,new f]],[new j(new p,new RZ),[new s,new f]],[new j(new NZ,new RZ),[new s,new f]],[new j(new WZ,new RZ),[new s,new f]],[new j(new TZ,new RZ),[new s,new f]],[new j(new ZZ,new _),[new zZ,new YZ]],[new j(new AZ,new _),[new ZQ,new YZ]],[new j(new JZ,new _),[new mZ,new YZ]],[new j(new qZ,new _),[new QQ,new YZ]],[new j(new NZ,new _),[new mZ,new YZ]],[new j(new WZ,new _),[new ZQ,new YZ]],[new j(new TZ,new _),[new zZ,new YZ]],[new j(new ZZ,new IZ),[new s,new YZ]],[new j(new AZ,new IZ),[new s,new YZ]],[new j(new JZ,new IZ),[new s,new YZ]],[new j(new qZ,new IZ),[new s,new YZ]],[new j(new p,new IZ),[new s,new YZ]],[new j(new NZ,new IZ),[new s,new YZ]],[new j(new WZ,new IZ),[new s,new YZ]],[new j(new TZ,new IZ),[new s,new YZ]]])))}function Z0(){let Z=new _Z(z6(),new f,new y,!1,!1,!1,!1,0,b9());return new s8(Z,z([]),new u9(new f),Z)}function l(Z,Q){let J=Z.white_king;if(A(J,Q))return new S([new yQ,new f]);else{let W=Z.black_king;if(A(W,Q))return new S([new yQ,new YZ]);else{let K=Z.other_figures,X=FZ(K,Q);return S8(X)}}}function UQ(Z,Q){let J=Z.internal.board;return l(J,Q)}function mG(Z){let Q,J=Z.file;if(J instanceof ZZ)Q=0;else if(J instanceof AZ)Q=1;else if(J instanceof JZ)Q=2;else if(J instanceof qZ)Q=3;else if(J instanceof p)Q=4;else if(J instanceof NZ)Q=5;else if(J instanceof WZ)Q=6;else Q=7;let W=Q,G,K=Z.row;if(K instanceof h)G=0;else if(K instanceof RZ)G=1;else if(K instanceof sZ)G=2;else if(K instanceof gZ)G=3;else if(K instanceof uZ)G=4;else if(K instanceof nZ)G=5;else if(K instanceof IZ)G=6;else G=7;let V=(W+G)%2;if(V===0)return new eG;else if(V===1)return new oG;else throw g("panic",r,"chess",1828,"coord_colour","`panic` expression evaluated.",{})}function q6(Z){let Q=M9(Z.other_figures);if(Q instanceof B)return!0;else{let J=Q.tail;if(J instanceof B){let W=Q.head[1][0];if(W instanceof ZQ)return!0;else if(W instanceof mZ)return!0;else return!1}else if(J.tail instanceof B)if(J.head[1][0]instanceof mZ)if(Q.head[1][0]instanceof mZ){let X=J.head[1][1],V=Q.head[1][1];if(!A(V,X)){let Y=J.head[0],H=Q.head[0];return A(mG(H),mG(Y))}else return!1}else return!1;else return!1;else return!1}}function N6(Z,Q){while(!0){let J=Z,W=Q,G=yJ(W,0);if(G instanceof XZ)if(J instanceof h)return new y;else if(J instanceof RZ)Z=new h,Q=W+1;else if(J instanceof sZ)Z=new RZ,Q=W+1;else if(J instanceof gZ)Z=new sZ,Q=W+1;else if(J instanceof uZ)Z=new gZ,Q=W+1;else if(J instanceof nZ)Z=new uZ,Q=W+1;else if(J instanceof IZ)Z=new nZ,Q=W+1;else Z=new IZ,Q=W+1;else if(G instanceof VZ)return new S(J);else if(J instanceof h)Z=new RZ,Q=W-1;else if(J instanceof RZ)Z=new sZ,Q=W-1;else if(J instanceof sZ)Z=new gZ,Q=W-1;else if(J instanceof gZ)Z=new uZ,Q=W-1;else if(J instanceof uZ)Z=new nZ,Q=W-1;else if(J instanceof nZ)Z=new IZ,Q=W-1;else if(J instanceof IZ)Z=new _,Q=W-1;else return new y}}function d8(Z,Q){while(!0){let J=Z,W=Q,G=yJ(W,0);if(G instanceof XZ)if(J instanceof ZZ)return new y;else if(J instanceof AZ)Z=new ZZ,Q=W+1;else if(J instanceof JZ)Z=new AZ,Q=W+1;else if(J instanceof qZ)Z=new JZ,Q=W+1;else if(J instanceof p)Z=new qZ,Q=W+1;else if(J instanceof NZ)Z=new p,Q=W+1;else if(J instanceof WZ)Z=new NZ,Q=W+1;else Z=new WZ,Q=W+1;else if(G instanceof VZ)return new S(J);else if(J instanceof ZZ)Z=new AZ,Q=W-1;else if(J instanceof AZ)Z=new JZ,Q=W-1;else if(J instanceof JZ)Z=new qZ,Q=W-1;else if(J instanceof qZ)Z=new p,Q=W-1;else if(J instanceof p)Z=new NZ,Q=W-1;else if(J instanceof NZ)Z=new WZ,Q=W-1;else if(J instanceof WZ)Z=new TZ,Q=W-1;else return new y}}function D6(Z,Q){return CQ(Z.en_passant_possible,(J)=>{let W=z([d8(J,-1),d8(J,1)]),G=nQ(W),K=SG(G,(X)=>{let V;if(Z.moving_player instanceof f)V=[new j(X,new uZ),new j(J,new nZ)];else V=[new j(X,new gZ),new j(J,new sZ)];let H=V,U,M;if(U=H[0],M=H[1],A(Q,U))return new x(new HQ(M));else return new b(void 0)});return S8(K)})}function h9(Z,Q,J){return CQ(d8(Z.file,Q),(W)=>{return CQ(N6(Z.row,J),(G)=>{return new S(new j(W,G))})})}function O6(Z,Q){let J;if(Z.moving_player instanceof f)J=1;else J=-1;let G=J,K=CQ(h9(Q,0,G),(C)=>{if(l(Z.board,C)instanceof S)return new y;else return new S(C)}),X=CQ(K,(C)=>{let N;if(Z.moving_player instanceof f)N=new gZ;else N=new uZ;let E=N;return CQ(h9(C,0,G),(v)=>{return KZ(!A(v.row,E),new y,()=>{if(l(Z.board,v)instanceof S)return new y;else return new S(v)})})}),V=CQ(h9(Q,-1,G),(C)=>{let N=l(Z.board,C);if(N instanceof S){let w=N[0][1];if(A(w,Z.moving_player))return new y;else return new S(C)}else return N}),Y=CQ(h9(Q,1,G),(C)=>{let N=l(Z.board,C);if(N instanceof S){let w=N[0][1];if(A(w,Z.moving_player))return new y;else return new S(C)}else return N}),H,U=z([K,X,V,Y]),M=nQ(U),R=EZ(M,(C)=>{let N;if(Z.moving_player instanceof f)N=new _;else N=new h;let E=N,v=C.row;if(A(v,E))return new YQ(C);else return new yZ(C)});H=xZ(R);let q=H,I=D6(Z,Q),P,O=z([I]),L=nQ(O),T=xZ(L);return P=eQ(T,q),P}function j6(Z,Q,J,W,G){while(!0){let K=Z,X=Q,V=J,Y=W,H=G,U=h9(X,V[0],V[1]);if(U instanceof S){let M=U[0],R=l(K,M);if(R instanceof S){let q=R[0][1];if(A(q,Y))return H;else return HJ(H,M)}else Z=K,Q=M,J=V,W=Y,G=HJ(H,M)}else return H}}function UJ(Z,Q){if(Q instanceof pJ){let{origin:J,attacker:W}=Q,G=Q.offset[0],K=Q.offset[1],X=h9(J,G,K);if(X instanceof S){let V=X[0],Y=l(Z,V);if(Y instanceof S){let H=Y[0][1];if(A(H,W))return PZ();else return xZ(z([V]))}else return xZ(z([V]))}else return PZ()}else{let{origin:J,direction:W,attacker:G}=Q;return j6(Z,J,W,G,PZ())}}function B6(Z,Q,J){let W=z([[1,2],[2,1],[2,-1],[1,-2],[-1,-2],[-2,-1],[-2,1],[-1,2]]),G=xZ(W),K=kZ(G,(Y)=>{return new pJ(Q,Y,J)}),X=kZ(K,(Y)=>{return UJ(Z,Y)}),V=oQ(X,PZ(),eQ);return kZ(V,(Y)=>{return new yZ(Y)})}function A6(Z,Q,J){let W=z([[0,1],[1,0],[0,-1],[-1,0]]),G=xZ(W),K=kZ(G,(Y)=>{return new dJ(Q,Y,J)}),X=kZ(K,(Y)=>{return UJ(Z,Y)}),V=oQ(X,PZ(),eQ);return kZ(V,(Y)=>{return new yZ(Y)})}function P6(Z,Q,J){let W=z([[1,1],[1,-1],[-1,-1],[-1,1]]),G=xZ(W),K=kZ(G,(Y)=>{return new dJ(Q,Y,J)}),X=kZ(K,(Y)=>{return UJ(Z,Y)}),V=oQ(X,PZ(),eQ);return kZ(V,(Y)=>{return new yZ(Y)})}function T6(Z,Q,J){let W=z([[0,1],[1,0],[0,-1],[-1,0],[1,1],[1,-1],[-1,-1],[-1,1]]),G=xZ(W),K=kZ(G,(Y)=>{return new dJ(Q,Y,J)}),X=kZ(K,(Y)=>{return UJ(Z,Y)}),V=oQ(X,PZ(),eQ);return kZ(V,(Y)=>{return new yZ(Y)})}function v9(Z){if(Z instanceof f)return new YZ;else return new f}function g9(Z){return new cG(Z.board,Z.moving_player,Z.en_passant_possible,Z.short_castle_disqualified_white,Z.long_castle_disqualified_white,Z.short_castle_disqualified_black,Z.long_castle_disqualified_black)}function S6(Z){let Q=new _Z(Z.board,v9(Z.moving_player),Z.en_passant_possible,Z.short_castle_disqualified_white,Z.long_castle_disqualified_white,Z.short_castle_disqualified_black,Z.long_castle_disqualified_black,Z.fifty_move_rule_counter,Z.threefold_repetition_counter),J=g9(Q);return(()=>{let W=Q.threefold_repetition_counter;return p8(W,J)})()>=2}var t=`Critical internal error!
This is not your fault (unless you mutated the internal state!).
If you see this message then this likely means, that something in this package's logic is incorrect.
Please open an issue at https://github.com/OlZe/Functional-Chess with a detailled description to help improve this package.
Sorry for the inconvience.`;function L6(Z,Q,J){let W;if(FZ(Z.board.other_figures,J)instanceof x)W=!0;else W=!1;let K=W,X,V=FZ(Z.board.other_figures,Q);if(V instanceof x)if(V[0][0]instanceof s)X=!0;else X=!1;else X=!1;let Y=X,H=KZ(Y,0,()=>{return KZ(K,0,()=>{return Z.fifty_move_rule_counter+1})}),U=KZ(K,b9(),()=>{return KZ(Y,b9(),()=>{let q=Z.threefold_repetition_counter;return f9(q,g9(Z))})}),M=Z.board,R=M.white_king;if(A(R,Q)){let{black_king:q,other_figures:I}=M;return new _Z(new XQ(J,q,eZ(I,J)),Z.moving_player,new y,!0,!0,Z.short_castle_disqualified_black,Z.long_castle_disqualified_black,H,U)}else{let q=M.black_king;if(A(q,Q)){let{white_king:I,other_figures:P}=M;return new _Z(new XQ(I,J,eZ(P,J)),Z.moving_player,new y,Z.short_castle_disqualified_white,Z.long_castle_disqualified_white,!0,!0,H,U)}else{let{white_king:I,black_king:P,other_figures:O}=M,L=FZ(O,Q),T;if(L instanceof x)T=L[0];else throw g("let_assert",r,"chess",1522,"do_move_standard_figure_move",t,{value:L,start:46713,end:46773,pattern_start:46724,pattern_end:46741});let k;if(T[1]instanceof f)if(T[0]instanceof s&&(A(Q.row,new RZ)&&A(J.row,new gZ))&&A(Q.file,J.file))k=new S(J.file);else k=new y;else if(T[0]instanceof s&&(A(Q.row,new IZ)&&A(J.row,new uZ))&&A(Q.file,J.file))k=new S(J.file);else k=new y;let N=k,w=Z.short_castle_disqualified_white||A(Q,new j(new TZ,new h))||A(J,new j(new TZ,new h)),E=Z.long_castle_disqualified_white||A(Q,new j(new ZZ,new h))||A(J,new j(new ZZ,new h)),v=Z.short_castle_disqualified_black||A(Q,new j(new TZ,new _))||A(J,new j(new TZ,new _)),m=Z.long_castle_disqualified_black||A(Q,new j(new ZZ,new _))||A(J,new j(new ZZ,new _));return new _Z(new XQ(I,P,(()=>{let HZ=eZ(O,Q);return BZ(HZ,J,T)})()),Z.moving_player,N,w,E,v,m,H,U)}}}function C6(Z,Q,J,W){let{board:G,moving_player:K}=Z,X=l(G,Q),V=new S([new s,K]);if(!A(X,V))throw g("assert",r,"chess",1588,"do_move_pawn_promotion",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:X,start:48810,end:48832},right:{kind:"expression",value:V,start:48836,end:48864},start:48803,end:48864,expression_start:48810});let Y=Z.short_castle_disqualified_white||A(J,new j(new TZ,new h)),H=Z.long_castle_disqualified_white||A(J,new j(new ZZ,new h)),U=Z.short_castle_disqualified_black||A(J,new j(new TZ,new _)),M=Z.long_castle_disqualified_black||A(J,new j(new ZZ,new _));return new _Z(new XQ(G.white_king,G.black_king,(()=>{let R=G.other_figures,q=eZ(R,Q);return BZ(q,J,[W,K])})()),Z.moving_player,new y,Y,H,U,M,0,b9())}function E6(Z,Q,J){let{board:W,moving_player:G}=Z,K=new j(J.file,Q.row),X=l(W,Q),V=new S([new s,G]);if(!A(X,V))throw g("assert",r,"chess",1634,"do_move_en_passant",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:X,start:50394,end:50416},right:{kind:"expression",value:V,start:50420,end:50448},start:50387,end:50448,expression_start:50394});let Y=l(W,K),H=new S([new s,v9(G)]);if(!A(Y,H))throw g("assert",r,"chess",1637,"do_move_en_passant",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:Y,start:50486,end:50520},right:{kind:"expression",value:H,start:50528,end:50569},start:50479,end:50569,expression_start:50486});let U=l(W,J);if(!A(U,new y))throw g("assert",r,"chess",1641,"do_move_en_passant",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:U,start:50607,end:50627},right:{kind:"literal",value:new y,start:50631,end:50635},start:50600,end:50635,expression_start:50607});return new _Z(new XQ(W.white_king,W.black_king,(()=>{let M=W.other_figures,R=eZ(M,Q),q=eZ(R,K);return BZ(q,J,[new s,G])})()),Z.moving_player,new y,Z.short_castle_disqualified_white,Z.long_castle_disqualified_white,Z.short_castle_disqualified_black,Z.long_castle_disqualified_black,0,b9())}function w6(Z){let{board:Q,moving_player:J}=Z,W;if(J instanceof f)W=new h;else W=new _;let G=W,K=new j(new p,G),X=new j(new WZ,G),V=new j(new TZ,G),Y=new j(new NZ,G),H=l(Q,K),U=new S([new yQ,J]);if(!A(H,U))throw g("assert",r,"chess",1674,"do_move_short_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:H,start:51584,end:51611},right:{kind:"expression",value:U,start:51615,end:51643},start:51577,end:51643,expression_start:51584});let M=l(Q,X);if(!A(M,new y))throw g("assert",r,"chess",1676,"do_move_short_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:M,start:51680,end:51705},right:{kind:"literal",value:new y,start:51709,end:51713},start:51673,end:51713,expression_start:51680});let R=l(Q,V),q=new S([new zZ,J]);if(!A(R,q))throw g("assert",r,"chess",1677,"do_move_short_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:R,start:51746,end:51773},right:{kind:"expression",value:q,start:51777,end:51805},start:51739,end:51805,expression_start:51746});let I=l(Q,Y);if(!A(I,new y))throw g("assert",r,"chess",1679,"do_move_short_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:I,start:51842,end:51867},right:{kind:"literal",value:new y,start:51871,end:51875},start:51835,end:51875,expression_start:51842});if(J instanceof f)return new _Z(new XQ(X,Q.black_king,(()=>{let P=Q.other_figures,O=eZ(P,V);return BZ(O,Y,[new zZ,J])})()),Z.moving_player,new y,!0,!0,Z.short_castle_disqualified_black,Z.long_castle_disqualified_black,Z.fifty_move_rule_counter,(()=>{let P=Z.threefold_repetition_counter;return f9(P,g9(Z))})());else return new _Z(new XQ(Q.white_king,X,(()=>{let P=Q.other_figures,O=eZ(P,V);return BZ(O,Y,[new zZ,J])})()),Z.moving_player,new y,Z.short_castle_disqualified_white,Z.long_castle_disqualified_white,!0,!0,Z.fifty_move_rule_counter,(()=>{let P=Z.threefold_repetition_counter;return f9(P,g9(Z))})())}function x6(Z){let{board:Q,moving_player:J}=Z,W;if(J instanceof f)W=new h;else W=new _;let G=W,K=new j(new p,G),X=new j(new JZ,G),V=new j(new ZZ,G),Y=new j(new qZ,G),H=new j(new AZ,G),U=l(Q,K),M=new S([new yQ,J]);if(!A(U,M))throw g("assert",r,"chess",1737,"do_move_long_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:U,start:53665,end:53692},right:{kind:"expression",value:M,start:53696,end:53724},start:53658,end:53724,expression_start:53665});let R=l(Q,X);if(!A(R,new y))throw g("assert",r,"chess",1739,"do_move_long_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:R,start:53761,end:53786},right:{kind:"literal",value:new y,start:53790,end:53794},start:53754,end:53794,expression_start:53761});let q=l(Q,V),I=new S([new zZ,J]);if(!A(q,I))throw g("assert",r,"chess",1740,"do_move_long_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:q,start:53827,end:53854},right:{kind:"expression",value:I,start:53858,end:53886},start:53820,end:53886,expression_start:53827});let P=l(Q,Y);if(!A(P,new y))throw g("assert",r,"chess",1742,"do_move_long_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:P,start:53923,end:53948},right:{kind:"literal",value:new y,start:53952,end:53956},start:53916,end:53956,expression_start:53923});let O=l(Q,H);if(!A(O,new y))throw g("assert",r,"chess",1743,"do_move_long_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:O,start:53989,end:54016},right:{kind:"literal",value:new y,start:54020,end:54024},start:53982,end:54024,expression_start:53989});if(J instanceof f)return new _Z(new XQ(X,Q.black_king,(()=>{let L=Q.other_figures,T=eZ(L,V);return BZ(T,Y,[new zZ,J])})()),Z.moving_player,new y,!0,!0,Z.short_castle_disqualified_black,Z.long_castle_disqualified_black,Z.fifty_move_rule_counter,(()=>{let L=Z.threefold_repetition_counter;return f9(L,g9(Z))})());else return new _Z(new XQ(Q.white_king,X,(()=>{let L=Q.other_figures,T=eZ(L,V);return BZ(T,Y,[new zZ,J])})()),Z.moving_player,new y,Z.short_castle_disqualified_white,Z.long_castle_disqualified_white,!0,!0,Z.fifty_move_rule_counter,(()=>{let L=Z.threefold_repetition_counter;return f9(L,g9(Z))})())}function r8(Z,Q){if(Q instanceof AQ){let{from:J,to:W}=Q;return L6(Z,J,W)}else if(Q instanceof bQ){let{from:J,to:W,new_figure:G}=Q;return C6(Z,J,W,G)}else if(Q instanceof fQ){let{from:J,to:W}=Q;return E6(Z,J,W)}else if(Q instanceof hQ)return w6(Z);else return x6(Z)}function gJ(Z,Q,J){let W;return W=WJ(Q,(X)=>{let V=l(Z.board,X);return UG(V)}),KZ(!W,!1,()=>{let X;if(Z.moving_player instanceof f)X=new j(new p,new h);else X=new j(new p,new _);let Y=X,H,M=EZ(J,(I)=>{return new AQ(Y,I)}),R=EZ(M,(I)=>{return r8(Z,I)});return H=GJ(R,sJ),!H})}function sJ(Z){let Q;if(Z.moving_player instanceof f)Q=Z.board.white_king;else Q=Z.board.black_king;let W=Q,G=v9(Z.moving_player),K=Z.board.other_figures,X=M9(K),V=w9(X,(M)=>{return A(M[1][1],G)}),Y=EZ(V,(M)=>{return M[0]}),H=k9(Y,(M)=>{let R=Q0(new _Z(Z.board,G,Z.en_passant_possible,Z.short_castle_disqualified_white,Z.long_castle_disqualified_white,Z.short_castle_disqualified_black,Z.long_castle_disqualified_black,Z.fifty_move_rule_counter,Z.threefold_repetition_counter),M),q=m8(R,R9);return vJ(q,z([]))}),U=bJ(H,(M)=>{if(M instanceof yZ){let R=M.to;return new x(R)}else if(M instanceof YQ){let R=M.to;return new x(R)}else if(M instanceof HQ)return new b(void 0);else if(M instanceof MQ)return new b(void 0);else return new b(void 0)});return GJ(U,(M)=>{return A(M,W)})}function Q0(Z,Q){let J,W=l(Z.board,Q);return J=FG(W,new lG),kQ(J,(K)=>{let X,V;return X=K[0],V=K[1],KZ(!A(V,Z.moving_player),new b(new rG),()=>{let Y;if(X instanceof s)Y=O6(Z,Q);else if(X instanceof ZQ)Y=B6(Z.board,Q,Z.moving_player);else if(X instanceof mZ)Y=P6(Z.board,Q,Z.moving_player);else if(X instanceof zZ)Y=A6(Z.board,Q,Z.moving_player);else if(X instanceof QQ)Y=T6(Z.board,Q,Z.moving_player);else Y=k6(Z,Q);return new x(Y)})})}function k6(Z,Q){let J,W=z([[0,1],[1,1],[1,0],[1,-1],[0,-1],[-1,-1],[-1,0],[-1,1]]),G=xZ(W),K=kZ(G,(C)=>{return new pJ(Q,C,Z.moving_player)}),X=kZ(K,(C)=>{return UJ(Z.board,C)}),V=oQ(X,PZ(),eQ);J=kZ(V,(C)=>{return new yZ(C)});let Y=J,H;if(y6(Z))H=new S(new MQ);else H=new y;let M=H,R;if(v6(Z))R=new S(new n8);else R=new y;let I=R,P,O=z([M,I]),L=nQ(O),T=xZ(L);return P=eQ(T,Y),P}function y6(Z){if(Z.moving_player instanceof f)return KZ(Z.short_castle_disqualified_white,!1,()=>{let J=l(Z.board,new j(new p,new h)),W=new S([new yQ,new f]);if(!A(J,W))throw g("assert",r,"chess",1080,"can_short_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:J,start:32415,end:32461},right:{kind:"literal",value:W,start:32473,end:32493},start:32408,end:32493,expression_start:32415});let G=l(Z.board,new j(new TZ,new h)),K=new S([new zZ,new f]);if(!A(G,K))throw g("assert",r,"chess",1084,"can_short_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:G,start:32539,end:32585},right:{kind:"literal",value:K,start:32597,end:32617},start:32532,end:32617,expression_start:32539});return gJ(Z,z([new j(new NZ,new h),new j(new WZ,new h)]),z([new j(new p,new h),new j(new NZ,new h),new j(new WZ,new h)]))});else return KZ(Z.short_castle_disqualified_black,!1,()=>{let J=l(Z.board,new j(new p,new _)),W=new S([new yQ,new YZ]);if(!A(J,W))throw g("assert",r,"chess",1106,"can_short_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:J,start:33208,end:33254},right:{kind:"literal",value:W,start:33266,end:33286},start:33201,end:33286,expression_start:33208});let G=l(Z.board,new j(new TZ,new _)),K=new S([new zZ,new YZ]);if(!A(G,K))throw g("assert",r,"chess",1110,"can_short_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:G,start:33332,end:33378},right:{kind:"literal",value:K,start:33390,end:33410},start:33325,end:33410,expression_start:33332});return gJ(Z,z([new j(new NZ,new _),new j(new WZ,new _)]),z([new j(new p,new _),new j(new NZ,new _),new j(new WZ,new _)]))})}function nJ(Z){return sJ(Z.internal)}function i8(Z,Q){return kQ(Q0(Z,Q),(J)=>{let G=_G(J,(K)=>{let X;if(K instanceof yZ){let M=K.to;X=new AQ(Q,M)}else if(K instanceof YQ){let M=K.to;X=new bQ(Q,M,new QQ)}else if(K instanceof HQ){let M=K.to;X=new fQ(Q,M)}else if(K instanceof MQ)X=new hQ;else X=new $J;let H=r8(Z,X),U=sJ(H);return XG(U)});return new x(G)})}function a8(Z,Q){let J=Z.status;if(J instanceof VQ)return new b(new aG);else{let W=Z.internal,G=J.next_player,K=W.moving_player;if(!A(K,G))throw g("assert",r,"chess",486,"get_moves",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:K,start:14480,end:14498},right:{kind:"expression",value:G,start:14502,end:14515},start:14473,end:14515,expression_start:14480});let X=i8(W,Q);return U9(X,(V)=>{return new tG(V)})}}function J0(Z){let Q;if(Z.moving_player instanceof f)Q=Z.board.white_king;else Q=Z.board.black_king;let W=Q,G,K=Z.board.other_figures,X=M9(K),V=bJ(X,(I)=>{let P,O;if(P=I[0],O=I[1][1],A(O,Z.moving_player))return new x(P);else return new b(void 0)});G=x9(V,z([W]));let Y=G,H,M=EZ(Y,(I)=>{let P,O=i8(Z,I);return P=F9(O,()=>{throw g("panic",r,"chess",821,"get_all_moves_internal",t,{})}),[I,P]}),R=w9(M,(I)=>{let P;return P=I[1],!uG(P)});return H=lQ(R),H}function W0(Z){let Q=Z.status;if(Q instanceof VQ)return new b(void 0);else{let J=Z.internal,W=Q.next_player,G=J.moving_player;if(!A(G,W))throw g("assert",r,"chess",508,"get_all_moves",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:G,start:15284,end:15302},right:{kind:"expression",value:W,start:15306,end:15319},start:15277,end:15319,expression_start:15284});return new x(J0(J))}}function b6(Z){let Q=v9(Z.moving_player),J=new _Z(Z.board,Q,Z.en_passant_possible,Z.short_castle_disqualified_white,Z.long_castle_disqualified_white,Z.short_castle_disqualified_black,Z.long_castle_disqualified_black,Z.fifty_move_rule_counter,Z.threefold_repetition_counter),W,G=J0(J);W=u8(G);let K=W,X=sJ(J);if(K)if(X)return new S(new uJ(Z.moving_player,new _J));else return new S(new MJ(new pG));else return new y}function f6(Z){let Q;if(q6(Z.board))Q=new S(new MJ(new dG));else Q=new y;return ZJ(Q,()=>{let G=b6(Z);return ZJ(G,()=>{let K;if(S6(Z))K=new S(new MJ(new sG));else K=new y;return ZJ(K,()=>{let Y;if(I6(Z))Y=new S(new MJ(new nG));else Y=new y;return ZJ(Y,()=>{return new y})})})})}function h6(Z,Q){{let J,W;{let X;if(Q instanceof AQ)X=Q.from;else if(Q instanceof bQ)X=Q.from;else if(Q instanceof fQ)X=Q.from;else if(Q instanceof hQ)if(Z.moving_player instanceof f)X=new j(new p,new h);else X=new j(new p,new _);else if(Z.moving_player instanceof f)X=new j(new p,new h);else X=new j(new p,new _);W=i8(Z,X)}return J=U9(W,(X)=>{return new cJ(X)}),kQ(J,(X)=>{let V;{let H;if(Q instanceof AQ){let M=Q.to;H=new yZ(M)}else if(Q instanceof bQ){let M=Q.to;H=new YQ(M)}else if(Q instanceof fQ){let M=Q.to;H=new HQ(M)}else if(Q instanceof hQ)H=new MQ;else H=new n8;V=YJ(X,H)}return KZ(!V,new b(new iG),()=>{let H=r8(Z,Q),U,M=f6(H);if(M instanceof S){let I=M[0];U=new VQ(I)}else U=new u9(v9(H.moving_player));let R=U,q=new _Z(H.board,v9(H.moving_player),H.en_passant_possible,H.short_castle_disqualified_white,H.long_castle_disqualified_white,H.short_castle_disqualified_black,H.long_castle_disqualified_black,H.fifty_move_rule_counter,H.threefold_repetition_counter);return new x([q,R])})})}}function lJ(Z,Q){let J=Z.status;if(J instanceof VQ)return new b(new mJ);else{let W=Z.internal,G=J.next_player,K=W.moving_player;if(!A(K,G))throw g("assert",r,"chess",418,"player_move",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:K,start:12251,end:12278},right:{kind:"expression",value:G,start:12282,end:12295},start:12244,end:12295,expression_start:12251});return kQ(h6(W,Q),(X)=>{let V,Y;return V=X[0],Y=X[1],new x(new s8(V,(()=>{let H=Z.history;return x9(H,z([[Q,G]]))})(),Y,Z.starting_position))})}}function v6(Z){if(Z.moving_player instanceof f)return KZ(Z.long_castle_disqualified_white,!1,()=>{let J=l(Z.board,new j(new p,new h)),W=new S([new yQ,new f]);if(!A(J,W))throw g("assert",r,"chess",1138,"can_long_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:J,start:34151,end:34197},right:{kind:"literal",value:W,start:34209,end:34229},start:34144,end:34229,expression_start:34151});let G=l(Z.board,new j(new ZZ,new h)),K=new S([new zZ,new f]);if(!A(G,K))throw g("assert",r,"chess",1142,"can_long_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:G,start:34275,end:34321},right:{kind:"literal",value:K,start:34333,end:34353},start:34268,end:34353,expression_start:34275});return gJ(Z,z([new j(new qZ,new h),new j(new JZ,new h),new j(new AZ,new h)]),z([new j(new p,new h),new j(new qZ,new h),new j(new JZ,new h)]))});else return KZ(Z.long_castle_disqualified_black,!1,()=>{let J=l(Z.board,new j(new p,new _)),W=new S([new yQ,new YZ]);if(!A(J,W))throw g("assert",r,"chess",1168,"can_long_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:J,start:35009,end:35055},right:{kind:"literal",value:W,start:35067,end:35087},start:35002,end:35087,expression_start:35009});let G=l(Z.board,new j(new ZZ,new _)),K=new S([new zZ,new YZ]);if(!A(G,K))throw g("assert",r,"chess",1172,"can_long_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:G,start:35133,end:35179},right:{kind:"literal",value:K,start:35191,end:35211},start:35126,end:35211,expression_start:35133});return gJ(Z,z([new j(new qZ,new _),new j(new JZ,new _),new j(new AZ,new _)]),z([new j(new p,new _),new j(new qZ,new _),new j(new JZ,new _)]))})}function OZ(Z){return Z}var JQ=()=>globalThis?.document,iJ="http://www.w3.org/1999/xhtml",aJ=1,o8=3;var V0=!!globalThis.HTMLElement?.prototype?.moveBefore;var u=z([]),tJ=new y;var d6=new EQ,s6=new XZ,n6=new VZ;function oJ(Z,Q){if(Z.name===Q.name)return n6;else if(Z.name<Q.name)return s6;else return d6}class PQ extends F{constructor(Z,Q,J){super();this.kind=Z,this.name=Q,this.value=J}}class eJ extends F{constructor(Z,Q,J){super();this.kind=Z,this.name=Q,this.value=J}}class bZ extends F{constructor(Z,Q,J,W,G,K,X,V,Y){super();this.kind=Z,this.name=Q,this.handler=J,this.include=W,this.prevent_default=G,this.stop_propagation=K,this.immediate=X,this.debounce=V,this.throttle=Y}}class RJ extends F{constructor(Z,Q,J){super();this.prevent_default=Z,this.stop_propagation=Q,this.message=J}}class F0 extends F{constructor(Z){super();this.kind=Z}}class R0 extends F{constructor(Z){super();this.kind=Z}}function o6(Z,Q){while(!0){let J=Z,W=Q;if(J instanceof B)return W;else{let G=J.head;if(G instanceof PQ){let K=G.name;if(K==="")Z=J.tail,Q=W;else if(K==="class"){let X=G.value;if(X==="")Z=J.tail,Q=W;else{let V=J.tail;if(V instanceof B){let Y=G;Z=V,Q=D(Y,W)}else{let Y=V.head;if(Y instanceof PQ)if(Y.name==="class"){let U=G.kind,M=X,R=V.tail,q=Y.value,I=M+" "+q,P=new PQ(U,"class",I);Z=D(P,R),Q=W}else{let U=G;Z=V,Q=D(U,W)}else{let H=G;Z=V,Q=D(H,W)}}}}else if(K==="style"){let X=G.value;if(X==="")Z=J.tail,Q=W;else{let V=J.tail;if(V instanceof B){let Y=G;Z=V,Q=D(Y,W)}else{let Y=V.head;if(Y instanceof PQ)if(Y.name==="style"){let U=G.kind,M=X,R=V.tail,q=Y.value,I=M+";"+q,P=new PQ(U,"style",I);Z=D(P,R),Q=W}else{let U=G;Z=V,Q=D(U,W)}else{let H=G;Z=V,Q=D(H,W)}}}}else{let X=G;Z=J.tail,Q=D(X,W)}}else{let K=G;Z=J.tail,Q=D(K,W)}}}}function I0(Z){if(Z instanceof B)return Z;else if(Z.tail instanceof B)return Z;else{let W=LG(Z,(G,K)=>{return oJ(K,G)});return o6(W,u)}}var QW=0;function z0(Z,Q){return new PQ(QW,Z,Q)}var q0=1;var JW=2;function N0(Z,Q,J,W,G,K,X,V){return new bZ(JW,Z,Q,J,W,G,K,X,V)}var WW=0;var GW=new F0(WW);var Z8=2,D0=new R0(Z8);function gQ(Z,Q){return z0(Z,Q)}function SZ(Z){return gQ("class",Z)}function O0(Z,Q){while(!0){let J=Z,W=Q;if(J instanceof B)return W;else if(J.head[1]){let K=J.tail,X=J.head[0];return W+X+" "+O0(K,W)}else Z=J.tail,Q=W}}function m9(Z){return SZ(O0(Z,""))}function Q8(Z){return gQ("draggable",(()=>{if(Z)return"true";else return"false"})())}function J8(Z){return gQ("href",Z)}function W8(Z){return gQ("target",Z)}function G8(Z){return gQ("alt",Z)}function K8(Z){return gQ("src",Z)}class V8 extends F{constructor(Z,Q,J){super();this.synchronous=Z,this.before_paint=Q,this.after_paint=J}}class j0 extends F{constructor(Z,Q,J,W,G){super();this.dispatch=Z,this.emit=Q,this.select=J,this.root=W,this.provide=G}}function B0(Z,Q,J,W,G,K){let X=new j0(Q,J,W,G,K);return CG(Z.synchronous,(V)=>{return V(X)})}var X8=new V8(z([]),z([]),z([]));function IJ(){return X8}function A0(Z){return new V8(z([(J)=>{let W=J.dispatch;return Z(W)}]),X8.before_paint,X8.after_paint)}function P0(Z){return wZ(Z,X8,(Q,J)=>{return new V8(wZ(J.synchronous,Q.synchronous,fJ),wZ(J.before_paint,Q.before_paint,fJ),wZ(J.after_paint,Q.after_paint,fJ))})}function lZ(){return null}function zJ(Z,Q){let J=Z?.get(Q);if(J!=null)return new x(J);else return new b(void 0)}function qJ(Z,Q){return Z&&Z.has(Q)}function I9(Z,Q,J){return Z??=new Map,Z.set(Q,J),Z}function KW(Z,Q){return Z?.delete(Q),Z}class XW extends F{}class VW extends F{constructor(Z,Q){super();this.key=Z,this.parent=Q}}class T0 extends F{constructor(Z,Q){super();this.index=Z,this.parent=Q}}function J7(Z,Q){while(!0){let J=Z,W=Q;if(W instanceof B)return!1;else{let{head:G,tail:K}=W,X=_8(J,G);if(X)return X;else Z=J,Q=K}}}function RQ(Z,Q,J){if(J==="")return new T0(Q,Z);else return new VW(J,Z)}var Y8=new XW,DJ="\t";function S0(Z,Q){while(!0){let J=Z,W=Q;if(J instanceof XW)if(W instanceof B)return"";else{let G=W.tail;return wG(G)}else if(J instanceof VW){let G=J.key;Z=J.parent,Q=D(DJ,D(G,W))}else{let G=J.index;Z=J.parent,Q=D(DJ,D(aQ(G),W))}}}function W7(Z){return S0(Z,z([]))}function L0(Z,Q){if(Q instanceof B)return!1;else return J7(W7(Z),Q)}var YW=`
`;function HW(Z,Q){return S0(Z,z([YW,Q]))}class IQ extends F{constructor(Z,Q,J,W,G){super();this.kind=Z,this.key=Q,this.mapper=J,this.children=W,this.keyed_children=G}}class zQ extends F{constructor(Z,Q,J,W,G,K,X,V,Y,H){super();this.kind=Z,this.key=Q,this.mapper=J,this.namespace=W,this.tag=G,this.attributes=K,this.children=X,this.keyed_children=V,this.self_closing=Y,this.void=H}}class qQ extends F{constructor(Z,Q,J,W){super();this.kind=Z,this.key=Q,this.mapper=J,this.content=W}}class p9 extends F{constructor(Z,Q,J,W,G,K,X){super();this.kind=Z,this.key=Q,this.mapper=J,this.namespace=W,this.tag=G,this.attributes=K,this.inner_html=X}}function X7(Z,Q){if(Q==="")if(Z==="area")return!0;else if(Z==="base")return!0;else if(Z==="br")return!0;else if(Z==="col")return!0;else if(Z==="embed")return!0;else if(Z==="hr")return!0;else if(Z==="img")return!0;else if(Z==="input")return!0;else if(Z==="link")return!0;else if(Z==="meta")return!0;else if(Z==="param")return!0;else if(Z==="source")return!0;else if(Z==="track")return!0;else if(Z==="wbr")return!0;else return!1;else return!1}function E0(Z,Q){if(Q instanceof IQ)return new IQ(Q.kind,Z,Q.mapper,Q.children,Q.keyed_children);else if(Q instanceof zQ)return new zQ(Q.kind,Z,Q.mapper,Q.namespace,Q.tag,Q.attributes,Q.children,Q.keyed_children,Q.self_closing,Q.void);else if(Q instanceof qQ)return new qQ(Q.kind,Z,Q.mapper,Q.content);else return new p9(Q.kind,Z,Q.mapper,Q.namespace,Q.tag,Q.attributes,Q.inner_html)}var NQ=0;function MW(Z,Q,J,W){return new IQ(NQ,Z,Q,J,W)}var z9=1;function OJ(Z,Q,J,W,G,K,X,V,Y){return new zQ(z9,Z,Q,J,W,I0(G),K,X,V,Y||X7(W,J))}var d9=2;function UW(Z,Q,J){return new qQ(d9,Z,Q,J)}var w0=3;var FW=(Z,Q)=>Z===Q,N9=(Z,Q)=>{if(Z===Q)return!0;if(Z==null||Q==null)return!1;let J=typeof Z;if(J!==typeof Q)return!1;if(J!=="object")return!1;if(Z.constructor!==Q.constructor)return!1;if(Array.isArray(Z))return V7(Z,Q);return Y7(Z,Q)},V7=(Z,Q)=>{let J=Z.length;if(J!==Q.length)return!1;while(J--)if(!N9(Z[J],Q[J]))return!1;return!0},Y7=(Z,Q)=>{let J=Object.keys(Z),W=J.length;if(Object.keys(Q).length!==W)return!1;while(W--){let G=J[W];if(!Object.hasOwn(Q,G))return!1;if(!N9(Z[G],Q[G]))return!1}return!0};class _Q extends F{constructor(Z,Q,J){super();this.handlers=Z,this.dispatched_paths=Q,this.next_dispatched_paths=J}}function IW(){return new _Q(lZ(),u,u)}function b0(Z){return new _Q(Z.handlers,Z.next_dispatched_paths,u)}function f0(Z,Q,J){return KW(Z,HW(Q,J))}function jJ(Z,Q,J){let W=f0(Z.handlers,Q,J);return new _Q(W,Z.dispatched_paths,Z.next_dispatched_paths)}function x0(Z,Q,J){return wZ(J,Z,(W,G)=>{if(G instanceof bZ){let K=G.name;return f0(W,Q,K)}else return W})}function BJ(Z,Q,J,W){let G=D(Q,Z.next_dispatched_paths),K=new _Q(Z.handlers,Z.dispatched_paths,G),X=zJ(K.handlers,Q+YW+J);if(X instanceof x){let V=X[0];return[K,H9(W,V)]}else return[K,new b(z([]))]}function H8(Z,Q){return L0(Q,Z.dispatched_paths)}function h0(Z,Q,J,W,G){return I9(Z,HW(J,W),hJ(G,(K)=>{return new RJ(K.prevent_default,K.stop_propagation,OZ(Q)(K.message))}))}function AJ(Z,Q,J,W,G){let K=h0(Z.handlers,Q,J,W,G);return new _Q(K,Z.dispatched_paths,Z.next_dispatched_paths)}function k0(Z,Q,J,W){return wZ(W,Z,(G,K)=>{if(K instanceof bZ){let{name:X,handler:V}=K;return h0(G,Q,J,X,V)}else return G})}function Q9(Z,Q){let J=FW(Z,OZ);if(FW(Q,OZ))return Z;else if(J)return Q;else return(G)=>{return Z(Q(G))}}function y0(Z,Q,J,W){while(!0){let G=Z,K=Q,X=J,V=W;if(V instanceof B)return G;else{let{head:Y,tail:H}=V;Z=v0(G,K,X,Y),Q=K,J=X+1,W=H}}}function v0(Z,Q,J,W){if(W instanceof IQ){let G=W.children,K=RQ(Q,J,W.key);return y0(Z,K,0,G)}else if(W instanceof zQ){let{attributes:G,children:K}=W,X=RQ(Q,J,W.key),Y=x0(Z,X,G);return y0(Y,X,0,K)}else if(W instanceof qQ)return Z;else{let G=W.attributes,K=RQ(Q,J,W.key);return x0(Z,K,G)}}function $Q(Z,Q,J,W){let G=v0(Z.handlers,Q,J,W);return new _Q(G,Z.dispatched_paths,Z.next_dispatched_paths)}function RW(Z,Q,J,W,G){while(!0){let K=Z,X=Q,V=J,Y=W,H=G;if(H instanceof B)return K;else{let{head:U,tail:M}=H;Z=g0(K,X,V,Y,U),Q=X,J=V,W=Y+1,G=M}}}function g0(Z,Q,J,W,G){if(G instanceof IQ){let K=G.children,X=RQ(J,W,G.key),V=Q9(Q,G.mapper);return RW(Z,V,X,0,K)}else if(G instanceof zQ){let{attributes:K,children:X}=G,V=RQ(J,W,G.key),Y=Q9(Q,G.mapper),U=k0(Z,Y,V,K);return RW(U,Y,V,0,X)}else if(G instanceof qQ)return Z;else{let K=G.attributes,X=RQ(J,W,G.key),V=Q9(Q,G.mapper);return k0(Z,V,X,K)}}function mQ(Z,Q,J,W,G){let K=g0(Z.handlers,Q,J,W,G);return new _Q(K,Z.dispatched_paths,Z.next_dispatched_paths)}function u0(Z){return mQ(IW(),OZ,Y8,0,Z)}function _0(Z,Q,J,W,G){let K=RW(Z.handlers,Q,J,W,G);return new _Q(K,Z.dispatched_paths,Z.next_dispatched_paths)}function cQ(Z,Q,J){return OJ("",OZ,"",Z,Q,J,lZ(),!1,!1)}function M8(Z){return UW("",OZ,Z)}function $0(){return UW("",OZ,"")}function TQ(Z){return M8(Z)}function m0(Z,Q){return cQ("body",Z,Q)}function c0(Z,Q){return cQ("aside",Z,Q)}function p0(Z,Q){return cQ("main",Z,Q)}function W9(Z,Q){return cQ("div",Z,Q)}function n9(Z,Q){return cQ("p",Z,Q)}function U8(Z,Q){return cQ("a",Z,Q)}function F8(Z){return cQ("img",Z,u)}class TJ extends F{constructor(Z,Q,J,W){super();this.index=Z,this.removed=Q,this.changes=J,this.children=W}}class d0 extends F{constructor(Z,Q){super();this.kind=Z,this.content=Q}}class s0 extends F{constructor(Z,Q){super();this.kind=Z,this.inner_html=Q}}class n0 extends F{constructor(Z,Q,J){super();this.kind=Z,this.added=Q,this.removed=J}}class l0 extends F{constructor(Z,Q,J){super();this.kind=Z,this.key=Q,this.before=J}}class r0 extends F{constructor(Z,Q,J){super();this.kind=Z,this.index=Q,this.with=J}}class i0 extends F{constructor(Z,Q){super();this.kind=Z,this.index=Q}}class a0 extends F{constructor(Z,Q,J){super();this.kind=Z,this.children=Q,this.before=J}}function zW(Z,Q,J,W){return new TJ(Z,Q,J,W)}var qW=0;function t0(Z){return new d0(qW,Z)}var NW=1;function o0(Z){return new s0(NW,Z)}var DW=2;function OW(Z,Q){return new n0(DW,Z,Q)}var jW=3;function e0(Z,Q){return new l0(jW,Z,Q)}var BW=4;function ZK(Z){return new i0(BW,Z)}var AW=5;function D9(Z,Q){return new r0(AW,Z,Q)}var PW=6;function TW(Z,Q){return new a0(PW,Z,Q)}class JK extends F{constructor(Z,Q,J,W,G,K,X,V){super();this.kind=Z,this.open_shadow_root=Q,this.will_adopt_styles=J,this.observed_attributes=W,this.observed_properties=G,this.requested_contexts=K,this.provided_contexts=X,this.vdom=V}}class WK extends F{constructor(Z,Q){super();this.kind=Z,this.patch=Q}}class GK extends F{constructor(Z,Q,J){super();this.kind=Z,this.name=Q,this.data=J}}class KK extends F{constructor(Z,Q,J){super();this.kind=Z,this.key=Q,this.value=J}}class R8 extends F{constructor(Z,Q){super();this.kind=Z,this.messages=Q}}class I8 extends F{constructor(Z,Q,J){super();this.kind=Z,this.name=Q,this.value=J}}class z8 extends F{constructor(Z,Q,J){super();this.kind=Z,this.name=Q,this.value=J}}class q8 extends F{constructor(Z,Q,J,W){super();this.kind=Z,this.path=Q,this.name=J,this.event=W}}class SW extends F{constructor(Z,Q,J){super();this.kind=Z,this.key=Q,this.value=J}}var R7=0;function XK(Z,Q,J,W,G,K,X){return new JK(R7,Z,Q,J,W,G,K,X)}var I7=1;function LW(Z){return new WK(I7,Z)}var z7=2;function VK(Z,Q){return new GK(z7,Z,Q)}var q7=3;function YK(Z,Q){return new KK(q7,Z,Q)}class N8 extends F{constructor(Z,Q){super();this.patch=Z,this.events=Q}}class UK extends F{constructor(Z,Q,J){super();this.added=Z,this.removed=Q,this.events=J}}function N7(Z,Q,J,W){if(J==="input"&&Q==="")return H8(Z,W);else if(J==="select"&&Q==="")return H8(Z,W);else if(J==="textarea"&&Q==="")return H8(Z,W);else return!1}function MK(Z,Q,J,W,G,K,X,V){while(!0){let Y=Z,H=Q,U=J,M=W,R=G,q=K,I=X,P=V;if(q instanceof B)if(R instanceof B)return new UK(I,P,M);else{let O=R.head;if(O instanceof bZ){let L=O,T=R.tail,k=O.name,C=D(L,P),N=jJ(M,H,k);Z=Y,Q=H,J=U,W=N,G=T,K=q,X=I,V=C}else{let L=O,T=R.tail,k=D(L,P);Z=Y,Q=H,J=U,W=M,G=T,K=q,X=I,V=k}}else if(R instanceof B){let O=q.head;if(O instanceof bZ){let L=O,T=q.tail,k=O.name,C=O.handler,N=D(L,I),w=AJ(M,U,H,k,C);Z=Y,Q=H,J=U,W=w,G=R,K=T,X=N,V=P}else{let L=O,T=q.tail,k=D(L,I);Z=Y,Q=H,J=U,W=M,G=R,K=T,X=k,V=P}}else{let{head:O,tail:L}=q,T=R.head,k=R.tail,C=oJ(T,O);if(C instanceof XZ)if(T instanceof bZ){let N=T.name,w=D(T,P),E=jJ(M,H,N);Z=Y,Q=H,J=U,W=E,G=k,K=q,X=I,V=w}else{let N=D(T,P);Z=Y,Q=H,J=U,W=M,G=k,K=q,X=I,V=N}else if(C instanceof VZ)if(O instanceof PQ)if(T instanceof PQ){let N,w=O.name;if(w==="value")N=Y||T.value!==O.value;else if(w==="checked")N=Y||T.value!==O.value;else if(w==="selected")N=Y||T.value!==O.value;else N=T.value!==O.value;let E=N,v;if(E)v=D(O,I);else v=I;let m=v;Z=Y,Q=H,J=U,W=M,G=k,K=L,X=m,V=P}else if(T instanceof bZ){let N=T.name,w=D(O,I),E=D(T,P),v=jJ(M,H,N);Z=Y,Q=H,J=U,W=v,G=k,K=L,X=w,V=E}else{let N=D(O,I),w=D(T,P);Z=Y,Q=H,J=U,W=M,G=k,K=L,X=N,V=w}else if(O instanceof eJ)if(T instanceof eJ){let N,w=O.name;if(w==="scrollLeft")N=!0;else if(w==="scrollRight")N=!0;else if(w==="value")N=Y||!N9(T.value,O.value);else if(w==="checked")N=Y||!N9(T.value,O.value);else if(w==="selected")N=Y||!N9(T.value,O.value);else N=!N9(T.value,O.value);let E=N,v;if(E)v=D(O,I);else v=I;let m=v;Z=Y,Q=H,J=U,W=M,G=k,K=L,X=m,V=P}else if(T instanceof bZ){let N=T.name,w=D(O,I),E=D(T,P),v=jJ(M,H,N);Z=Y,Q=H,J=U,W=v,G=k,K=L,X=w,V=E}else{let N=D(O,I),w=D(T,P);Z=Y,Q=H,J=U,W=M,G=k,K=L,X=N,V=w}else if(T instanceof bZ){let{name:N,handler:w}=O,E=T.prevent_default.kind!==O.prevent_default.kind||T.stop_propagation.kind!==O.stop_propagation.kind||T.immediate!==O.immediate||T.debounce!==O.debounce||T.throttle!==O.throttle,v;if(E)v=D(O,I);else v=I;let m=v,c=AJ(M,U,H,N,w);Z=Y,Q=H,J=U,W=c,G=k,K=L,X=m,V=P}else{let{name:N,handler:w}=O,E=D(O,I),v=D(T,P),m=AJ(M,U,H,N,w);Z=Y,Q=H,J=U,W=m,G=k,K=L,X=E,V=v}else if(O instanceof bZ){let{name:N,handler:w}=O,E=D(O,I),v=AJ(M,U,H,N,w);Z=Y,Q=H,J=U,W=v,G=R,K=L,X=E,V=P}else{let N=D(O,I);Z=Y,Q=H,J=U,W=M,G=R,K=L,X=N,V=P}}}}function CW(Z,Q,J,W,G,K,X,V,Y,H,U,M,R,q){while(!0){let I=Z,P=Q,O=J,L=W,T=G,k=K,C=X,N=V,w=Y,E=H,v=U,m=M,c=R,HZ=q;if(O instanceof B)if(I instanceof B)return new N8(new TJ(w,C,v,m),HZ);else{let{head:$Z,tail:SQ}=I,MZ;if($Z.key===""||!qJ(T,$Z.key))MZ=C+1;else MZ=C;let $=MZ,QZ=$Q(HZ,E,N,$Z);Z=SQ,Q=P,J=O,W=L,G=T,K=k,X=$,V=N,Y=w,H=E,U=v,M=m,R=c,q=QZ}else if(I instanceof B){let $Z=_0(HZ,c,E,N,O),SQ=TW(O,N-k),MZ=D(SQ,v);return new N8(new TJ(w,C,MZ,m),$Z)}else{let $Z=O.head,SQ=I.head;if(SQ.key!==$Z.key){let MZ=O.tail,GZ=I.tail,$=zJ(P,$Z.key),QZ=qJ(L,SQ.key);if($ instanceof x)if(QZ){let n=$[0];if(qJ(T,SQ.key))Z=GZ,Q=P,J=O,W=L,G=T,K=k-1,X=C,V=N,Y=w,H=E,U=v,M=m,R=c,q=HZ;else{let o=N-k,d=D(e0($Z.key,o),v),UZ=I9(T,$Z.key,void 0),a=k+1;Z=D(n,I),Q=P,J=O,W=L,G=UZ,K=a,X=C,V=N,Y=w,H=E,U=d,M=m,R=c,q=HZ}}else{let n=N-k,i=D(ZK(n),v),o=$Q(HZ,E,N,SQ),d=k-1;Z=GZ,Q=P,J=O,W=L,G=T,K=d,X=C,V=N,Y=w,H=E,U=i,M=m,R=c,q=o}else if(QZ){let n=N-k,i=mQ(HZ,c,E,N,$Z),o=TW(z([$Z]),n),d=D(o,v);Z=I,Q=P,J=MZ,W=L,G=T,K=k+1,X=C,V=N+1,Y=w,H=E,U=d,M=m,R=c,q=i}else{let n=D9(N-k,$Z),i,d=$Q(HZ,E,N,SQ);i=mQ(d,c,E,N,$Z);let UZ=i;Z=GZ,Q=P,J=MZ,W=L,G=T,K=k,X=C,V=N+1,Y=w,H=E,U=D(n,v),M=m,R=c,q=UZ}}else{let MZ=I.head;if(MZ instanceof IQ){let GZ=O.head;if(GZ instanceof IQ){let $=GZ,QZ=O.tail,n=MZ,i=I.tail,o=Q9(c,$.mapper),d=RQ(E,N,$.key),UZ=CW(n.children,n.keyed_children,$.children,$.keyed_children,lZ(),0,0,0,N,d,u,u,o,HZ),a,DZ=UZ.patch;if(DZ.children instanceof B)if(DZ.changes instanceof B)if(DZ.removed===0)a=m;else a=D(UZ.patch,m);else a=D(UZ.patch,m);else a=D(UZ.patch,m);let DQ=a;Z=i,Q=P,J=QZ,W=L,G=T,K=k,X=C,V=N+1,Y=w,H=E,U=v,M=DQ,R=c,q=UZ.events}else{let $=GZ,QZ=O.tail,n=MZ,i=I.tail,o=D9(N-k,$),d,a=$Q(HZ,E,N,n);d=mQ(a,c,E,N,$);let DZ=d;Z=i,Q=P,J=QZ,W=L,G=T,K=k,X=C,V=N+1,Y=w,H=E,U=D(o,v),M=m,R=c,q=DZ}}else if(MZ instanceof zQ){let GZ=O.head;if(GZ instanceof zQ){let $=GZ,QZ=MZ;if(QZ.namespace===$.namespace&&QZ.tag===$.tag){let n=O.tail,i=I.tail,o=Q9(c,$.mapper),d=RQ(E,N,$.key),UZ=N7(HZ,$.namespace,$.tag,d),a=MK(UZ,d,o,HZ,QZ.attributes,$.attributes,u,u),DZ,LQ,DQ;DZ=a.added,LQ=a.removed,DQ=a.events;let X9;if(LQ instanceof B&&DZ instanceof B)X9=u;else X9=z([OW(DZ,LQ)]);let T9=X9,S9=CW(QZ.children,QZ.keyed_children,$.children,$.keyed_children,lZ(),0,0,0,N,d,T9,u,o,DQ),sQ,V9=S9.patch;if(V9.children instanceof B)if(V9.changes instanceof B)if(V9.removed===0)sQ=m;else sQ=D(S9.patch,m);else sQ=D(S9.patch,m);else sQ=D(S9.patch,m);let JX=sQ;Z=i,Q=P,J=n,W=L,G=T,K=k,X=C,V=N+1,Y=w,H=E,U=v,M=JX,R=c,q=S9.events}else{let n=GZ,i=O.tail,o=MZ,d=I.tail,UZ=D9(N-k,n),a,LQ=$Q(HZ,E,N,o);a=mQ(LQ,c,E,N,n);let DQ=a;Z=d,Q=P,J=i,W=L,G=T,K=k,X=C,V=N+1,Y=w,H=E,U=D(UZ,v),M=m,R=c,q=DQ}}else{let $=GZ,QZ=O.tail,n=MZ,i=I.tail,o=D9(N-k,$),d,a=$Q(HZ,E,N,n);d=mQ(a,c,E,N,$);let DZ=d;Z=i,Q=P,J=QZ,W=L,G=T,K=k,X=C,V=N+1,Y=w,H=E,U=D(o,v),M=m,R=c,q=DZ}}else if(MZ instanceof qQ){let GZ=O.head;if(GZ instanceof qQ){let $=GZ;if(MZ.content===$.content){let n=O.tail;Z=I.tail,Q=P,J=n,W=L,G=T,K=k,X=C,V=N+1,Y=w,H=E,U=v,M=m,R=c,q=HZ}else{let n=GZ,i=O.tail,o=I.tail,d=zW(N,0,z([t0(n.content)]),u);Z=o,Q=P,J=i,W=L,G=T,K=k,X=C,V=N+1,Y=w,H=E,U=v,M=D(d,m),R=c,q=HZ}}else{let $=GZ,QZ=O.tail,n=MZ,i=I.tail,o=D9(N-k,$),d,a=$Q(HZ,E,N,n);d=mQ(a,c,E,N,$);let DZ=d;Z=i,Q=P,J=QZ,W=L,G=T,K=k,X=C,V=N+1,Y=w,H=E,U=D(o,v),M=m,R=c,q=DZ}}else{let GZ=O.head;if(GZ instanceof p9){let $=GZ,QZ=O.tail,n=MZ,i=I.tail,o=Q9(c,$.mapper),d=RQ(E,N,$.key),UZ=MK(!1,d,o,HZ,n.attributes,$.attributes,u,u),a,DZ,LQ;a=UZ.added,DZ=UZ.removed,LQ=UZ.events;let DQ;if(DZ instanceof B&&a instanceof B)DQ=u;else DQ=z([OW(a,DZ)]);let X9=DQ,T9;if(n.inner_html===$.inner_html)T9=X9;else T9=D(o0($.inner_html),X9);let sQ=T9,V9;if(sQ instanceof B)V9=m;else V9=D(zW(N,0,sQ,z([])),m);let KG=V9;Z=i,Q=P,J=QZ,W=L,G=T,K=k,X=C,V=N+1,Y=w,H=E,U=v,M=KG,R=c,q=LQ}else{let $=GZ,QZ=O.tail,n=MZ,i=I.tail,o=D9(N-k,$),d,a=$Q(HZ,E,N,n);d=mQ(a,c,E,N,$);let DZ=d;Z=i,Q=P,J=QZ,W=L,G=T,K=k,X=C,V=N+1,Y=w,H=E,U=D(o,v),M=m,R=c,q=DZ}}}}}}function l9(Z,Q,J){return CW(z([Q]),lZ(),z([J]),lZ(),lZ(),0,0,0,0,Y8,u,u,OZ,b0(Z))}var{setTimeout:D7,clearTimeout:EW}=globalThis,O7=(Z,Q)=>JQ().createElementNS(Z,Q),j7=(Z)=>JQ().createTextNode(Z),B7=()=>JQ().createDocumentFragment(),r9=(Z,Q,J)=>Z.insertBefore(Q,J),RK=V0?(Z,Q,J)=>Z.moveBefore(Q,J):r9,A7=(Z,Q)=>Z.removeChild(Q),P7=(Z,Q)=>Z.getAttribute(Q),IK=(Z,Q,J)=>Z.setAttribute(Q,J),T7=(Z,Q)=>Z.removeAttribute(Q),S7=(Z,Q,J,W)=>Z.addEventListener(Q,J,W),zK=(Z,Q,J)=>Z.removeEventListener(Q,J),L7=(Z,Q)=>Z.innerHTML=Q,C7=(Z,Q)=>Z.data=Q,pQ=Symbol("lustre");class DK{constructor(Z,Q,J,W){this.kind=Z,this.key=W,this.parent=Q,this.children=[],this.node=J,this.handlers=new Map,this.throttles=new Map,this.debouncers=new Map}get parentNode(){return this.kind===NQ?this.node.parentNode:this.node}}var dQ=(Z,Q,J,W,G)=>{let K=new DK(Z,Q,J,G);return J[pQ]=K,Q?.children.splice(W,0,K),K},E7=(Z)=>{let Q="";for(let J=Z[pQ];J.parent;J=J.parent)if(J.key)Q=`${DJ}${J.key}${Q}`;else{let W=J.parent.children.indexOf(J);Q=`${DJ}${W}${Q}`}return Q.slice(1)};class xW{#Z=null;#G=()=>{};#W=!1;#J=!1;constructor(Z,Q,{useServerEvents:J=!1,exposeKeys:W=!1}={}){this.#Z=Z,this.#G=Q,this.#W=J,this.#J=W}mount(Z){dQ(z9,null,this.#Z,0,null),this.#D(this.#Z,null,this.#Z[pQ],0,Z)}push(Z){this.#Q.push({node:this.#Z[pQ],patch:Z}),this.#K()}#Q=[];#K(){let Z=this.#Q;while(Z.length){let{node:Q,patch:J}=Z.pop(),{children:W}=Q,{changes:G,removed:K,children:X}=J;if(O9(G,(V)=>this.#X(Q,V)),K)this.#I(Q,W.length-K,K);O9(X,(V)=>{let Y=W[V.index|0];this.#Q.push({node:Y,patch:V})})}}#X(Z,Q){switch(Q.kind){case qW:this.#P(Z,Q);break;case NW:this.#O(Z,Q);break;case DW:this.#z(Z,Q);break;case jW:this.#U(Z,Q);break;case BW:this.#F(Z,Q);break;case AW:this.#M(Z,Q);break;case PW:this.#Y(Z,Q);break}}#Y(Z,{children:Q,before:J}){let W=B7(),G=this.#H(Z,J);this.#N(W,null,Z,J|0,Q),r9(Z.parentNode,W,G)}#M(Z,{index:Q,with:J}){this.#I(Z,Q|0,1);let W=this.#H(Z,Q);this.#D(Z.parentNode,W,Z,Q|0,J)}#H(Z,Q){Q=Q|0;let{children:J}=Z,W=J.length;if(Q<W)return J[Q].node;let G=J[W-1];if(!G&&Z.kind!==NQ)return null;if(!G)G=Z;while(G.kind===NQ&&G.children.length)G=G.children[G.children.length-1];return G.node.nextSibling}#U(Z,{key:Q,before:J}){J=J|0;let{children:W,parentNode:G}=Z,K=W[J].node,X=W[J];for(let U=J+1;U<W.length;++U){let M=W[U];if(W[U]=X,X=M,M.key===Q){W[J]=M;break}}let{kind:V,node:Y,children:H}=X;if(RK(G,Y,K),V===NQ)this.#V(G,H,K)}#V(Z,Q,J){for(let W=0;W<Q.length;++W){let{kind:G,node:K,children:X}=Q[W];if(RK(Z,K,J),G===NQ)this.#V(Z,X,J)}}#F(Z,{index:Q}){this.#I(Z,Q,1)}#I(Z,Q,J){let{children:W,parentNode:G}=Z,K=W.splice(Q,J);for(let X=0;X<K.length;++X){let{kind:V,node:Y,children:H}=K[X];if(A7(G,Y),this.#R(K[X]),V===NQ)K.push(...H)}}#R(Z){let{debouncers:Q,children:J}=Z;for(let{timeout:W}of Q.values())if(W)EW(W);Q.clear(),O9(J,(W)=>this.#R(W))}#z({node:Z,handlers:Q,throttles:J,debouncers:W},{added:G,removed:K}){O9(K,({name:X})=>{if(Q.delete(X))zK(Z,X,wW),this.#q(J,X,0),this.#q(W,X,0);else T7(Z,X),NK[X]?.removed?.(Z,X)}),O9(G,(X)=>this.#A(Z,X))}#P({node:Z},{content:Q}){C7(Z,Q??"")}#O({node:Z},{inner_html:Q}){L7(Z,Q??"")}#N(Z,Q,J,W,G){O9(G,(K)=>this.#D(Z,Q,J,W++,K))}#D(Z,Q,J,W,G){switch(G.kind){case z9:{let K=this.#j(J,W,G);this.#N(K,null,K[pQ],0,G.children),r9(Z,K,Q);break}case d9:{let K=this.#B(J,W,G);r9(Z,K,Q);break}case NQ:{let K=this.#B(J,W,G);r9(Z,K,Q),this.#N(Z,Q,K[pQ],0,G.children);break}case w0:{let K=this.#j(J,W,G);this.#O({node:K},G),r9(Z,K,Q);break}}}#j(Z,Q,{kind:J,key:W,tag:G,namespace:K,attributes:X}){let V=O7(K||iJ,G);if(dQ(J,Z,V,Q,W),this.#J&&W)IK(V,"data-lustre-key",W);return O9(X,(Y)=>this.#A(V,Y)),V}#B(Z,Q,{kind:J,key:W,content:G}){let K=j7(G??"");return dQ(J,Z,K,Q,W),K}#A(Z,Q){let{debouncers:J,handlers:W,throttles:G}=Z[pQ],{kind:K,name:X,value:V,prevent_default:Y,debounce:H,throttle:U}=Q;switch(K){case QW:{let M=V??"";if(X==="virtual:defaultValue"){Z.defaultValue=M;return}if(M!==P7(Z,X))IK(Z,X,M);NK[X]?.added?.(Z,M);break}case q0:Z[X]=V;break;case JW:{if(W.has(X))zK(Z,X,wW);let M=Y.kind===WW;S7(Z,X,wW,{passive:M}),this.#q(G,X,U),this.#q(J,X,H),W.set(X,(R)=>this.#T(Q,R));break}}}#q(Z,Q,J){let W=Z.get(Q);if(J>0)if(W)W.delay=J;else Z.set(Q,{delay:J});else if(W){let{timeout:G}=W;if(G)EW(G);Z.delete(Q)}}#T(Z,Q){let{currentTarget:J,type:W}=Q,{debouncers:G,throttles:K}=J[pQ],X=E7(J),{prevent_default:V,stop_propagation:Y,include:H,immediate:U}=Z;if(V.kind===Z8)Q.preventDefault();if(Y.kind===Z8)Q.stopPropagation();if(W==="submit")Q.detail??={},Q.detail.formData=[...new FormData(Q.target,Q.submitter).entries()];let M=this.#W?w7(Q,H??[]):Q,R=K.get(W);if(R){let I=Date.now(),P=R.last||0;if(I>P+R.delay)R.last=I,R.lastEvent=Q,this.#G(M,X,W,U)}let q=G.get(W);if(q)EW(q.timeout),q.timeout=D7(()=>{if(Q===K.get(W)?.lastEvent)return;this.#G(M,X,W,U)},q.delay);if(!R&&!q)this.#G(M,X,W,U)}}var O9=(Z,Q)=>{if(Array.isArray(Z))for(let J=0;J<Z.length;J++)Q(Z[J]);else if(Z)for(Z;Z.head;Z=Z.tail)Q(Z.head)},wW=(Z)=>{let{currentTarget:Q,type:J}=Z;Q[pQ].handlers.get(J)(Z)},w7=(Z,Q=[])=>{let J={};if(Z.type==="input"||Z.type==="change")Q.push("target.value");if(Z.type==="submit")Q.push("detail.formData");for(let W of Q){let G=W.split(".");for(let K=0,X=Z,V=J;K<G.length;K++){if(K===G.length-1){V[G[K]]=X[G[K]];break}V=V[G[K]]??={},X=X[G[K]]}}return J},qK=(Z)=>{return{added(Q){Q[Z]=!0},removed(Q){Q[Z]=!1}}},x7=(Z)=>{return{added(Q,J){Q[Z]=J}}},NK={checked:qK("checked"),selected:qK("selected"),value:x7("value"),autofocus:{added(Z){queueMicrotask(()=>{Z.focus?.()})}},autoplay:{added(Z){try{Z.play?.()}catch(Q){console.error(Q)}}}};function k7(Z,Q,J){while(!0){let W=Z,G=Q,K=J;if(W instanceof B)return[G,e(K)];else{let X=W.tail,V=W.head[0],Y=W.head[1],H=E0(V,Y),U;if(V==="")U=G;else U=I9(G,V,H);let M=U,R=D(H,K);Z=X,Q=M,J=R}}}function kW(Z){return k7(Z,lZ(),u)}function OK(Z,Q,J){let W=kW(J),G,K;return G=W[0],K=W[1],OJ("",OZ,"",Z,Q,K,G,!1,!1)}function jK(Z,Q,J,W){let G=kW(W),K,X;return K=G[0],X=G[1],OJ("",OZ,Z,Q,J,X,K,!1,!1)}function BK(Z){let Q=kW(Z),J,W;return J=Q[0],W=Q[1],MW("",OZ,W,J)}var AK=(Z)=>{let Q=dQ(z9,null,Z,0,null),J=0;for(let X=Z.firstChild;X;X=X.nextSibling)if(PK(X))J+=1;if(J===0){let X=JQ().createTextNode("");return dQ(d9,Q,X,0,null),Z.replaceChildren(X),$0()}if(J===1)return yW(Q,Z).head[1];let W=JQ().createTextNode(""),G=dQ(NQ,Q,W,0,null),K=yW(G,Z);return Z.insertBefore(W,Z.firstChild),BK(K)},PK=(Z)=>{switch(Z.nodeType){case aJ:return!0;case o8:return!!Z.data;default:return!1}},y7=(Z,Q,J,W)=>{if(!PK(Q))return null;switch(Q.nodeType){case aJ:{let G=dQ(z9,Z,Q,W,J),K=Q.localName,X=Q.namespaceURI,V=!X||X===iJ;if(V&&b7.includes(K))f7(K,Q);let Y=h7(Q),H=yW(G,Q);return V?OK(K,Y,H):jK(X,K,Y,H)}case o8:return dQ(d9,Z,Q,W,null),M8(Q.data);default:return null}},b7=["input","select","textarea"],f7=(Z,Q)=>{let{value:J,checked:W}=Q;if(Z==="input"&&Q.type==="checkbox"&&!W)return;if(Z==="input"&&Q.type==="radio"&&!W)return;if(Q.type!=="checkbox"&&Q.type!=="radio"&&!J)return;queueMicrotask(()=>{if(Q.value=J,Q.checked=W,Q.dispatchEvent(new Event("input",{bubbles:!0})),Q.dispatchEvent(new Event("change",{bubbles:!0})),JQ().activeElement!==Q)Q.dispatchEvent(new Event("blur",{bubbles:!0}))})},yW=(Z,Q)=>{let J=null,W=Q.firstChild,G=null,K=0;while(W){let X=W.nodeType===aJ?W.getAttribute("data-lustre-key"):null;if(X!=null)W.removeAttribute("data-lustre-key");let V=y7(Z,W,X,K),Y=W.nextSibling;if(V){let H=new pZ([X??"",V],null);if(G)G=G.tail=H;else G=J=H;K+=1}else Q.removeChild(W);W=Y}if(!G)return u;return G.tail=u,J},h7=(Z)=>{let Q=Z.attributes.length,J=u;while(Q-- >0){let W=Z.attributes[Q];if(W.name==="xmlns")continue;J=new pZ(v7(W),J)}return J},v7=(Z)=>{let{localName:Q,value:J}=Z;return gQ(Q,J)};var SJ=()=>!!JQ();class D8{constructor(Z,[Q,J],W,G){this.root=Z,this.#Z=Q,this.#G=W,this.#W=G,this.root.addEventListener("context-request",(K)=>{if(!(K.context&&K.callback))return;if(!this.#X.has(K.context))return;K.stopImmediatePropagation();let X=this.#X.get(K.context);if(K.subscribe){let V=()=>{X.subscribers=X.subscribers.filter((Y)=>Y!==K.callback)};X.subscribers.push([K.callback,V]),K.callback(X.value,V)}else K.callback(X.value)}),this.#K=new xW(this.root,(K,X,V)=>{let[Y,H]=BJ(this.#Q,X,V,K);if(this.#Q=Y,H.isOk()){let U=H[0];if(U.stop_propagation)K.stopPropagation();if(U.prevent_default)K.preventDefault();this.dispatch(U.message,!1)}}),this.#J=AK(this.root),this.#Q=IW(),this.#F=!0,this.#R(J)}root=null;dispatch(Z,Q=!1){if(this.#F||=Q,this.#Y)this.#M.push(Z);else{let[J,W]=this.#W(this.#Z,Z);this.#Z=J,this.#R(W)}}emit(Z,Q){(this.root.host??this.root).dispatchEvent(new CustomEvent(Z,{detail:Q,bubbles:!0,composed:!0}))}provide(Z,Q){if(!this.#X.has(Z))this.#X.set(Z,{value:Q,subscribers:[]});else{let J=this.#X.get(Z);J.value=Q;for(let W=J.subscribers.length-1;W>=0;W--){let[G,K]=J.subscribers[W];if(!G){J.subscribers.splice(W,1);continue}G(Q,K)}}}#Z;#G;#W;#J;#Q;#K;#X=new Map;#Y=!1;#M=[];#H=u;#U=u;#V=null;#F=!1;#I={dispatch:(Z,Q)=>this.dispatch(Z,Q),emit:(Z,Q)=>this.emit(Z,Q),select:()=>{},root:()=>this.root,provide:(Z,Q)=>this.provide(Z,Q)};#R(Z){this.#Y=!0;while(!0){for(let Q=Z.synchronous;Q.tail;Q=Q.tail)Q.head(this.#I);if(this.#H=SK(this.#H,Z.before_paint),this.#U=SK(this.#U,Z.after_paint),!this.#M.length)break;[this.#Z,Z]=this.#W(this.#Z,this.#M.shift())}if(this.#Y=!1,this.#F)cancelAnimationFrame(this.#V),this.#z();else if(!this.#V)this.#V=requestAnimationFrame(()=>{this.#z()})}#z(){this.#F=!1,this.#V=null;let Z=this.#G(this.#Z),{patch:Q,events:J}=l9(this.#Q,this.#J,Z);if(this.#Q=J,this.#J=Z,this.#K.push(Q),this.#H instanceof pZ){let W=TK(this.#H);this.#H=u,queueMicrotask(()=>{this.#F=!0,this.#R(W)})}if(this.#U instanceof pZ){let W=TK(this.#U);this.#U=u,requestAnimationFrame(()=>{this.#F=!0,this.#R(W)})}}}function TK(Z){return{synchronous:Z,after_paint:u,before_paint:u}}function SK(Z,Q){if(Z instanceof B)return Q;else if(Q instanceof B)return Z;else return x9(Z,Q)}class fW extends F{constructor(Z){super();this.message=Z}}class hW extends F{constructor(Z){super();this.callback=Z}}class vW extends F{constructor(Z){super();this.callback=Z}}class G9 extends F{constructor(Z){super();this.message=Z}}class j9 extends F{constructor(Z,Q){super();this.name=Z,this.data=Q}}class O8 extends F{constructor(Z,Q){super();this.key=Z,this.value=Q}}class B9 extends F{}class CK extends F{constructor(Z,Q,J,W,G,K,X,V,Y,H){super();this.open_shadow_root=Z,this.adopt_styles=Q,this.delegates_focus=J,this.attributes=W,this.properties=G,this.contexts=K,this.is_form_associated=X,this.on_form_autofill=V,this.on_form_reset=Y,this.on_form_restore=H}}function EK(Z){let Q=new CK(!0,!0,!1,u,u,u,!1,tJ,tJ,tJ);return wZ(Z,Q,(J,W)=>{return W.apply(J)})}class xK{#Z;constructor(Z,[Q,J],W,G){this.#Z=new D8(Z,[Q,J],G,W)}send(Z){switch(Z.constructor){case G9:{this.dispatch(Z.message,!1);break}case j9:{this.emit(Z.name,Z.data);break}case B9:break}}dispatch(Z,Q){this.#Z.dispatch(Z,Q)}emit(Z,Q){this.#Z.emit(Z,Q)}}var kK=({init:Z,update:Q,view:J},W,G)=>{if(!SJ())return new b(new LJ);let K=W instanceof HTMLElement?W:JQ().querySelector(W);if(!K)return new b(new gW(W));return new x(new xK(K,Z(G),Q,J))};class g7{#Z;#G;#W;#J;#Q;#K;#X=tZ();#Y=new Set;constructor([Z,Q],J,W,G){this.#Z=Z,this.#G=J,this.#W=W,this.#J=G,this.#Q=this.#W(this.#Z),this.#K=u0(this.#Q),this.#V(Q)}send(Z){switch(Z.constructor){case fW:{let{message:Q}=Z,J=this.#M(Q),W=l9(this.#K,this.#Q,J);this.#Q=J,this.#K=W.events,this.broadcast(LW(W.patch));return}case hW:{let{callback:Q}=Z;this.#Y.add(Q),Q(XK(this.#J.open_shadow_root,this.#J.adopt_styles,KQ(this.#J.attributes),KQ(this.#J.properties),KQ(this.#J.contexts),this.#X,this.#Q));return}case vW:{let{callback:Q}=Z;this.#Y.delete(Q);return}case G9:{let{message:Q}=Z,[J,W]=this.#G(this.#Z,Q),G=this.#W(J),K=l9(this.#K,this.#Q,G);this.#V(W),this.#Z=J,this.#Q=G,this.#K=K.events,this.broadcast(LW(K.patch));return}case j9:{let{name:Q,data:J}=Z;this.broadcast(VK(Q,J));return}case O8:{let{key:Q,value:J}=Z;this.#X=BZ(this.#X,Q,J),this.broadcast(YK(Q,J));return}case B9:{this.#Z=null,this.#G=null,this.#W=null,this.#J=null,this.#Q=null,this.#K=null,this.#X=null,this.#Y.clear();return}default:return}}broadcast(Z){for(let Q of this.#Y)Q(Z)}#M(Z){switch(Z.constructor){case R8:{let{messages:Q}=Z,J=this.#Z,W=IJ();for(let G=Q;G.head;G=G.tail){let K=this.#M(G.head);if(K instanceof x){J=K[0][0],W=P0(WQ.fromArray([W,K[0][1]]));break}}return this.#V(W),this.#Z=J,this.#W(this.#Z)}case I8:{let{name:Q,value:J}=Z,W=this.#H(Q,J);if(W instanceof b)return this.#Q;else{let[G,K]=this.#G(this.#Z,W[0]);return this.#V(K),this.#Z=G,this.#W(this.#Z)}}case z8:{let{name:Q,value:J}=Z,W=this.#U(Q,J);if(W instanceof b)return this.#Q;else{let[G,K]=this.#G(this.#Z,W[0]);return this.#V(K),this.#Z=G,this.#W(this.#Z)}}case q8:{let{path:Q,name:J,event:W}=Z,[G,K]=BJ(this.#K,Q,J,W);if(this.#K=G,K instanceof b)return this.#Q;else{let[X,V]=this.#G(this.#Z,K[0].message);return this.#V(V),this.#Z=X,this.#W(this.#Z)}}case SW:{let{key:Q,value:J}=Z,W=FZ(this.#J.contexts,Q);if(W instanceof b)return this.#Q;if(W=H9(J,W[0]),W instanceof b)return this.#Q;let[G,K]=this.#G(this.#Z,W[0]);return this.#V(K),this.#Z=G,this.#W(this.#Z)}}}#H(Z,Q){let J=FZ(this.#J.attributes,Z);switch(J.constructor){case x:return J[0](Q);case b:return new b(void 0)}}#U(Z,Q){let J=FZ(this.#J.properties,Z);switch(J.constructor){case x:return J[0](Q);case b:return new b(void 0)}}#V(Z){let Q=(X)=>this.send(new G9(X)),J=(X,V)=>this.send(new j9(X,V)),W=()=>{return},G=()=>{return},K=(X,V)=>this.send(new O8(X,V));globalThis.queueMicrotask(()=>{B0(Z,Q,J,W,G,K)})}}class yK extends F{constructor(Z,Q,J,W){super();this.init=Z,this.update=Q,this.view=J,this.config=W}}class gW extends F{constructor(Z){super();this.selector=Z}}class LJ extends F{}function bK(Z,Q,J){return new yK(Z,Q,J,EK(u))}function fK(Z,Q,J){return KZ(!SJ(),new b(new LJ),()=>{return kK(Z,Q,J)})}function $7(Z){if(Z==="input")return!0;else if(Z==="change")return!0;else if(Z==="focus")return!0;else if(Z==="focusin")return!0;else if(Z==="focusout")return!0;else if(Z==="blur")return!0;else if(Z==="select")return!0;else return!1}function A9(Z,Q){return N0(Z,hJ(Q,(J)=>{return new RJ(!1,!1,J)}),u,GW,GW,$7(Z),0,0)}function uW(Z){if(Z instanceof bZ)return new bZ(Z.kind,Z.name,Z.handler,Z.include,D0,Z.stop_propagation,Z.immediate,Z.debounce,Z.throttle);else return Z}function hK(Z){return A9("mousedown",xQ(Z))}var i9="src/chess/algebraic_notation.gleam";class gK extends F{}class cW extends F{}class dW extends F{}class CJ extends F{}class j8 extends F{}function m7(Z){if(Z instanceof dW)return"#";else if(Z instanceof CJ)return"+";else return""}function _W(Z){if(Z)return"x";else return""}function B8(Z){if(Z instanceof s)return"";else if(Z instanceof ZQ)return"N";else if(Z instanceof mZ)return"B";else if(Z instanceof zZ)return"R";else if(Z instanceof QQ)return"Q";else return"K"}function c7(Z){return"="+B8(Z)}function uK(Z){if(Z instanceof h)return"1";else if(Z instanceof RZ)return"2";else if(Z instanceof sZ)return"3";else if(Z instanceof gZ)return"4";else if(Z instanceof uZ)return"5";else if(Z instanceof nZ)return"6";else if(Z instanceof IZ)return"7";else return"8"}function pW(Z){if(Z instanceof ZZ)return"a";else if(Z instanceof AZ)return"b";else if(Z instanceof JZ)return"c";else if(Z instanceof qZ)return"d";else if(Z instanceof p)return"e";else if(Z instanceof NZ)return"f";else if(Z instanceof WZ)return"g";else return"h"}function _K(Z){let Q=pW(Z.file),J=uK(Z.row);return Q+J}function $W(Z){return _K(Z)}function mW(Z,Q,J,W,G){let K=UQ(Z,J),X;if(K instanceof S)X=K[0];else throw g("let_assert",i9,"chess/algebraic_notation",196,"disambiguation","Pattern match failed, no pattern matched the value.",{value:K,start:5423,end:5473,pattern_start:5434,pattern_end:5446});let V=X[0];if(V instanceof s&&G)return pW(J.file);else{let Y=V,H=X[1],U,R=KQ(Q);U=w9(R,(L)=>{return KZ(A(L,J),!1,()=>{let T=UQ(Z,L);return A(T,new S([Y,H]))})});let q=U,I;I=w9(q,(L)=>{let k=FZ(Q,L),C=F9(k,()=>{throw g("panic",i9,"chess/algebraic_notation",219,"disambiguation","`panic` expression evaluated.",{})}),N=R9(C);return GJ(N,(w)=>{if(w instanceof yZ){let E=w.to;return A(E,W)}else if(w instanceof YQ){let E=w.to;return A(E,W)}else if(w instanceof HQ){let E=w.to;return A(E,W)}else if(w instanceof MQ)return!1;else return!1})});let O=I;return KZ(PG(O),"",()=>{let L;return L=WJ(O,(C)=>{return!A(C.file,J.file)}),KZ(L,(()=>{let C=J.file;return pW(C)})(),()=>{let C;return C=WJ(O,(E)=>{return!A(E.row,J.row)}),KZ(C,(()=>{let E=J.row;return uK(E)})(),()=>{return _K(J)})})})}}function p7(Z,Q,J,W){let G;{let M=l8(Q);G=l8(Z)>M}let K=G,X;if(W instanceof AQ){let{from:M,to:R}=W,q=UQ(Z,M),I;if(q instanceof S)I=q[0][0];else throw g("let_assert",i9,"chess/algebraic_notation",123,"describe_internal","Pattern match failed, no pattern matched the value.",{value:q,start:3633,end:3696,pattern_start:3644,pattern_end:3669});X=B8(I)+mW(Z,J,M,R,K)+_W(K)+$W(R)}else if(W instanceof bQ){let{from:M,to:R,new_figure:q}=W,I=UQ(Z,M),P;if(I instanceof S)P=I[0][0];else throw g("let_assert",i9,"chess/algebraic_notation",137,"describe_internal","Pattern match failed, no pattern matched the value.",{value:I,start:4164,end:4227,pattern_start:4175,pattern_end:4200});X=B8(P)+mW(Z,J,M,R,K)+_W(K)+$W(R)+c7(q)}else if(W instanceof fQ){let{from:M,to:R}=W,q=UQ(Z,M),I;if(q instanceof S)I=q[0][0];else throw g("let_assert",i9,"chess/algebraic_notation",130,"describe_internal","Pattern match failed, no pattern matched the value.",{value:q,start:3890,end:3953,pattern_start:3901,pattern_end:3926});X=B8(I)+mW(Z,J,M,R,K)+_W(K)+$W(R)}else if(W instanceof hQ)X="O-O";else X="O-O-O";let V=X,Y,H=Z9(Q);if(H instanceof VQ){let M=H.info;if(M instanceof uJ)if(M.by instanceof _J)Y=new dW;else{let q;if(q=nJ(Q),q)Y=new CJ;else Y=new j8}else{let R;if(R=nJ(Q),R)Y=new CJ;else Y=new j8}}else{let M;if(M=nJ(Q),M)Y=new CJ;else Y=new j8}return V+m7(Y)}function $K(Z,Q){let J,W=lJ(Z,Q);return J=U9(W,(K)=>{if(K instanceof mJ)return new gK;else if(K instanceof cJ)return new cW;else return new cW}),kQ(J,(K)=>{let X,V=W0(Z);return X=U9(V,(H)=>{throw g("panic",i9,"chess/algebraic_notation",99,"describe","`panic` expression evaluated.",{})}),kQ(X,(H)=>{let U=p7(Z,K,H,Q);return new x(U)})})}var sW=new j(new JZ,new h);var nW=new j(new JZ,new _);var lW=new j(new WZ,new h);var rW=new j(new WZ,new _);var A8="src/web_chess/internal/game_logic.gleam";class cZ extends F{constructor(Z,Q){super();this.state=Z,this.move_history=Q}}class P9 extends F{constructor(Z,Q,J,W){super();this.state=Z,this.move_history=Q,this.selected_figure=J,this.moves=W}}class a9 extends F{constructor(Z,Q,J,W,G){super();this.state=Z,this.move_history=Q,this.selected_figure=J,this.moves=W,this.dragging_over=G}}class EJ extends F{constructor(Z,Q){super();this.white=Z,this.black=Q}}class iW extends F{constructor(Z){super();this.white=Z}}function cK(Z,Q){let J=Z9(Z.state),W;if(J instanceof u9)W=J.next_player;else throw g("let_assert",A8,"web_chess/internal/game_logic",67,"handle_drag_start","Pattern match failed, no pattern matched the value.",{value:J,start:2024,end:2109,pattern_start:2035,pattern_end:2073});let G=UQ(Z.state,Q);if(G instanceof S){let K=G[0][1];if(A(K,W)){let X,V=a8(Z.state,Q),Y=F9(V,()=>{return PZ()}),H=R9(Y),U=EZ(H,(R)=>{if(R instanceof yZ)return[R.to,R];else if(R instanceof YQ)return[R.to,R];else if(R instanceof HQ)return[R.to,R];else if(R instanceof MQ)if(W instanceof f)return[lW,R];else return[rW,R];else if(W instanceof f)return[sW,R];else return[nW,R]});X=lQ(U);let M=X;return new a9(Z.state,Z.move_history,Q,M,new y)}else return new cZ(Z.state,Z.move_history)}else return new cZ(Z.state,Z.move_history)}function pK(Z,Q){if(Z instanceof a9){let{state:J,move_history:W,selected_figure:G,moves:K}=Z;return new a9(J,W,G,K,new S(Q))}else return Z}function dK(Z){if(Z instanceof a9){let{state:Q,move_history:J,selected_figure:W,moves:G}=Z;return new P9(Q,J,W,G)}else return Z}function sK(Z,Q,J,W){let G;if(W instanceof yZ){let V=W.to;G=new AQ(J,V)}else if(W instanceof YQ){let V=W.to;G=new bQ(J,V,new QQ)}else if(W instanceof HQ){let V=W.to;G=new fQ(J,V)}else if(W instanceof MQ)G=new hQ;else G=new $J;let K=G,X=lJ(Z,K);if(X instanceof x){let V=X[0],Y=$K(Z,K),H;if(Y instanceof x)H=Y[0];else throw g("let_assert",A8,"web_chess/internal/game_logic",218,"try_do_move","Pattern match failed, no pattern matched the value.",{value:Y,start:6214,end:6280,pattern_start:6225,pattern_end:6245});let U;if(Q instanceof B)U=z([new iW(H)]);else{let R=Q.head;if(R instanceof EJ)U=D(new iW(H),Q);else{let q=Q.tail,I=R.white;U=D(new EJ(I,H),q)}}return new cZ(V,U)}else{let V=X[0];throw n7(V,void 0,"src/web_chess/internal/game_logic.gleam",213),g("panic",A8,"web_chess/internal/game_logic",214,"try_do_move","error executing move",{})}}function nK(Z){if(Z instanceof a9){let{state:Q,move_history:J,selected_figure:W,moves:G,dragging_over:K}=Z;if(K instanceof S){let X=K[0];return KZ(A(X,W),new P9(Q,J,W,G),()=>{let V=FZ(G,X);if(V instanceof x){let Y=V[0];return sK(Q,J,W,Y)}else return new cZ(Q,J)})}else return new cZ(Q,J)}else return Z}function mK(Z,Q,J){let W=Z9(Z),G;if(W instanceof u9)G=W.next_player;else throw g("let_assert",A8,"web_chess/internal/game_logic",242,"try_select","Pattern match failed, no pattern matched the value.",{value:W,start:6989,end:7064,pattern_start:7000,pattern_end:7038});let K=UQ(Z,J);if(K instanceof S){let X=K[0][1];if(A(X,G)){let V,Y=a8(Z,J),H=F9(Y,()=>{return PZ()}),U=R9(H),M=EZ(U,(q)=>{if(q instanceof yZ)return[q.to,q];else if(q instanceof YQ)return[q.to,q];else if(q instanceof HQ)return[q.to,q];else if(q instanceof MQ)if(G instanceof f)return[lW,q];else return[rW,q];else if(G instanceof f)return[sW,q];else return[nW,q]});return V=lQ(M),new P9(Z,Q,J,V)}else return new cZ(Z,Q)}else return new cZ(Z,Q)}function lK(Z,Q){if((()=>{let W=Z.state;return Z9(W)})()instanceof VQ)return Z;else if(Z instanceof cZ){let{state:W,move_history:G}=Z;return mK(W,G,Q)}else if(Z instanceof P9){let{state:W,move_history:G,selected_figure:K,moves:X}=Z,V=FZ(X,Q);if(V instanceof x){let Y=V[0];return sK(Z.state,G,K,Y)}else return mK(W,G,Q)}else{let{state:W,move_history:G}=Z;return new cZ(W,G)}}function n7(Z,Q,J,W){let X=`${J}:${W}`,Y=new rK().inspect(Z),H=Q===void 0?"":" "+Q;if(globalThis.process?.stderr?.write){let U=`\x1B[90m${X}\x1B[39m${H}
${Y}
`;globalThis.process.stderr.write(U)}else if(globalThis.Deno){let U=`\x1B[90m${X}\x1B[39m${H}
${Y}
`;globalThis.Deno.stderr.writeSync(new TextEncoder().encode(U))}else{let U=`${X}
${Y}`;globalThis.console.log(U)}return Z}class rK{#Z=new Set;#G(Z){try{return Z instanceof fZ}catch{return!1}}#W(Z){let Q=Z.toString().replace("+","");if(Q.indexOf(".")>=0)return Q;else{let J=Q.indexOf("e");if(J>=0)return Q.slice(0,J)+".0"+Q.slice(J);else return Q+".0"}}inspect(Z){let Q=typeof Z;if(Z===!0)return"True";if(Z===!1)return"False";if(Z===null)return"//js(null)";if(Z===void 0)return"Nil";if(Q==="string")return this.#Y(Z);if(Q==="bigint"||Number.isInteger(Z))return Z.toString();if(Q==="number")return this.#W(Z);if(Z instanceof o9)return this.#M(Z);if(Z instanceof L9)return this.#H(Z);if(Z instanceof RegExp)return`//js(${Z})`;if(Z instanceof Date)return`//js(Date("${Z.toISOString()}"))`;if(Z instanceof globalThis.Error)return`//js(${Z.toString()})`;if(Z instanceof Function){let W=[];for(let G of Array(Z.length).keys())W.push(String.fromCharCode(G+97));return`//fn(${W.join(", ")}) { ... }`}if(this.#Z.size===this.#Z.add(Z).size)return"//js(circular reference)";let J;if(Array.isArray(Z))J=`#(${Z.map((W)=>this.inspect(W)).join(", ")})`;else if(Z instanceof WQ)J=this.#X(Z);else if(Z instanceof F)J=this.#K(Z);else if(this.#G(Z))J=this.#Q(Z);else if(Z instanceof Set)return`//js(Set(${[...Z].map((W)=>this.inspect(W)).join(", ")}))`;else J=this.#J(Z);return this.#Z.delete(Z),J}#J(Z){let Q=Object.getPrototypeOf(Z)?.constructor?.name||"Object",J=[];for(let K of Object.keys(Z))J.push(`${this.inspect(K)}: ${this.inspect(Z[K])}`);let W=J.length?" "+J.join(", ")+" ":"";return`//js(${Q==="Object"?"":Q+" "}{${W}})`}#Q(Z){let Q="dict.from_list([",J=!0,W=[];return Z.forEach((G,K)=>{W.push([K,G])}),W.sort(),W.forEach(([G,K])=>{if(!J)Q=Q+", ";Q=Q+"#("+this.inspect(G)+", "+this.inspect(K)+")",J=!1}),Q+"])"}#K(Z){let Q=Object.keys(Z).map((J)=>{let W=this.inspect(Z[J]);return isNaN(parseInt(J))?`${J}: ${W}`:W}).join(", ");return Q?`${Z.constructor.name}(${Q})`:Z.constructor.name}#X(Z){if(Z instanceof B)return"[]";let Q='charlist.from_string("',J="[",W=Z;while(W instanceof pZ){let G=W.head;if(W=W.tail,J!=="[")J+=", ";if(J+=this.inspect(G),Q)if(Number.isInteger(G)&&G>=32&&G<=126)Q+=String.fromCharCode(G);else Q=null}if(Q)return Q+'")';else return J+"]"}#Y(Z){let Q='"';for(let J=0;J<Z.length;J++){let W=Z[J];switch(W){case`
`:Q+="\\n";break;case"\r":Q+="\\r";break;case"\t":Q+="\\t";break;case"\f":Q+="\\f";break;case"\\":Q+="\\\\";break;case'"':Q+="\\\"";break;default:if(W<" "||W>"~"&&W<" ")Q+="\\u{"+W.charCodeAt(0).toString(16).toUpperCase().padStart(4,"0")+"}";else Q+=W}}return Q+='"',Q}#M(Z){return`//utfcodepoint(${String.fromCodePoint(Z.value)})`}#H(Z){if(Z.bitSize===0)return"<<>>";let Q="<<";for(let J=0;J<Z.byteSize-1;J++)Q+=Z.byteAt(J).toString(),Q+=", ";if(Z.byteSize*8===Z.bitSize)Q+=Z.byteAt(Z.byteSize-1).toString();else{let J=Z.bitSize%8;Q+=Z.byteAt(Z.byteSize-1)>>8-J,Q+=`:size(${J})`}return Q+=">>",Q}}function tW(Z){window.addEventListener("resize",()=>Z())}function iK(){return[window.innerWidth,window.innerHeight]}function aK(){let Z=parseFloat(getComputedStyle(document.documentElement).fontSize),Q=getComputedStyle(document.documentElement).getPropertyValue("--layout-sidebar-min-width");if(!Q||Q.indexOf("rem")===-1)throw Error("CSS variable --layout-sidebar-min-width missing or invalid format.");return parseFloat(Q.slice(0,Q.indexOf("rem")))*Z}function oW(){let Z=iK(),Q,J;Q=Z[0],J=Z[1];let W=aK();return Q-W>=J}var r7="src/web_chess/internal/views/board.gleam";class P8 extends F{}class T8 extends F{}function i7(Z){if(Z)return F8(z([SZ("absolute inset-0 h-full w-full"),K8("./indicators/capture.svg"),G8("This figure can be captured"),Q8(!1)]));else return F8(z([SZ("absolute inset-0 h-full w-full"),K8("./indicators/move.svg"),G8("Can move to here"),Q8(!1)]))}function a7(Z,Q,J){let W;if(Z[1]instanceof f){let H=Z[0];if(H instanceof s)W=["./figures/pawn_white.svg","White Bishop"];else if(H instanceof ZQ)W=["./figures/knight_white.svg","White Knight"];else if(H instanceof mZ)W=["./figures/bishop_white.svg","White Bishop"];else if(H instanceof zZ)W=["./figures/rook_white.svg","White Rook"];else if(H instanceof QQ)W=["./figures/queen_white.svg","White Queen"];else W=["./figures/king_white.svg","White King"]}else{let H=Z[0];if(H instanceof s)W=["./figures/pawn_black.svg","Black Pawn"];else if(H instanceof ZQ)W=["./figures/knight_black.svg","Black Knight"];else if(H instanceof mZ)W=["./figures/bishop_black.svg","Black Bishop"];else if(H instanceof zZ)W=["./figures/rook_black.svg","Black Rook"];else if(H instanceof QQ)W=["./figures/queen_black.svg","Black Queen"];else W=["./figures/king_black.svg","Black King"]}let K=W,X,V;X=K[0],V=K[1];let Y=Z[1];return F8(z([SZ("absolute inset-0 h-full w-full"),K8(X),G8(V),Q8(A(new S(Y),Q)),A9("dragstart",xQ(J()))]))}function t7(Z,Q,J,W,G,K,X,V,Y,H,U){let M;if(Q instanceof S){let P=Q[0];M=new S(a7(P,J,X))}else M=Q;let R=M,q;if(G)q=new S(i7(!A(R,new y)));else q=new y;let I=q;return W9(z([m9(z([["relative",!0],["bg-[var(--color-square-dark)]",A(Z,new T8)&&!W],["bg-[var(--color-square-light)]",A(Z,new P8)&&!W],["bg-[var(--color-square-dark-highlighted)]",A(Z,new T8)&&W],["bg-[var(--color-square-light-highlighted)]",A(Z,new P8)&&W]])),hK(K()),(()=>{let P=A9("dragover",xQ(H()));return uW(P)})(),(()=>{let P=A9("drop",xQ(Y()));return uW(P)})(),A9("dragenter",xQ(V())),A9("dragend",xQ(U()))]),(()=>{let P=z([R,I]);return nQ(P)})())}function o7(Z){let Q,J=Z.file;if(J instanceof ZZ)Q=0;else if(J instanceof AZ)Q=1;else if(J instanceof JZ)Q=2;else if(J instanceof qZ)Q=3;else if(J instanceof p)Q=4;else if(J instanceof NZ)Q=5;else if(J instanceof WZ)Q=6;else Q=7;let W=Q,G,K=Z.row;if(K instanceof h)G=0;else if(K instanceof RZ)G=1;else if(K instanceof sZ)G=2;else if(K instanceof gZ)G=3;else if(K instanceof uZ)G=4;else if(K instanceof nZ)G=5;else if(K instanceof IZ)G=6;else G=7;let V=(W+G)%2;if(V===0)return new T8;else if(V===1)return new P8;else throw g("panic",r7,"web_chess/internal/views/board",206,"coordinate_colour","`panic` expression evaluated.",{})}function e7(){let Z=z([new ZZ,new AZ,new JZ,new qZ,new p,new NZ,new WZ,new TZ]),J=z([new _,new IZ,new nZ,new uZ,new gZ,new sZ,new RZ,new h]);return k9(J,(W)=>{return EZ(Z,(K)=>{return new j(K,W)})})}function tK(Z,Q,J,W,G,K,X){let V;if(Z instanceof cZ)V=[PZ(),PZ()];else if(Z instanceof P9){let{selected_figure:I,moves:P}=Z;V=[(()=>{let O=z([I]);return xZ(O)})(),(()=>{let L=KQ(P);return xZ(L)})()]}else{let{selected_figure:I,moves:P,dragging_over:O}=Z;V=[(()=>{let L=z([new S(I),O]),T=nQ(L);return xZ(T)})(),(()=>{let T=KQ(P);return xZ(T)})()]}let Y=V,H,U;H=Y[0],U=Y[1];let M,R=(()=>{let I=Z.state;return Z9(I)})();if(R instanceof VQ)M=new y;else{let I=R.next_player;M=new S(I)}let q=M;return W9(z([SZ("grid h-[100vmin] w-[100vmin] grid-cols-8 grid-rows-8 select-none")]),EZ(e7(),(I)=>{return t7(o7(I),UQ(Z.state,I),q,(()=>{return YJ(H,I)})(),(()=>{return YJ(U,I)})(),()=>{return Q(I)},()=>{return J(I)},()=>{return W(I)},G,K,X)}))}function oK(){return n9(z([SZ("m-1 text-xs")]),z([U8(z([SZ("whitespace-nowrap"),J8("https://commons.wikimedia.org/wiki/Category:SVG_chess_pieces"),W8("_blank")]),z([TQ("Chess icons")])),TQ(" by "),U8(z([J8("https://commons.wikimedia.org/wiki/User:Cburnett"),W8("_blank")]),z([TQ("Cburnett")])),TQ(" "),U8(z([SZ("whitespace-nowrap"),J8("https://creativecommons.org/licenses/by-sa/3.0/deed.en"),W8("_blank")]),z([TQ("CC BY-SA 3.0")]))]))}function eK(Z){let Q,W=e(Z);Q=TG(W,(K,X)=>{let V=X+1;if(K instanceof EJ){let{white:Y,black:H}=K;return[V,Y,H]}else{let Y=K.white;return[V,Y,""]}});let G=Q;return W9(z([SZ("grid [grid-template-columns:1.5rem_4.5rem_4.5rem] justify-center gap-y-1 gap-x-1.5 pt-2 pb-1")]),(()=>{return k9(G,(X)=>{let V,Y,H;return V=X[0],Y=X[1],H=X[2],z([n9(z([]),z([TQ(aQ(V)+".")])),n9(z([SZ("font-bold")]),z([TQ(Y)])),n9(z([SZ("font-bold")]),z([TQ(H)]))])})})())}var WV="src/app.gleam";class K9 extends F{constructor(Z,Q){super();this.is_layout_sideways=Z,this.game=Q}}class eW extends F{}class ZG extends F{constructor(Z){super();this.square=Z}}class QG extends F{constructor(Z){super();this.dragging_figure=Z}}class JG extends F{constructor(Z){super();this.over=Z}}class WG extends F{}class GG extends F{}class ZX extends F{}function GV(Z){let Q=new K9(oW(),new cZ(Z0(),z([]))),J=A0((W)=>{return tW(()=>{return W(new eW)})});return[Q,J]}function KV(Z){return new K9(oW(),Z.game)}function XV(Z,Q){let J;if(Q instanceof eW)J=KV(Z);else if(Q instanceof ZG){let G=Q.square;J=new K9(Z.is_layout_sideways,lK(Z.game,G))}else if(Q instanceof QG){let G=Q.dragging_figure;J=new K9(Z.is_layout_sideways,cK(Z.game,G))}else if(Q instanceof JG){let G=Q.over;J=new K9(Z.is_layout_sideways,pK(Z.game,G))}else if(Q instanceof WG)J=new K9(Z.is_layout_sideways,nK(Z.game));else if(Q instanceof GG)J=new K9(Z.is_layout_sideways,dK(Z.game));else J=Z;return[J,IJ()]}function VV(Z){return m0(z([SZ("flex bg-background text-text font-sans h-screen w-screen overflow-x-hidden"),m9(z([["flex-row items-stretch",Z.is_layout_sideways],["flex-col items-stretch",!Z.is_layout_sideways]]))]),z([W9(z([SZ("h-[calc(50vh-50vmin)] flex-none")]),z([])),p0(z([m9(z([["flex justify-center",!0],["flex-1",Z.is_layout_sideways],["h-[100vmin] min-h-[100vmin]",!Z.is_layout_sideways]]))]),z([tK(Z.game,(Q)=>{return new ZG(Q)},(Q)=>{return new QG(Q)},(Q)=>{return new JG(Q)},()=>{return new WG},()=>{return new ZX},()=>{return new GG})])),c0(z([m9(z([["flex flex-col justify-between",!0],["h-full w-[var(--layout-sidebar-min-width)] overflow-y-scroll",Z.is_layout_sideways],["w-full flex-1",!Z.is_layout_sideways]]))]),z([eK(Z.game.move_history),W9(z([SZ("text-center")]),z([oK()]))]))]))}function QX(){let Z=bK(GV,XV,VV),Q=fK(Z,"#app",void 0);if(!(Q instanceof x))throw g("let_assert",WV,"app",17,"main","Pattern match failed, no pattern matched the value.",{value:Q,start:474,end:523,pattern_start:485,pattern_end:490});return}QX();

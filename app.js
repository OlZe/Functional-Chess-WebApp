function YG(Z){return!Z}function GZ(Z,Q,J){if(Z)return Q;else return J()}class F{withFields(Z){let Q=Object.keys(this).map((J)=>(J in Z)?Z[J]:this[J]);return new this.constructor(...Q)}}class WQ{static fromArray(Z,Q){let J=Q||new j;for(let W=Z.length-1;W>=0;--W)J=new pZ(Z[W],J);return J}[Symbol.iterator](){return new FG(this)}toArray(){return[...this]}atLeastLength(Z){let Q=this;while(Z-- >0&&Q)Q=Q.tail;return Q!==void 0}hasLength(Z){let Q=this;while(Z-- >0&&Q)Q=Q.tail;return Z===-1&&Q instanceof j}countLength(){let Z=this,Q=0;while(Z)Z=Z.tail,Q++;return Q-1}}function D(Z,Q){return new pZ(Z,Q)}function z(Z,Q){return WQ.fromArray(Z,Q)}class FG{#Z;constructor(Z){this.#Z=Z}next(){if(this.#Z instanceof j)return{done:!0};else{let{head:Z,tail:Q}=this.#Z;return this.#Z=Q,{value:Z,done:!1}}}}class j extends WQ{}class pZ extends WQ{constructor(Z,Q){super();this.head=Z,this.tail=Q}}class L9{bitSize;byteSize;bitOffset;rawBuffer;constructor(Z,Q,J){if(!(Z instanceof Uint8Array))throw globalThis.Error("BitArray can only be constructed from a Uint8Array");if(this.bitSize=Q??Z.length*8,this.byteSize=Math.trunc((this.bitSize+7)/8),this.bitOffset=J??0,this.bitSize<0)throw globalThis.Error(`BitArray bit size is invalid: ${this.bitSize}`);if(this.bitOffset<0||this.bitOffset>7)throw globalThis.Error(`BitArray bit offset is invalid: ${this.bitOffset}`);if(Z.length!==Math.trunc((this.bitOffset+this.bitSize+7)/8))throw globalThis.Error("BitArray buffer length is invalid");this.rawBuffer=Z}byteAt(Z){if(Z<0||Z>=this.byteSize)return;return o9(this.rawBuffer,this.bitOffset,Z)}equals(Z){if(this.bitSize!==Z.bitSize)return!1;let Q=Math.trunc(this.bitSize/8);if(this.bitOffset===0&&Z.bitOffset===0){for(let W=0;W<Q;W++)if(this.rawBuffer[W]!==Z.rawBuffer[W])return!1;let J=this.bitSize%8;if(J){let W=8-J;if(this.rawBuffer[Q]>>W!==Z.rawBuffer[Q]>>W)return!1}}else{for(let W=0;W<Q;W++){let G=o9(this.rawBuffer,this.bitOffset,W),K=o9(Z.rawBuffer,Z.bitOffset,W);if(G!==K)return!1}let J=this.bitSize%8;if(J){let W=o9(this.rawBuffer,this.bitOffset,Q),G=o9(Z.rawBuffer,Z.bitOffset,Q),K=8-J;if(W>>K!==G>>K)return!1}}return!0}get buffer(){if(MG("buffer","Use BitArray.byteAt() or BitArray.rawBuffer instead"),this.bitOffset!==0||this.bitSize%8!==0)throw new globalThis.Error("BitArray.buffer does not support unaligned bit arrays");return this.rawBuffer}get length(){if(MG("length","Use BitArray.bitSize or BitArray.byteSize instead"),this.bitOffset!==0||this.bitSize%8!==0)throw new globalThis.Error("BitArray.length does not support unaligned bit arrays");return this.rawBuffer.length}}function o9(Z,Q,J){if(Q===0)return Z[J]??0;else{let W=Z[J]<<Q&255,G=Z[J+1]>>8-Q;return W|G}}class e9{constructor(Z){this.value=Z}}var HG={};function MG(Z,Q){if(HG[Z])return;console.warn(`Deprecated BitArray.${Z} property used in JavaScript FFI code. ${Q}.`),HG[Z]=!0}class ZJ extends F{static isResult(Z){return Z instanceof ZJ}}class x extends ZJ{constructor(Z){super();this[0]=Z}isOk(){return!0}}class b extends ZJ{constructor(Z){super();this[0]=Z}isOk(){return!1}}function B(Z,Q){let J=[Z,Q];while(J.length){let W=J.pop(),G=J.pop();if(W===G)continue;if(!UG(W)||!UG(G))return!1;if(!UX(W,G)||KX(W,G)||XX(W,G)||VX(W,G)||YX(W,G)||HX(W,G)||MX(W,G))return!1;let X=Object.getPrototypeOf(W);if(X!==null&&typeof X.equals==="function")try{if(W.equals(G))continue;else return!1}catch{}let[V,Y]=GX(W),H=V(W),U=V(G);if(H.length!==U.length)return!1;for(let M of H)J.push(Y(W,M),Y(G,M))}return!0}function GX(Z){if(Z instanceof Map)return[(Q)=>Q.keys(),(Q,J)=>Q.get(J)];else{let Q=Z instanceof globalThis.Error?["message"]:[];return[(J)=>[...Q,...Object.keys(J)],(J,W)=>J[W]]}}function KX(Z,Q){return Z instanceof Date&&(Z>Q||Z<Q)}function XX(Z,Q){return!(Z instanceof L9)&&Z.buffer instanceof ArrayBuffer&&Z.BYTES_PER_ELEMENT&&!(Z.byteLength===Q.byteLength&&Z.every((J,W)=>J===Q[W]))}function VX(Z,Q){return Array.isArray(Z)&&Z.length!==Q.length}function YX(Z,Q){return Z instanceof Map&&Z.size!==Q.size}function HX(Z,Q){return Z instanceof Set&&(Z.size!=Q.size||[...Z].some((J)=>!Q.has(J)))}function MX(Z,Q){return Z instanceof RegExp&&(Z.source!==Q.source||Z.flags!==Q.flags)}function UG(Z){return typeof Z==="object"&&Z!==null}function UX(Z,Q){if(typeof Z!=="object"&&typeof Q!=="object"&&(!Z||!Q))return!1;if([Promise,WeakSet,WeakMap,Function].some((W)=>Z instanceof W))return!1;return Z.constructor===Q.constructor}function v(Z,Q,J,W,G,K,X){let V=new globalThis.Error(K);V.gleam_error=Z,V.file=Q,V.module=J,V.line=W,V.function=G,V.fn=G;for(let Y in X)V[Y]=X[Y];return V}class S extends F{constructor(Z){super();this[0]=Z}}class y extends F{}function FX(Z,Q){while(!0){let J=Z,W=Q;if(J instanceof j)return W;else{let G=J.head;Z=J.tail,Q=D(G,W)}}}function RX(Z){return FX(Z,z([]))}function RG(Z){return B(Z,new y)}function IG(Z,Q){if(Z instanceof S){let J=Z[0];return new x(J)}else return new b(Q)}function L8(Z){if(Z instanceof x){let Q=Z[0];return new S(Q)}else return new y}function EQ(Z,Q){if(Z instanceof S){let J=Z[0];return Q(J)}else return Z}function QJ(Z,Q){if(Z instanceof S)return Z;else return Q()}function IX(Z,Q){while(!0){let J=Z,W=Q;if(J instanceof j)return RX(W);else{let G=J.head;if(G instanceof S){let K=J.tail,X=G[0];Z=K,Q=D(X,W)}else Z=J.tail,Q=W}}}function lQ(Z){return IX(Z,z([]))}var zG=new WeakMap,C8=new DataView(new ArrayBuffer(8)),E8=0;function w8(Z){let Q=zG.get(Z);if(Q!==void 0)return Q;let J=E8++;if(E8===2147483647)E8=0;return zG.set(Z,J),J}function x8(Z,Q){return Z^Q+2654435769+(Z<<6)+(Z>>2)|0}function y8(Z){let Q=0,J=Z.length;for(let W=0;W<J;W++)Q=Math.imul(31,Q)+Z.charCodeAt(W)|0;return Q}function NG(Z){C8.setFloat64(0,Z);let Q=C8.getInt32(0),J=C8.getInt32(4);return Math.imul(73244475,Q>>16^Q)^J}function zX(Z){return y8(Z.toString())}function qX(Z){let Q=Object.getPrototypeOf(Z);if(Q!==null&&typeof Q.hashCode==="function")try{let W=Z.hashCode(Z);if(typeof W==="number")return W}catch{}if(Z instanceof Promise||Z instanceof WeakSet||Z instanceof WeakMap)return w8(Z);if(Z instanceof Date)return NG(Z.getTime());let J=0;if(Z instanceof ArrayBuffer)Z=new Uint8Array(Z);if(Array.isArray(Z)||Z instanceof Uint8Array)for(let W=0;W<Z.length;W++)J=Math.imul(31,J)+rZ(Z[W])|0;else if(Z instanceof Set)Z.forEach((W)=>{J=J+rZ(W)|0});else if(Z instanceof Map)Z.forEach((W,G)=>{J=J+x8(rZ(W),rZ(G))|0});else{let W=Object.keys(Z);for(let G=0;G<W.length;G++){let K=W[G],X=Z[K];J=J+x8(rZ(X),y8(K))|0}}return J}function rZ(Z){if(Z===null)return 1108378658;if(Z===void 0)return 1108378659;if(Z===!0)return 1108378657;if(Z===!1)return 1108378656;switch(typeof Z){case"number":return NG(Z);case"string":return y8(Z);case"bigint":return zX(Z);case"object":return qX(Z);case"symbol":return w8(Z);case"function":return w8(Z);default:return 0}}var AQ=5,b8=Math.pow(2,AQ),NX=b8-1,DX=b8/2,OX=b8/4,fZ=0,jQ=1,dZ=2,H9=3,f8={type:dZ,bitmap:0,array:[]};function JJ(Z,Q){return Z>>>Q&NX}function yJ(Z,Q){return 1<<JJ(Z,Q)}function jX(Z){return Z-=Z>>1&1431655765,Z=(Z&858993459)+(Z>>2&858993459),Z=Z+(Z>>4)&252645135,Z+=Z>>8,Z+=Z>>16,Z&127}function h8(Z,Q){return jX(Z&Q-1)}function iZ(Z,Q,J){let W=Z.length,G=Array(W);for(let K=0;K<W;++K)G[K]=Z[K];return G[Q]=J,G}function AX(Z,Q,J){let W=Z.length,G=Array(W+1),K=0,X=0;while(K<Q)G[X++]=Z[K++];G[X++]=J;while(K<W)G[X++]=Z[K++];return G}function k8(Z,Q){let J=Z.length,W=Array(J-1),G=0,K=0;while(G<Q)W[K++]=Z[G++];++G;while(G<J)W[K++]=Z[G++];return W}function DG(Z,Q,J,W,G,K){let X=rZ(Q);if(X===W)return{type:H9,hash:X,array:[{type:fZ,k:Q,v:J},{type:fZ,k:G,v:K}]};let V={val:!1};return WJ(v8(f8,Z,X,Q,J,V),Z,W,G,K,V)}function WJ(Z,Q,J,W,G,K){switch(Z.type){case jQ:return BX(Z,Q,J,W,G,K);case dZ:return v8(Z,Q,J,W,G,K);case H9:return PX(Z,Q,J,W,G,K)}}function BX(Z,Q,J,W,G,K){let X=JJ(J,Q),V=Z.array[X];if(V===void 0)return K.val=!0,{type:jQ,size:Z.size+1,array:iZ(Z.array,X,{type:fZ,k:W,v:G})};if(V.type===fZ){if(B(W,V.k)){if(G===V.v)return Z;return{type:jQ,size:Z.size,array:iZ(Z.array,X,{type:fZ,k:W,v:G})}}return K.val=!0,{type:jQ,size:Z.size,array:iZ(Z.array,X,DG(Q+AQ,V.k,V.v,J,W,G))}}let Y=WJ(V,Q+AQ,J,W,G,K);if(Y===V)return Z;return{type:jQ,size:Z.size,array:iZ(Z.array,X,Y)}}function v8(Z,Q,J,W,G,K){let X=yJ(J,Q),V=h8(Z.bitmap,X);if((Z.bitmap&X)!==0){let Y=Z.array[V];if(Y.type!==fZ){let U=WJ(Y,Q+AQ,J,W,G,K);if(U===Y)return Z;return{type:dZ,bitmap:Z.bitmap,array:iZ(Z.array,V,U)}}let H=Y.k;if(B(W,H)){if(G===Y.v)return Z;return{type:dZ,bitmap:Z.bitmap,array:iZ(Z.array,V,{type:fZ,k:W,v:G})}}return K.val=!0,{type:dZ,bitmap:Z.bitmap,array:iZ(Z.array,V,DG(Q+AQ,H,Y.v,J,W,G))}}else{let Y=Z.array.length;if(Y>=DX){let H=Array(32),U=JJ(J,Q);H[U]=v8(f8,Q+AQ,J,W,G,K);let M=0,R=Z.bitmap;for(let I=0;I<32;I++){if((R&1)!==0){let q=Z.array[M++];H[I]=q}R=R>>>1}return{type:jQ,size:Y+1,array:H}}else{let H=AX(Z.array,V,{type:fZ,k:W,v:G});return K.val=!0,{type:dZ,bitmap:Z.bitmap|X,array:H}}}}function PX(Z,Q,J,W,G,K){if(J===Z.hash){let X=g8(Z,W);if(X!==-1){if(Z.array[X].v===G)return Z;return{type:H9,hash:J,array:iZ(Z.array,X,{type:fZ,k:W,v:G})}}let V=Z.array.length;return K.val=!0,{type:H9,hash:J,array:iZ(Z.array,V,{type:fZ,k:W,v:G})}}return WJ({type:dZ,bitmap:yJ(Z.hash,Q),array:[Z]},Q,J,W,G,K)}function g8(Z,Q){let J=Z.array.length;for(let W=0;W<J;W++)if(B(Q,Z.array[W].k))return W;return-1}function kJ(Z,Q,J,W){switch(Z.type){case jQ:return TX(Z,Q,J,W);case dZ:return SX(Z,Q,J,W);case H9:return LX(Z,W)}}function TX(Z,Q,J,W){let G=JJ(J,Q),K=Z.array[G];if(K===void 0)return;if(K.type!==fZ)return kJ(K,Q+AQ,J,W);if(B(W,K.k))return K;return}function SX(Z,Q,J,W){let G=yJ(J,Q);if((Z.bitmap&G)===0)return;let K=h8(Z.bitmap,G),X=Z.array[K];if(X.type!==fZ)return kJ(X,Q+AQ,J,W);if(B(W,X.k))return X;return}function LX(Z,Q){let J=g8(Z,Q);if(J<0)return;return Z.array[J]}function _8(Z,Q,J,W){switch(Z.type){case jQ:return CX(Z,Q,J,W);case dZ:return EX(Z,Q,J,W);case H9:return wX(Z,W)}}function CX(Z,Q,J,W){let G=JJ(J,Q),K=Z.array[G];if(K===void 0)return Z;let X=void 0;if(K.type===fZ){if(!B(K.k,W))return Z}else if(X=_8(K,Q+AQ,J,W),X===K)return Z;if(X===void 0){if(Z.size<=OX){let V=Z.array,Y=Array(Z.size-1),H=0,U=0,M=0;while(H<G){let R=V[H];if(R!==void 0)Y[U]=R,M|=1<<H,++U;++H}++H;while(H<V.length){let R=V[H];if(R!==void 0)Y[U]=R,M|=1<<H,++U;++H}return{type:dZ,bitmap:M,array:Y}}return{type:jQ,size:Z.size-1,array:iZ(Z.array,G,X)}}return{type:jQ,size:Z.size,array:iZ(Z.array,G,X)}}function EX(Z,Q,J,W){let G=yJ(J,Q);if((Z.bitmap&G)===0)return Z;let K=h8(Z.bitmap,G),X=Z.array[K];if(X.type!==fZ){let V=_8(X,Q+AQ,J,W);if(V===X)return Z;if(V!==void 0)return{type:dZ,bitmap:Z.bitmap,array:iZ(Z.array,K,V)};if(Z.bitmap===G)return;return{type:dZ,bitmap:Z.bitmap^G,array:k8(Z.array,K)}}if(B(W,X.k)){if(Z.bitmap===G)return;return{type:dZ,bitmap:Z.bitmap^G,array:k8(Z.array,K)}}return Z}function wX(Z,Q){let J=g8(Z,Q);if(J<0)return Z;if(Z.array.length===1)return;return{type:H9,hash:Z.hash,array:k8(Z.array,J)}}function OG(Z,Q){if(Z===void 0)return;let J=Z.array,W=J.length;for(let G=0;G<W;G++){let K=J[G];if(K===void 0)continue;if(K.type===fZ){Q(K.v,K.k);continue}OG(K,Q)}}class bZ{static fromObject(Z){let Q=Object.keys(Z),J=bZ.new();for(let W=0;W<Q.length;W++){let G=Q[W];J=J.set(G,Z[G])}return J}static fromMap(Z){let Q=bZ.new();return Z.forEach((J,W)=>{Q=Q.set(W,J)}),Q}static new(){return new bZ(void 0,0)}constructor(Z,Q){this.root=Z,this.size=Q}get(Z,Q){if(this.root===void 0)return Q;let J=kJ(this.root,0,rZ(Z),Z);if(J===void 0)return Q;return J.v}set(Z,Q){let J={val:!1},W=this.root===void 0?f8:this.root,G=WJ(W,0,rZ(Z),Z,Q,J);if(G===this.root)return this;return new bZ(G,J.val?this.size+1:this.size)}delete(Z){if(this.root===void 0)return this;let Q=_8(this.root,0,rZ(Z),Z);if(Q===this.root)return this;if(Q===void 0)return bZ.new();return new bZ(Q,this.size-1)}has(Z){if(this.root===void 0)return!1;return kJ(this.root,0,rZ(Z),Z)!==void 0}entries(){if(this.root===void 0)return[];let Z=[];return this.forEach((Q,J)=>Z.push([J,Q])),Z}forEach(Z){OG(this.root,Z)}hashCode(){let Z=0;return this.forEach((Q,J)=>{Z=Z+x8(rZ(Q),rZ(J))|0}),Z}equals(Z){if(!(Z instanceof bZ)||this.size!==Z.size)return!1;try{return this.forEach((Q,J)=>{if(!B(Z.get(J,!Q),Q))throw qG}),!0}catch(Q){if(Q===qG)return!1;throw Q}}}var qG=Symbol();class KZ extends F{}class XZ extends F{}class wQ extends F{}function bJ(Z,Q){if(Z===Q)return new XZ;else if(Z<Q)return new KZ;else return new wQ}class LZ extends F{}class C9 extends F{}function E9(Z,Q){while(!0){let J=Z,W=Q;if(J instanceof j)return W;else{let G=J.head;Z=J.tail,Q=D(G,W)}}}function e(Z){return E9(Z,z([]))}function SG(Z){return B(Z,z([]))}function vX(Z,Q,J){while(!0){let W=Z,G=Q,K=J;if(W instanceof j)return e(K);else{let{head:X,tail:V}=W,Y;if(G(X))Y=D(X,K);else Y=K;let U=Y;Z=V,Q=G,J=U}}}function w9(Z,Q){return vX(Z,Q,z([]))}function gX(Z,Q,J){while(!0){let W=Z,G=Q,K=J;if(W instanceof j)return e(K);else{let{head:X,tail:V}=W,Y,H=G(X);if(H instanceof x){let M=H[0];Y=D(M,K)}else Y=K;let U=Y;Z=V,Q=G,J=U}}}function fJ(Z,Q){return gX(Z,Q,z([]))}function _X(Z,Q,J){while(!0){let W=Z,G=Q,K=J;if(W instanceof j)return e(K);else{let X=W.head;Z=W.tail,Q=G,J=D(G(X),K)}}}function CZ(Z,Q){return _X(Z,Q,z([]))}function uX(Z,Q,J,W){while(!0){let G=Z,K=Q,X=J,V=W;if(G instanceof j)return e(V);else{let{head:Y,tail:H}=G,U=D(K(Y,X),V);Z=H,Q=K,J=X+1,W=U}}}function LG(Z,Q){return uX(Z,Q,0,z([]))}function $X(Z,Q){while(!0){let J=Z,W=Q;if(J instanceof j)return W;else{let G=J.head;Z=J.tail,Q=D(G,W)}}}function x9(Z,Q){return $X(e(Z),Q)}function hJ(Z,Q){return D(Q,Z)}function mX(Z,Q){while(!0){let J=Z,W=Q;if(J instanceof j)return e(W);else{let G=J.head;Z=J.tail,Q=E9(G,W)}}}function cX(Z){return mX(Z,z([]))}function k9(Z,Q){return cX(CZ(Z,Q))}function EZ(Z,Q,J){while(!0){let W=Z,G=Q,K=J;if(W instanceof j)return G;else{let X=W.head;Z=W.tail,Q=K(G,X),J=K}}}function CG(Z,Q){while(!0){let J=Z,W=Q;if(J instanceof j)return new b(void 0);else{let{head:G,tail:K}=J,X=W(G);if(X instanceof x)return X;else Z=K,Q=W}}}function GJ(Z,Q){while(!0){let J=Z,W=Q;if(J instanceof j)return!0;else{let{head:G,tail:K}=J,X=W(G);if(X)Z=K,Q=W;else return X}}}function KJ(Z,Q){while(!0){let J=Z,W=Q;if(J instanceof j)return!1;else{let{head:G,tail:K}=J,X=W(G);if(X)return X;else Z=K,Q=W}}}function pX(Z,Q,J,W,G,K){while(!0){let X=Z,V=Q,Y=J,H=W,U=G,M=K,R=D(U,Y);if(X instanceof j)if(H instanceof LZ)return D(e(R),M);else return D(R,M);else{let{head:I,tail:q}=X,P=V(U,I);if(H instanceof LZ)if(P instanceof KZ)Z=q,Q=V,J=R,W=H,G=I,K=M;else if(P instanceof XZ)Z=q,Q=V,J=R,W=H,G=I,K=M;else{let O;if(H instanceof LZ)O=D(e(R),M);else O=D(R,M);let L=O;if(q instanceof j)return D(z([I]),L);else{let{head:T,tail:k}=q,C,N=V(I,T);if(N instanceof KZ)C=new LZ;else if(N instanceof XZ)C=new LZ;else C=new C9;let w=C;Z=k,Q=V,J=z([I]),W=w,G=T,K=L}}else if(P instanceof KZ){let O;if(H instanceof LZ)O=D(e(R),M);else O=D(R,M);let L=O;if(q instanceof j)return D(z([I]),L);else{let{head:T,tail:k}=q,C,N=V(I,T);if(N instanceof KZ)C=new LZ;else if(N instanceof XZ)C=new LZ;else C=new C9;let w=C;Z=k,Q=V,J=z([I]),W=w,G=T,K=L}}else if(P instanceof XZ){let O;if(H instanceof LZ)O=D(e(R),M);else O=D(R,M);let L=O;if(q instanceof j)return D(z([I]),L);else{let{head:T,tail:k}=q,C,N=V(I,T);if(N instanceof KZ)C=new LZ;else if(N instanceof XZ)C=new LZ;else C=new C9;let w=C;Z=k,Q=V,J=z([I]),W=w,G=T,K=L}}else Z=q,Q=V,J=R,W=H,G=I,K=M}}}function dX(Z,Q,J,W){while(!0){let G=Z,K=Q,X=J,V=W;if(G instanceof j)return E9(K,V);else if(K instanceof j)return E9(G,V);else{let{head:Y,tail:H}=G,U=K.head,M=K.tail,R=X(Y,U);if(R instanceof KZ)Z=H,Q=K,J=X,W=D(Y,V);else if(R instanceof XZ)Z=G,Q=M,J=X,W=D(U,V);else Z=G,Q=M,J=X,W=D(U,V)}}}function sX(Z,Q,J){while(!0){let W=Z,G=Q,K=J;if(W instanceof j)return e(K);else{let X=W.tail;if(X instanceof j){let V=W.head;return e(D(e(V),K))}else{let V=W.head,Y=X.head,H=X.tail,U=dX(V,Y,G,z([]));Z=H,Q=G,J=D(U,K)}}}}function nX(Z,Q,J,W){while(!0){let G=Z,K=Q,X=J,V=W;if(G instanceof j)return E9(K,V);else if(K instanceof j)return E9(G,V);else{let{head:Y,tail:H}=G,U=K.head,M=K.tail,R=X(Y,U);if(R instanceof KZ)Z=G,Q=M,J=X,W=D(U,V);else if(R instanceof XZ)Z=H,Q=K,J=X,W=D(Y,V);else Z=H,Q=K,J=X,W=D(Y,V)}}}function lX(Z,Q,J){while(!0){let W=Z,G=Q,K=J;if(W instanceof j)return e(K);else{let X=W.tail;if(X instanceof j){let V=W.head;return e(D(e(V),K))}else{let V=W.head,Y=X.head,H=X.tail,U=nX(V,Y,G,z([]));Z=H,Q=G,J=D(U,K)}}}}function rX(Z,Q,J){while(!0){let W=Z,G=Q,K=J;if(W instanceof j)return W;else if(G instanceof LZ)if(W.tail instanceof j)return W.head;else Z=sX(W,K,z([])),Q=new C9,J=K;else if(W.tail instanceof j){let V=W.head;return e(V)}else Z=lX(W,K,z([])),Q=new LZ,J=K}}function EG(Z,Q){if(Z instanceof j)return Z;else{let J=Z.tail;if(J instanceof j)return Z;else{let W=Z.head,G=J.head,K=J.tail,X,V=Q(W,G);if(V instanceof KZ)X=new LZ;else if(V instanceof XZ)X=new LZ;else X=new C9;let Y=X,H=pX(K,Q,z([W]),Y,G,z([]));return rX(H,new LZ,Q)}}}function wG(Z,Q){while(!0){let J=Z,W=Q;if(J instanceof j)return;else{let{head:G,tail:K}=J;W(G),Z=K,Q=W}}}function Q6(Z,Q){while(!0){let J=Z,W=Q;if(J instanceof j)return W;else{let G=J.head;Z=J.tail,Q=W+G}}}function kG(Z){return Q6(Z,"")}class m8 extends F{constructor(Z){super();this.function=Z}}function M9(Z,Q){let J=Q.function(Z),W,G;if(W=J[0],G=J[1],G instanceof j)return new x(W);else return new b(G)}function KQ(Z){return new m8((Q)=>{return[Z,z([])]})}function vJ(Z,Q){return new m8((J)=>{let W=Z.function(J),G,K;return G=W[0],K=W[1],[Q(G),K]})}var X6=void 0,fG={};function tQ(Z){return Z.toString()}function $8(Z,Q){return Z.startsWith(Q)}var hG=[" ","\t",`
`,"\v","\f","\r","","\u2028","\u2029"].join(""),aY=new RegExp(`^[${hG}]*`),tY=new RegExp(`[${hG}]*$`);function tZ(){return bZ.new()}function oQ(Z){return Z.size}function U9(Z){return WQ.fromArray(Z.entries())}function vG(Z,Q){return Q.delete(Z)}function UZ(Z,Q){let J=Z.get(Q,fG);if(J===fG)return new b(X6);return new x(J)}function gG(Z,Q,J){return J.set(Z,Q)}function TG(Z){let Q=Z.toString().replace("+","");if(Q.indexOf(".")>=0)return Q;else{let J=Q.indexOf("e");if(J>=0)return Q.slice(0,J)+".0"+Q.slice(J);else return Q+".0"}}class V6{#Z=new Set;inspect(Z){let Q=typeof Z;if(Z===!0)return"True";if(Z===!1)return"False";if(Z===null)return"//js(null)";if(Z===void 0)return"Nil";if(Q==="string")return this.#K(Z);if(Q==="bigint"||Number.isInteger(Z))return Z.toString();if(Q==="number")return TG(Z);if(Z instanceof e9)return this.#X(Z);if(Z instanceof L9)return this.#Y(Z);if(Z instanceof RegExp)return`//js(${Z})`;if(Z instanceof Date)return`//js(Date("${Z.toISOString()}"))`;if(Z instanceof globalThis.Error)return`//js(${Z.toString()})`;if(Z instanceof Function){let W=[];for(let G of Array(Z.length).keys())W.push(String.fromCharCode(G+97));return`//fn(${W.join(", ")}) { ... }`}if(this.#Z.size===this.#Z.add(Z).size)return"//js(circular reference)";let J;if(Array.isArray(Z))J=`#(${Z.map((W)=>this.inspect(W)).join(", ")})`;else if(Z instanceof WQ)J=this.#Q(Z);else if(Z instanceof F)J=this.#J(Z);else if(Z instanceof bZ)J=this.#W(Z);else if(Z instanceof Set)return`//js(Set(${[...Z].map((W)=>this.inspect(W)).join(", ")}))`;else J=this.#G(Z);return this.#Z.delete(Z),J}#G(Z){let Q=Object.getPrototypeOf(Z)?.constructor?.name||"Object",J=[];for(let K of Object.keys(Z))J.push(`${this.inspect(K)}: ${this.inspect(Z[K])}`);let W=J.length?" "+J.join(", ")+" ":"";return`//js(${Q==="Object"?"":Q+" "}{${W}})`}#W(Z){let Q="dict.from_list([",J=!0;return Z.forEach((W,G)=>{if(!J)Q=Q+", ";Q=Q+"#("+this.inspect(G)+", "+this.inspect(W)+")",J=!1}),Q+"])"}#J(Z){let Q=Object.keys(Z).map((J)=>{let W=this.inspect(Z[J]);return isNaN(parseInt(J))?`${J}: ${W}`:W}).join(", ");return Q?`${Z.constructor.name}(${Q})`:Z.constructor.name}#Q(Z){if(Z instanceof j)return"[]";let Q='charlist.from_string("',J="[",W=Z;while(W instanceof pZ){let G=W.head;if(W=W.tail,J!=="[")J+=", ";if(J+=this.inspect(G),Q)if(Number.isInteger(G)&&G>=32&&G<=126)Q+=String.fromCharCode(G);else Q=null}if(Q)return Q+'")';else return J+"]"}#K(Z){let Q='"';for(let J=0;J<Z.length;J++){let W=Z[J];switch(W){case`
`:Q+="\\n";break;case"\r":Q+="\\r";break;case"\t":Q+="\\t";break;case"\f":Q+="\\f";break;case"\\":Q+="\\\\";break;case'"':Q+="\\\"";break;default:if(W<" "||W>"~"&&W<" ")Q+="\\u{"+W.charCodeAt(0).toString(16).toUpperCase().padStart(4,"0")+"}";else Q+=W}}return Q+='"',Q}#X(Z){return`//utfcodepoint(${String.fromCodePoint(Z.value)})`}#Y(Z){if(Z.bitSize===0)return"<<>>";let Q="<<";for(let J=0;J<Z.byteSize-1;J++)Q+=Z.byteAt(J).toString(),Q+=", ";if(Z.byteSize*8===Z.bitSize)Q+=Z.byteAt(Z.byteSize-1).toString();else{let J=Z.bitSize%8;Q+=Z.byteAt(Z.byteSize-1)>>8-J,Q+=`:size(${J})`}return Q+=">>",Q}}function u8(Z){return oQ(Z)===0}function AZ(Z,Q,J){return gG(Q,J,Z)}function Y6(Z,Q){while(!0){let J=Z,W=Q;if(J instanceof j)return W;else{let G=J.tail,K=J.head[0],X=J.head[1];Z=G,Q=AZ(W,K,X)}}}function rQ(Z){return Y6(Z,tZ())}function H6(Z,Q){while(!0){let J=Z,W=Q;if(J instanceof j)return W;else{let G=J.head;Z=J.tail,Q=D(G,W)}}}function M6(Z,Q){while(!0){let J=Z,W=Q;if(J instanceof j)return H6(W,z([]));else{let G=J.tail,K=J.head[0];Z=G,Q=D(K,W)}}}function XQ(Z){return M6(U9(Z),z([]))}function eZ(Z,Q){return vG(Q,Z)}function U6(Z,Q,J){while(!0){let W=Z,G=Q,K=J;if(W instanceof j)return G;else{let X=W.tail,V=W.head[0],Y=W.head[1];Z=X,Q=K(G,V,Y),J=K}}}function VJ(Z,Q,J){return U6(U9(Z),Q,J)}function F6(Z,Q){let J=(W,G,K)=>{if(Z(G,K))return AZ(W,G,K);else return W};return VJ(Q,tZ(),J)}function _G(Z,Q){return F6(Q,Z)}function uG(Z){if(Z instanceof x)return!0;else return!1}function c8(Z,Q){if(Z instanceof x){let J=Z[0];return new x(Q(J))}else return Z}function F9(Z,Q){if(Z instanceof x)return Z;else{let J=Z[0];return new b(Q(J))}}function kQ(Z,Q){if(Z instanceof x){let J=Z[0];return Q(J)}else return Z}function gJ(Z,Q){if(Z instanceof x)return Z[0];else return Q}function R9(Z,Q){if(Z instanceof x)return Z[0];else return Q()}class YJ extends F{constructor(Z){super();this.dict=Z}}function PZ(){return new YJ(tZ())}function $G(Z){return B(Z,PZ())}function HJ(Z,Q){let J=Z.dict,W=UZ(J,Q);return uG(W)}function I9(Z){return XQ(Z.dict)}function eQ(Z,Q,J){return VJ(Z.dict,Q,(W,G,K)=>{return J(W,G)})}function mG(Z,Q){return new YJ(_G(Z.dict,(J,W)=>{return Q(J)}))}function R6(Z,Q){if(oQ(Z.dict)>oQ(Q.dict))return[Z,Q];else return[Q,Z]}var cG=void 0;function MJ(Z,Q){return new YJ(AZ(Z.dict,Q,cG))}function wZ(Z){let Q=EZ(Z,tZ(),(J,W)=>{return AZ(J,W,cG)});return new YJ(Q)}function xZ(Z,Q){return eQ(Z,PZ(),(J,W)=>{return MJ(J,Q(W))})}function Z9(Z,Q){let J=R6(Z,Q),W,G;return W=J[0],G=J[1],eQ(G,W,MJ)}class p8 extends F{constructor(Z){super();this.dict=Z}}function b9(){return new p8(tZ())}function d8(Z,Q){let J=Z.dict,W=UZ(J,Q);return gJ(W,0)}function f9(Z,Q){let J=d8(Z,Q)+1,W=AZ(Z.dict,Q,J);return new p8(W)}var r="src/chess.gleam";class n8 extends F{constructor(Z,Q,J,W){super();this.internal=Z,this.history=Q,this.status=J,this.starting_position=W}}class _Z extends F{constructor(Z,Q,J,W,G,K,X,V,Y){super();this.board=Z,this.moving_player=Q,this.en_passant_possible=J,this.short_castle_disqualified_white=W,this.long_castle_disqualified_white=G,this.short_castle_disqualified_black=K,this.long_castle_disqualified_black=X,this.fifty_move_rule_counter=V,this.threefold_repetition_counter=Y}}class dG extends F{constructor(Z,Q,J,W,G,K,X){super();this.board=Z,this.moving_player=Q,this.en_passant_possible=J,this.short_castle_disqualified_white=W,this.long_castle_disqualified_white=G,this.short_castle_disqualified_black=K,this.long_castle_disqualified_black=X}}class YQ extends F{constructor(Z){super();this.info=Z}}class _9 extends F{constructor(Z){super();this.next_player=Z}}class uJ extends F{constructor(Z,Q){super();this.winner=Z,this.by=Q}}class UJ extends F{constructor(Z){super();this.by=Z}}class $J extends F{}class sG extends F{}class nG extends F{}class lG extends F{}class rG extends F{}class VQ extends F{constructor(Z,Q,J){super();this.white_king=Z,this.black_king=Q,this.other_figures=J}}class s extends F{}class ZQ extends F{}class $Z extends F{}class IZ extends F{}class QQ extends F{}class yQ extends F{}class f extends F{}class VZ extends F{}class A extends F{constructor(Z,Q){super();this.file=Z,this.row=Q}}class DZ extends F{}class BZ extends F{}class QZ extends F{}class zZ extends F{}class p extends F{}class qZ extends F{}class JZ extends F{}class mZ extends F{}class g extends F{}class FZ extends F{}class sZ extends F{}class vZ extends F{}class gZ extends F{}class nZ extends F{}class RZ extends F{}class $ extends F{}class PQ extends F{constructor(Z,Q){super();this.from=Z,this.to=Q}}class bQ extends F{constructor(Z,Q,J){super();this.from=Z,this.to=Q,this.new_figure=J}}class fQ extends F{constructor(Z,Q){super();this.from=Z,this.to=Q}}class hQ extends F{}class mJ extends F{}class iG extends F{}class aG extends F{}class cJ extends F{}class pJ extends F{constructor(Z){super();this.reason=Z}}class tG extends F{}class oG extends F{}class eG extends F{constructor(Z){super();this.reason=Z}}class kZ extends F{constructor(Z){super();this.to=Z}}class HQ extends F{constructor(Z){super();this.to=Z}}class MQ extends F{constructor(Z){super();this.to=Z}}class UQ extends F{}class l8 extends F{}class dJ extends F{constructor(Z,Q,J){super();this.origin=Z,this.offset=Q,this.attacker=J}}class sJ extends F{constructor(Z,Q,J){super();this.origin=Z,this.direction=Q,this.attacker=J}}class Z0 extends F{}class Q0 extends F{}function r8(Z){return oQ(Z.internal.board.other_figures)+2}function Q9(Z){return Z.status}function z6(Z){return Z.fifty_move_rule_counter>=100}function q6(){return new VQ(new A(new p,new g),new A(new p,new $),rQ(z([[new A(new DZ,new g),[new IZ,new f]],[new A(new BZ,new g),[new ZQ,new f]],[new A(new QZ,new g),[new $Z,new f]],[new A(new zZ,new g),[new QQ,new f]],[new A(new qZ,new g),[new $Z,new f]],[new A(new JZ,new g),[new ZQ,new f]],[new A(new mZ,new g),[new IZ,new f]],[new A(new DZ,new FZ),[new s,new f]],[new A(new BZ,new FZ),[new s,new f]],[new A(new QZ,new FZ),[new s,new f]],[new A(new zZ,new FZ),[new s,new f]],[new A(new p,new FZ),[new s,new f]],[new A(new qZ,new FZ),[new s,new f]],[new A(new JZ,new FZ),[new s,new f]],[new A(new mZ,new FZ),[new s,new f]],[new A(new DZ,new $),[new IZ,new VZ]],[new A(new BZ,new $),[new ZQ,new VZ]],[new A(new QZ,new $),[new $Z,new VZ]],[new A(new zZ,new $),[new QQ,new VZ]],[new A(new qZ,new $),[new $Z,new VZ]],[new A(new JZ,new $),[new ZQ,new VZ]],[new A(new mZ,new $),[new IZ,new VZ]],[new A(new DZ,new RZ),[new s,new VZ]],[new A(new BZ,new RZ),[new s,new VZ]],[new A(new QZ,new RZ),[new s,new VZ]],[new A(new zZ,new RZ),[new s,new VZ]],[new A(new p,new RZ),[new s,new VZ]],[new A(new qZ,new RZ),[new s,new VZ]],[new A(new JZ,new RZ),[new s,new VZ]],[new A(new mZ,new RZ),[new s,new VZ]]])))}function J0(){let Z=new _Z(q6(),new f,new y,!1,!1,!1,!1,0,b9());return new n8(Z,z([]),new _9(new f),Z)}function l(Z,Q){let J=Z.white_king;if(B(J,Q))return new S([new yQ,new f]);else{let W=Z.black_king;if(B(W,Q))return new S([new yQ,new VZ]);else{let K=Z.other_figures,X=UZ(K,Q);return L8(X)}}}function FQ(Z,Q){let J=Z.internal.board;return l(J,Q)}function pG(Z){let Q,J=Z.file;if(J instanceof DZ)Q=0;else if(J instanceof BZ)Q=1;else if(J instanceof QZ)Q=2;else if(J instanceof zZ)Q=3;else if(J instanceof p)Q=4;else if(J instanceof qZ)Q=5;else if(J instanceof JZ)Q=6;else Q=7;let W=Q,G,K=Z.row;if(K instanceof g)G=0;else if(K instanceof FZ)G=1;else if(K instanceof sZ)G=2;else if(K instanceof vZ)G=3;else if(K instanceof gZ)G=4;else if(K instanceof nZ)G=5;else if(K instanceof RZ)G=6;else G=7;let V=(W+G)%2;if(V===0)return new Q0;else if(V===1)return new Z0;else throw v("panic",r,"chess",1803,"coord_colour","`panic` expression evaluated.",{})}function N6(Z){let Q=U9(Z.other_figures);if(Q instanceof j)return!0;else{let J=Q.tail;if(J instanceof j){let W=Q.head[1][0];if(W instanceof ZQ)return!0;else if(W instanceof $Z)return!0;else return!1}else if(J.tail instanceof j)if(J.head[1][0]instanceof $Z)if(Q.head[1][0]instanceof $Z){let X=J.head[1][1],V=Q.head[1][1];if(!B(V,X)){let Y=J.head[0],H=Q.head[0];return B(pG(H),pG(Y))}else return!1}else return!1;else return!1;else return!1}}function D6(Z,Q){while(!0){let J=Z,W=Q,G=bJ(W,0);if(G instanceof KZ)if(J instanceof g)return new y;else if(J instanceof FZ)Z=new g,Q=W+1;else if(J instanceof sZ)Z=new FZ,Q=W+1;else if(J instanceof vZ)Z=new sZ,Q=W+1;else if(J instanceof gZ)Z=new vZ,Q=W+1;else if(J instanceof nZ)Z=new gZ,Q=W+1;else if(J instanceof RZ)Z=new nZ,Q=W+1;else Z=new RZ,Q=W+1;else if(G instanceof XZ)return new S(J);else if(J instanceof g)Z=new FZ,Q=W-1;else if(J instanceof FZ)Z=new sZ,Q=W-1;else if(J instanceof sZ)Z=new vZ,Q=W-1;else if(J instanceof vZ)Z=new gZ,Q=W-1;else if(J instanceof gZ)Z=new nZ,Q=W-1;else if(J instanceof nZ)Z=new RZ,Q=W-1;else if(J instanceof RZ)Z=new $,Q=W-1;else return new y}}function s8(Z,Q){while(!0){let J=Z,W=Q,G=bJ(W,0);if(G instanceof KZ)if(J instanceof DZ)return new y;else if(J instanceof BZ)Z=new DZ,Q=W+1;else if(J instanceof QZ)Z=new BZ,Q=W+1;else if(J instanceof zZ)Z=new QZ,Q=W+1;else if(J instanceof p)Z=new zZ,Q=W+1;else if(J instanceof qZ)Z=new p,Q=W+1;else if(J instanceof JZ)Z=new qZ,Q=W+1;else Z=new JZ,Q=W+1;else if(G instanceof XZ)return new S(J);else if(J instanceof DZ)Z=new BZ,Q=W-1;else if(J instanceof BZ)Z=new QZ,Q=W-1;else if(J instanceof QZ)Z=new zZ,Q=W-1;else if(J instanceof zZ)Z=new p,Q=W-1;else if(J instanceof p)Z=new qZ,Q=W-1;else if(J instanceof qZ)Z=new JZ,Q=W-1;else if(J instanceof JZ)Z=new mZ,Q=W-1;else return new y}}function O6(Z,Q){return EQ(Z.en_passant_possible,(J)=>{let W=z([s8(J,-1),s8(J,1)]),G=lQ(W),K=CG(G,(X)=>{let V;if(Z.moving_player instanceof f)V=[new A(X,new gZ),new A(J,new nZ)];else V=[new A(X,new vZ),new A(J,new sZ)];let H=V,U,M;if(U=H[0],M=H[1],B(Q,U))return new x(new MQ(M));else return new b(void 0)});return L8(K)})}function h9(Z,Q,J){return EQ(s8(Z.file,Q),(W)=>{return EQ(D6(Z.row,J),(G)=>{return new S(new A(W,G))})})}function j6(Z,Q){let J;if(Z.moving_player instanceof f)J=1;else J=-1;let G=J,K=EQ(h9(Q,0,G),(C)=>{if(l(Z.board,C)instanceof S)return new y;else return new S(C)}),X=EQ(K,(C)=>{let N;if(Z.moving_player instanceof f)N=new vZ;else N=new gZ;let E=N;return EQ(h9(C,0,G),(h)=>{return GZ(!B(h.row,E),new y,()=>{if(l(Z.board,h)instanceof S)return new y;else return new S(h)})})}),V=EQ(h9(Q,-1,G),(C)=>{let N=l(Z.board,C);if(N instanceof S){let w=N[0][1];if(B(w,Z.moving_player))return new y;else return new S(C)}else return N}),Y=EQ(h9(Q,1,G),(C)=>{let N=l(Z.board,C);if(N instanceof S){let w=N[0][1];if(B(w,Z.moving_player))return new y;else return new S(C)}else return N}),H,U=z([K,X,V,Y]),M=lQ(U),R=CZ(M,(C)=>{let N;if(Z.moving_player instanceof f)N=new $;else N=new g;let E=N,h=C.row;if(B(h,E))return new HQ(C);else return new kZ(C)});H=wZ(R);let I=H,q=O6(Z,Q),P,O=z([q]),L=lQ(O),T=wZ(L);return P=Z9(T,I),P}function A6(Z,Q,J,W,G){while(!0){let K=Z,X=Q,V=J,Y=W,H=G,U=h9(X,V[0],V[1]);if(U instanceof S){let M=U[0],R=l(K,M);if(R instanceof S){let I=R[0][1];if(B(I,Y))return H;else return MJ(H,M)}else Z=K,Q=M,J=V,W=Y,G=MJ(H,M)}else return H}}function FJ(Z,Q){if(Q instanceof dJ){let{origin:J,attacker:W}=Q,G=Q.offset[0],K=Q.offset[1],X=h9(J,G,K);if(X instanceof S){let V=X[0],Y=l(Z,V);if(Y instanceof S){let H=Y[0][1];if(B(H,W))return PZ();else return wZ(z([V]))}else return wZ(z([V]))}else return PZ()}else{let{origin:J,direction:W,attacker:G}=Q;return A6(Z,J,W,G,PZ())}}function B6(Z,Q,J){let W=z([[1,2],[2,1],[2,-1],[1,-2],[-1,-2],[-2,-1],[-2,1],[-1,2]]),G=wZ(W),K=xZ(G,(Y)=>{return new dJ(Q,Y,J)}),X=xZ(K,(Y)=>{return FJ(Z,Y)}),V=eQ(X,PZ(),Z9);return xZ(V,(Y)=>{return new kZ(Y)})}function P6(Z,Q,J){let W=z([[0,1],[1,0],[0,-1],[-1,0]]),G=wZ(W),K=xZ(G,(Y)=>{return new sJ(Q,Y,J)}),X=xZ(K,(Y)=>{return FJ(Z,Y)}),V=eQ(X,PZ(),Z9);return xZ(V,(Y)=>{return new kZ(Y)})}function T6(Z,Q,J){let W=z([[1,1],[1,-1],[-1,-1],[-1,1]]),G=wZ(W),K=xZ(G,(Y)=>{return new sJ(Q,Y,J)}),X=xZ(K,(Y)=>{return FJ(Z,Y)}),V=eQ(X,PZ(),Z9);return xZ(V,(Y)=>{return new kZ(Y)})}function S6(Z,Q,J){let W=z([[0,1],[1,0],[0,-1],[-1,0],[1,1],[1,-1],[-1,-1],[-1,1]]),G=wZ(W),K=xZ(G,(Y)=>{return new sJ(Q,Y,J)}),X=xZ(K,(Y)=>{return FJ(Z,Y)}),V=eQ(X,PZ(),Z9);return xZ(V,(Y)=>{return new kZ(Y)})}function v9(Z){if(Z instanceof f)return new VZ;else return new f}function g9(Z){return new dG(Z.board,Z.moving_player,Z.en_passant_possible,Z.short_castle_disqualified_white,Z.long_castle_disqualified_white,Z.short_castle_disqualified_black,Z.long_castle_disqualified_black)}function L6(Z){let Q=new _Z(Z.board,v9(Z.moving_player),Z.en_passant_possible,Z.short_castle_disqualified_white,Z.long_castle_disqualified_white,Z.short_castle_disqualified_black,Z.long_castle_disqualified_black,Z.fifty_move_rule_counter,Z.threefold_repetition_counter),J=g9(Q);return(()=>{let W=Q.threefold_repetition_counter;return d8(W,J)})()>=2}var t=`Critical internal error!
This is not your fault (unless you mutated the internal state!).
If you see this message then this likely means, that something in this package's logic is incorrect.
Please open an issue at https://github.com/OlZe/Functional-Chess with a detailled description to help improve this package.
Sorry for the inconvience.`;function C6(Z,Q,J){let W;if(UZ(Z.board.other_figures,J)instanceof x)W=!0;else W=!1;let K=W,X,V=UZ(Z.board.other_figures,Q);if(V instanceof x)if(V[0][0]instanceof s)X=!0;else X=!1;else X=!1;let Y=X,H=GZ(Y,0,()=>{return GZ(K,0,()=>{return Z.fifty_move_rule_counter+1})}),U=GZ(K,b9(),()=>{return GZ(Y,b9(),()=>{let I=Z.threefold_repetition_counter;return f9(I,g9(Z))})}),M=Z.board,R=M.white_king;if(B(R,Q)){let{black_king:I,other_figures:q}=M;return new _Z(new VQ(J,I,eZ(q,J)),Z.moving_player,new y,!0,!0,Z.short_castle_disqualified_black,Z.long_castle_disqualified_black,H,U)}else{let I=M.black_king;if(B(I,Q)){let{white_king:q,other_figures:P}=M;return new _Z(new VQ(q,J,eZ(P,J)),Z.moving_player,new y,Z.short_castle_disqualified_white,Z.long_castle_disqualified_white,!0,!0,H,U)}else{let{white_king:q,black_king:P,other_figures:O}=M,L=UZ(O,Q),T;if(L instanceof x)T=L[0];else throw v("let_assert",r,"chess",1522,"do_move_standard_figure_move",t,{value:L,start:46713,end:46773,pattern_start:46724,pattern_end:46741});let k;if(T[1]instanceof f)if(T[0]instanceof s&&(B(Q.row,new FZ)&&B(J.row,new vZ))&&B(Q.file,J.file))k=new S(J.file);else k=new y;else if(T[0]instanceof s&&(B(Q.row,new RZ)&&B(J.row,new gZ))&&B(Q.file,J.file))k=new S(J.file);else k=new y;let N=k,w=Z.short_castle_disqualified_white||B(Q,new A(new mZ,new g)),E=Z.long_castle_disqualified_white||B(Q,new A(new DZ,new g)),h=Z.short_castle_disqualified_black||B(Q,new A(new mZ,new $)),m=Z.long_castle_disqualified_black||B(Q,new A(new DZ,new $));return new _Z(new VQ(q,P,(()=>{let YZ=eZ(O,Q);return AZ(YZ,J,T)})()),Z.moving_player,N,w,E,h,m,H,U)}}}function E6(Z,Q,J,W){let{board:G,moving_player:K}=Z,X=l(G,Q),V=new S([new s,K]);if(!B(X,V))throw v("assert",r,"chess",1580,"do_move_pawn_promotion",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:X,start:48608,end:48630},right:{kind:"expression",value:V,start:48634,end:48662},start:48601,end:48662,expression_start:48608});return new _Z(new VQ(G.white_king,G.black_king,(()=>{let Y=G.other_figures,H=eZ(Y,Q);return AZ(H,J,[W,K])})()),Z.moving_player,new y,Z.short_castle_disqualified_white,Z.long_castle_disqualified_white,Z.short_castle_disqualified_black,Z.long_castle_disqualified_black,0,b9())}function w6(Z,Q,J){let{board:W,moving_player:G}=Z,K=new A(J.file,Q.row),X=l(W,Q),V=new S([new s,G]);if(!B(X,V))throw v("assert",r,"chess",1609,"do_move_en_passant",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:X,start:49461,end:49483},right:{kind:"expression",value:V,start:49487,end:49515},start:49454,end:49515,expression_start:49461});let Y=l(W,K),H=new S([new s,v9(G)]);if(!B(Y,H))throw v("assert",r,"chess",1612,"do_move_en_passant",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:Y,start:49553,end:49587},right:{kind:"expression",value:H,start:49595,end:49636},start:49546,end:49636,expression_start:49553});let U=l(W,J);if(!B(U,new y))throw v("assert",r,"chess",1616,"do_move_en_passant",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:U,start:49674,end:49694},right:{kind:"literal",value:new y,start:49698,end:49702},start:49667,end:49702,expression_start:49674});return new _Z(new VQ(W.white_king,W.black_king,(()=>{let M=W.other_figures,R=eZ(M,Q),I=eZ(R,K);return AZ(I,J,[new s,G])})()),Z.moving_player,new y,Z.short_castle_disqualified_white,Z.long_castle_disqualified_white,Z.short_castle_disqualified_black,Z.long_castle_disqualified_black,0,b9())}function x6(Z){let{board:Q,moving_player:J}=Z,W;if(J instanceof f)W=new g;else W=new $;let G=W,K=new A(new p,G),X=new A(new JZ,G),V=new A(new mZ,G),Y=new A(new qZ,G),H=l(Q,K),U=new S([new yQ,J]);if(!B(H,U))throw v("assert",r,"chess",1649,"do_move_short_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:H,start:50651,end:50678},right:{kind:"expression",value:U,start:50682,end:50710},start:50644,end:50710,expression_start:50651});let M=l(Q,X);if(!B(M,new y))throw v("assert",r,"chess",1651,"do_move_short_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:M,start:50747,end:50772},right:{kind:"literal",value:new y,start:50776,end:50780},start:50740,end:50780,expression_start:50747});let R=l(Q,V),I=new S([new IZ,J]);if(!B(R,I))throw v("assert",r,"chess",1652,"do_move_short_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:R,start:50813,end:50840},right:{kind:"expression",value:I,start:50844,end:50872},start:50806,end:50872,expression_start:50813});let q=l(Q,Y);if(!B(q,new y))throw v("assert",r,"chess",1654,"do_move_short_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:q,start:50909,end:50934},right:{kind:"literal",value:new y,start:50938,end:50942},start:50902,end:50942,expression_start:50909});if(J instanceof f)return new _Z(new VQ(X,Q.black_king,(()=>{let P=Q.other_figures,O=eZ(P,V);return AZ(O,Y,[new IZ,J])})()),Z.moving_player,new y,!0,!0,Z.short_castle_disqualified_black,Z.long_castle_disqualified_black,Z.fifty_move_rule_counter,(()=>{let P=Z.threefold_repetition_counter;return f9(P,g9(Z))})());else return new _Z(new VQ(Q.white_king,X,(()=>{let P=Q.other_figures,O=eZ(P,V);return AZ(O,Y,[new IZ,J])})()),Z.moving_player,new y,Z.short_castle_disqualified_white,Z.long_castle_disqualified_white,!0,!0,Z.fifty_move_rule_counter,(()=>{let P=Z.threefold_repetition_counter;return f9(P,g9(Z))})())}function k6(Z){let{board:Q,moving_player:J}=Z,W;if(J instanceof f)W=new g;else W=new $;let G=W,K=new A(new p,G),X=new A(new QZ,G),V=new A(new DZ,G),Y=new A(new zZ,G),H=new A(new BZ,G),U=l(Q,K),M=new S([new yQ,J]);if(!B(U,M))throw v("assert",r,"chess",1712,"do_move_long_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:U,start:52732,end:52759},right:{kind:"expression",value:M,start:52763,end:52791},start:52725,end:52791,expression_start:52732});let R=l(Q,X);if(!B(R,new y))throw v("assert",r,"chess",1714,"do_move_long_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:R,start:52828,end:52853},right:{kind:"literal",value:new y,start:52857,end:52861},start:52821,end:52861,expression_start:52828});let I=l(Q,V),q=new S([new IZ,J]);if(!B(I,q))throw v("assert",r,"chess",1715,"do_move_long_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:I,start:52894,end:52921},right:{kind:"expression",value:q,start:52925,end:52953},start:52887,end:52953,expression_start:52894});let P=l(Q,Y);if(!B(P,new y))throw v("assert",r,"chess",1717,"do_move_long_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:P,start:52990,end:53015},right:{kind:"literal",value:new y,start:53019,end:53023},start:52983,end:53023,expression_start:52990});let O=l(Q,H);if(!B(O,new y))throw v("assert",r,"chess",1718,"do_move_long_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:O,start:53056,end:53083},right:{kind:"literal",value:new y,start:53087,end:53091},start:53049,end:53091,expression_start:53056});if(J instanceof f)return new _Z(new VQ(X,Q.black_king,(()=>{let L=Q.other_figures,T=eZ(L,V);return AZ(T,Y,[new IZ,J])})()),Z.moving_player,new y,!0,!0,Z.short_castle_disqualified_black,Z.long_castle_disqualified_black,Z.fifty_move_rule_counter,(()=>{let L=Z.threefold_repetition_counter;return f9(L,g9(Z))})());else return new _Z(new VQ(Q.white_king,X,(()=>{let L=Q.other_figures,T=eZ(L,V);return AZ(T,Y,[new IZ,J])})()),Z.moving_player,new y,Z.short_castle_disqualified_white,Z.long_castle_disqualified_white,!0,!0,Z.fifty_move_rule_counter,(()=>{let L=Z.threefold_repetition_counter;return f9(L,g9(Z))})())}function i8(Z,Q){if(Q instanceof PQ){let{from:J,to:W}=Q;return C6(Z,J,W)}else if(Q instanceof bQ){let{from:J,to:W,new_figure:G}=Q;return E6(Z,J,W,G)}else if(Q instanceof fQ){let{from:J,to:W}=Q;return w6(Z,J,W)}else if(Q instanceof hQ)return x6(Z);else return k6(Z)}function _J(Z,Q,J){let W;return W=GJ(Q,(X)=>{let V=l(Z.board,X);return RG(V)}),GZ(!W,!1,()=>{let X;if(Z.moving_player instanceof f)X=new A(new p,new g);else X=new A(new p,new $);let Y=X,H,M=CZ(J,(q)=>{return new PQ(Y,q)}),R=CZ(M,(q)=>{return i8(Z,q)});return H=KJ(R,nJ),!H})}function nJ(Z){let Q;if(Z.moving_player instanceof f)Q=Z.board.white_king;else Q=Z.board.black_king;let W=Q,G=v9(Z.moving_player),K=Z.board.other_figures,X=U9(K),V=w9(X,(M)=>{return B(M[1][1],G)}),Y=CZ(V,(M)=>{return M[0]}),H=k9(Y,(M)=>{let R=W0(new _Z(Z.board,G,Z.en_passant_possible,Z.short_castle_disqualified_white,Z.long_castle_disqualified_white,Z.short_castle_disqualified_black,Z.long_castle_disqualified_black,Z.fifty_move_rule_counter,Z.threefold_repetition_counter),M),I=c8(R,I9);return gJ(I,z([]))}),U=fJ(H,(M)=>{if(M instanceof kZ){let R=M.to;return new x(R)}else if(M instanceof HQ){let R=M.to;return new x(R)}else if(M instanceof MQ)return new b(void 0);else if(M instanceof UQ)return new b(void 0);else return new b(void 0)});return KJ(U,(M)=>{return B(M,W)})}function W0(Z,Q){let J,W=l(Z.board,Q);return J=IG(W,new iG),kQ(J,(K)=>{let X,V;return X=K[0],V=K[1],GZ(!B(V,Z.moving_player),new b(new aG),()=>{let Y;if(X instanceof s)Y=j6(Z,Q);else if(X instanceof ZQ)Y=B6(Z.board,Q,Z.moving_player);else if(X instanceof $Z)Y=T6(Z.board,Q,Z.moving_player);else if(X instanceof IZ)Y=P6(Z.board,Q,Z.moving_player);else if(X instanceof QQ)Y=S6(Z.board,Q,Z.moving_player);else Y=y6(Z,Q);return new x(Y)})})}function y6(Z,Q){let J,W=z([[0,1],[1,1],[1,0],[1,-1],[0,-1],[-1,-1],[-1,0],[-1,1]]),G=wZ(W),K=xZ(G,(C)=>{return new dJ(Q,C,Z.moving_player)}),X=xZ(K,(C)=>{return FJ(Z.board,C)}),V=eQ(X,PZ(),Z9);J=xZ(V,(C)=>{return new kZ(C)});let Y=J,H;if(b6(Z))H=new S(new UQ);else H=new y;let M=H,R;if(g6(Z))R=new S(new l8);else R=new y;let q=R,P,O=z([M,q]),L=lQ(O),T=wZ(L);return P=Z9(T,Y),P}function b6(Z){if(Z.moving_player instanceof f)return GZ(Z.short_castle_disqualified_white,!1,()=>{let J=l(Z.board,new A(new p,new g)),W=new S([new yQ,new f]);if(!B(J,W))throw v("assert",r,"chess",1080,"can_short_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:J,start:32415,end:32461},right:{kind:"literal",value:W,start:32473,end:32493},start:32408,end:32493,expression_start:32415});let G=l(Z.board,new A(new mZ,new g)),K=new S([new IZ,new f]);if(!B(G,K))throw v("assert",r,"chess",1084,"can_short_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:G,start:32539,end:32585},right:{kind:"literal",value:K,start:32597,end:32617},start:32532,end:32617,expression_start:32539});return _J(Z,z([new A(new qZ,new g),new A(new JZ,new g)]),z([new A(new p,new g),new A(new qZ,new g),new A(new JZ,new g)]))});else return GZ(Z.short_castle_disqualified_black,!1,()=>{let J=l(Z.board,new A(new p,new $)),W=new S([new yQ,new VZ]);if(!B(J,W))throw v("assert",r,"chess",1106,"can_short_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:J,start:33208,end:33254},right:{kind:"literal",value:W,start:33266,end:33286},start:33201,end:33286,expression_start:33208});let G=l(Z.board,new A(new mZ,new $)),K=new S([new IZ,new VZ]);if(!B(G,K))throw v("assert",r,"chess",1110,"can_short_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:G,start:33332,end:33378},right:{kind:"literal",value:K,start:33390,end:33410},start:33325,end:33410,expression_start:33332});return _J(Z,z([new A(new qZ,new $),new A(new JZ,new $)]),z([new A(new p,new $),new A(new qZ,new $),new A(new JZ,new $)]))})}function lJ(Z){return nJ(Z.internal)}function a8(Z,Q){return kQ(W0(Z,Q),(J)=>{let G=mG(J,(K)=>{let X;if(K instanceof kZ){let M=K.to;X=new PQ(Q,M)}else if(K instanceof HQ){let M=K.to;X=new bQ(Q,M,new QQ)}else if(K instanceof MQ){let M=K.to;X=new fQ(Q,M)}else if(K instanceof UQ)X=new hQ;else X=new mJ;let H=i8(Z,X),U=nJ(H);return YG(U)});return new x(G)})}function t8(Z,Q){let J=Z.status;if(J instanceof YQ)return new b(new oG);else{let W=Z.internal,G=J.next_player,K=W.moving_player;if(!B(K,G))throw v("assert",r,"chess",486,"get_moves",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:K,start:14480,end:14498},right:{kind:"expression",value:G,start:14502,end:14515},start:14473,end:14515,expression_start:14480});let X=a8(W,Q);return F9(X,(V)=>{return new eG(V)})}}function G0(Z){let Q;if(Z.moving_player instanceof f)Q=Z.board.white_king;else Q=Z.board.black_king;let W=Q,G,K=Z.board.other_figures,X=U9(K),V=fJ(X,(q)=>{let P,O;if(P=q[0],O=q[1][1],B(O,Z.moving_player))return new x(P);else return new b(void 0)});G=x9(V,z([W]));let Y=G,H,M=CZ(Y,(q)=>{let P,O=a8(Z,q);return P=R9(O,()=>{throw v("panic",r,"chess",821,"get_all_moves_internal",t,{})}),[q,P]}),R=w9(M,(q)=>{let P;return P=q[1],!$G(P)});return H=rQ(R),H}function K0(Z){let Q=Z.status;if(Q instanceof YQ)return new b(void 0);else{let J=Z.internal,W=Q.next_player,G=J.moving_player;if(!B(G,W))throw v("assert",r,"chess",508,"get_all_moves",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:G,start:15284,end:15302},right:{kind:"expression",value:W,start:15306,end:15319},start:15277,end:15319,expression_start:15284});return new x(G0(J))}}function f6(Z){let Q=v9(Z.moving_player),J=new _Z(Z.board,Q,Z.en_passant_possible,Z.short_castle_disqualified_white,Z.long_castle_disqualified_white,Z.short_castle_disqualified_black,Z.long_castle_disqualified_black,Z.fifty_move_rule_counter,Z.threefold_repetition_counter),W,G=G0(J);W=u8(G);let K=W,X=nJ(J);if(K)if(X)return new S(new uJ(Z.moving_player,new $J));else return new S(new UJ(new sG));else return new y}function h6(Z){let Q;if(N6(Z.board))Q=new S(new UJ(new nG));else Q=new y;return QJ(Q,()=>{let G=f6(Z);return QJ(G,()=>{let K;if(L6(Z))K=new S(new UJ(new lG));else K=new y;return QJ(K,()=>{let Y;if(z6(Z))Y=new S(new UJ(new rG));else Y=new y;return QJ(Y,()=>{return new y})})})})}function v6(Z,Q){{let J,W;{let X;if(Q instanceof PQ)X=Q.from;else if(Q instanceof bQ)X=Q.from;else if(Q instanceof fQ)X=Q.from;else if(Q instanceof hQ)if(Z.moving_player instanceof f)X=new A(new p,new g);else X=new A(new p,new $);else if(Z.moving_player instanceof f)X=new A(new p,new g);else X=new A(new p,new $);W=a8(Z,X)}return J=F9(W,(X)=>{return new pJ(X)}),kQ(J,(X)=>{let V;{let H;if(Q instanceof PQ){let M=Q.to;H=new kZ(M)}else if(Q instanceof bQ){let M=Q.to;H=new HQ(M)}else if(Q instanceof fQ){let M=Q.to;H=new MQ(M)}else if(Q instanceof hQ)H=new UQ;else H=new l8;V=HJ(X,H)}return GZ(!V,new b(new tG),()=>{let H=i8(Z,Q),U,M=h6(H);if(M instanceof S){let q=M[0];U=new YQ(q)}else U=new _9(v9(H.moving_player));let R=U,I=new _Z(H.board,v9(H.moving_player),H.en_passant_possible,H.short_castle_disqualified_white,H.long_castle_disqualified_white,H.short_castle_disqualified_black,H.long_castle_disqualified_black,H.fifty_move_rule_counter,H.threefold_repetition_counter);return new x([I,R])})})}}function rJ(Z,Q){let J=Z.status;if(J instanceof YQ)return new b(new cJ);else{let W=Z.internal,G=J.next_player,K=W.moving_player;if(!B(K,G))throw v("assert",r,"chess",418,"player_move",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:K,start:12251,end:12278},right:{kind:"expression",value:G,start:12282,end:12295},start:12244,end:12295,expression_start:12251});return kQ(v6(W,Q),(X)=>{let V,Y;return V=X[0],Y=X[1],new x(new n8(V,(()=>{let H=Z.history;return x9(H,z([[Q,G]]))})(),Y,Z.starting_position))})}}function g6(Z){if(Z.moving_player instanceof f)return GZ(Z.long_castle_disqualified_white,!1,()=>{let J=l(Z.board,new A(new p,new g)),W=new S([new yQ,new f]);if(!B(J,W))throw v("assert",r,"chess",1138,"can_long_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:J,start:34151,end:34197},right:{kind:"literal",value:W,start:34209,end:34229},start:34144,end:34229,expression_start:34151});let G=l(Z.board,new A(new DZ,new g)),K=new S([new IZ,new f]);if(!B(G,K))throw v("assert",r,"chess",1142,"can_long_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:G,start:34275,end:34321},right:{kind:"literal",value:K,start:34333,end:34353},start:34268,end:34353,expression_start:34275});return _J(Z,z([new A(new zZ,new g),new A(new QZ,new g),new A(new BZ,new g)]),z([new A(new p,new g),new A(new zZ,new g),new A(new QZ,new g)]))});else return GZ(Z.long_castle_disqualified_black,!1,()=>{let J=l(Z.board,new A(new p,new $)),W=new S([new yQ,new VZ]);if(!B(J,W))throw v("assert",r,"chess",1168,"can_long_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:J,start:35009,end:35055},right:{kind:"literal",value:W,start:35067,end:35087},start:35002,end:35087,expression_start:35009});let G=l(Z.board,new A(new DZ,new $)),K=new S([new IZ,new VZ]);if(!B(G,K))throw v("assert",r,"chess",1172,"can_long_castle",t,{kind:"binary_operator",operator:"==",left:{kind:"expression",value:G,start:35133,end:35179},right:{kind:"literal",value:K,start:35191,end:35211},start:35126,end:35211,expression_start:35133});return _J(Z,z([new A(new zZ,new $),new A(new QZ,new $),new A(new BZ,new $)]),z([new A(new p,new $),new A(new zZ,new $),new A(new QZ,new $)]))})}function OZ(Z){return Z}var JQ=()=>globalThis?.document,aJ="http://www.w3.org/1999/xhtml",tJ=1,e8=3;var H0=!!globalThis.HTMLElement?.prototype?.moveBefore;var _=z([]),oJ=new y;var s6=new wQ,n6=new KZ,l6=new XZ;function eJ(Z,Q){if(Z.name===Q.name)return l6;else if(Z.name<Q.name)return n6;else return s6}class TQ extends F{constructor(Z,Q,J){super();this.kind=Z,this.name=Q,this.value=J}}class Z8 extends F{constructor(Z,Q,J){super();this.kind=Z,this.name=Q,this.value=J}}class yZ extends F{constructor(Z,Q,J,W,G,K,X,V,Y){super();this.kind=Z,this.name=Q,this.handler=J,this.include=W,this.prevent_default=G,this.stop_propagation=K,this.immediate=X,this.debounce=V,this.throttle=Y}}class IJ extends F{constructor(Z,Q,J){super();this.prevent_default=Z,this.stop_propagation=Q,this.message=J}}class I0 extends F{constructor(Z){super();this.kind=Z}}class z0 extends F{constructor(Z){super();this.kind=Z}}function e6(Z,Q){while(!0){let J=Z,W=Q;if(J instanceof j)return W;else{let G=J.head;if(G instanceof TQ){let K=G.name;if(K==="")Z=J.tail,Q=W;else if(K==="class"){let X=G.value;if(X==="")Z=J.tail,Q=W;else{let V=J.tail;if(V instanceof j){let Y=G;Z=V,Q=D(Y,W)}else{let Y=V.head;if(Y instanceof TQ)if(Y.name==="class"){let U=G.kind,M=X,R=V.tail,I=Y.value,q=M+" "+I,P=new TQ(U,"class",q);Z=D(P,R),Q=W}else{let U=G;Z=V,Q=D(U,W)}else{let H=G;Z=V,Q=D(H,W)}}}}else if(K==="style"){let X=G.value;if(X==="")Z=J.tail,Q=W;else{let V=J.tail;if(V instanceof j){let Y=G;Z=V,Q=D(Y,W)}else{let Y=V.head;if(Y instanceof TQ)if(Y.name==="style"){let U=G.kind,M=X,R=V.tail,I=Y.value,q=M+";"+I,P=new TQ(U,"style",q);Z=D(P,R),Q=W}else{let U=G;Z=V,Q=D(U,W)}else{let H=G;Z=V,Q=D(H,W)}}}}else{let X=G;Z=J.tail,Q=D(X,W)}}else{let K=G;Z=J.tail,Q=D(K,W)}}}}function q0(Z){if(Z instanceof j)return Z;else if(Z.tail instanceof j)return Z;else{let W=EG(Z,(G,K)=>{return eJ(K,G)});return e6(W,_)}}var JW=0;function N0(Z,Q){return new TQ(JW,Z,Q)}var D0=1;var WW=2;function O0(Z,Q,J,W,G,K,X,V){return new yZ(WW,Z,Q,J,W,G,K,X,V)}var GW=0;var KW=new I0(GW);var Q8=2,j0=new z0(Q8);function gQ(Z,Q){return N0(Z,Q)}function TZ(Z){return gQ("class",Z)}function A0(Z,Q){while(!0){let J=Z,W=Q;if(J instanceof j)return W;else if(J.head[1]){let K=J.tail,X=J.head[0];return W+X+" "+A0(K,W)}else Z=J.tail,Q=W}}function m9(Z){return TZ(A0(Z,""))}function J8(Z){return gQ("draggable",(()=>{if(Z)return"true";else return"false"})())}function W8(Z){return gQ("href",Z)}function G8(Z){return gQ("target",Z)}function K8(Z){return gQ("alt",Z)}function X8(Z){return gQ("src",Z)}class Y8 extends F{constructor(Z,Q,J){super();this.synchronous=Z,this.before_paint=Q,this.after_paint=J}}class B0 extends F{constructor(Z,Q,J,W,G){super();this.dispatch=Z,this.emit=Q,this.select=J,this.root=W,this.provide=G}}function P0(Z,Q,J,W,G,K){let X=new B0(Q,J,W,G,K);return wG(Z.synchronous,(V)=>{return V(X)})}var V8=new Y8(z([]),z([]),z([]));function zJ(){return V8}function T0(Z){return new Y8(z([(J)=>{let W=J.dispatch;return Z(W)}]),V8.before_paint,V8.after_paint)}function S0(Z){return EZ(Z,V8,(Q,J)=>{return new Y8(EZ(J.synchronous,Q.synchronous,hJ),EZ(J.before_paint,Q.before_paint,hJ),EZ(J.after_paint,Q.after_paint,hJ))})}function lZ(){return null}function qJ(Z,Q){let J=Z?.get(Q);if(J!=null)return new x(J);else return new b(void 0)}function NJ(Z,Q){return Z&&Z.has(Q)}function z9(Z,Q,J){return Z??=new Map,Z.set(Q,J),Z}function XW(Z,Q){return Z?.delete(Q),Z}class VW extends F{}class YW extends F{constructor(Z,Q){super();this.key=Z,this.parent=Q}}class L0 extends F{constructor(Z,Q){super();this.index=Z,this.parent=Q}}function W7(Z,Q){while(!0){let J=Z,W=Q;if(W instanceof j)return!1;else{let{head:G,tail:K}=W,X=$8(J,G);if(X)return X;else Z=J,Q=K}}}function IQ(Z,Q,J){if(J==="")return new L0(Q,Z);else return new YW(J,Z)}var H8=new VW,OJ="\t";function C0(Z,Q){while(!0){let J=Z,W=Q;if(J instanceof VW)if(W instanceof j)return"";else{let G=W.tail;return kG(G)}else if(J instanceof YW){let G=J.key;Z=J.parent,Q=D(OJ,D(G,W))}else{let G=J.index;Z=J.parent,Q=D(OJ,D(tQ(G),W))}}}function G7(Z){return C0(Z,z([]))}function E0(Z,Q){if(Q instanceof j)return!1;else return W7(G7(Z),Q)}var HW=`
`;function MW(Z,Q){return C0(Z,z([HW,Q]))}class zQ extends F{constructor(Z,Q,J,W,G){super();this.kind=Z,this.key=Q,this.mapper=J,this.children=W,this.keyed_children=G}}class qQ extends F{constructor(Z,Q,J,W,G,K,X,V,Y,H){super();this.kind=Z,this.key=Q,this.mapper=J,this.namespace=W,this.tag=G,this.attributes=K,this.children=X,this.keyed_children=V,this.self_closing=Y,this.void=H}}class NQ extends F{constructor(Z,Q,J,W){super();this.kind=Z,this.key=Q,this.mapper=J,this.content=W}}class p9 extends F{constructor(Z,Q,J,W,G,K,X){super();this.kind=Z,this.key=Q,this.mapper=J,this.namespace=W,this.tag=G,this.attributes=K,this.inner_html=X}}function V7(Z,Q){if(Q==="")if(Z==="area")return!0;else if(Z==="base")return!0;else if(Z==="br")return!0;else if(Z==="col")return!0;else if(Z==="embed")return!0;else if(Z==="hr")return!0;else if(Z==="img")return!0;else if(Z==="input")return!0;else if(Z==="link")return!0;else if(Z==="meta")return!0;else if(Z==="param")return!0;else if(Z==="source")return!0;else if(Z==="track")return!0;else if(Z==="wbr")return!0;else return!1;else return!1}function x0(Z,Q){if(Q instanceof zQ)return new zQ(Q.kind,Z,Q.mapper,Q.children,Q.keyed_children);else if(Q instanceof qQ)return new qQ(Q.kind,Z,Q.mapper,Q.namespace,Q.tag,Q.attributes,Q.children,Q.keyed_children,Q.self_closing,Q.void);else if(Q instanceof NQ)return new NQ(Q.kind,Z,Q.mapper,Q.content);else return new p9(Q.kind,Z,Q.mapper,Q.namespace,Q.tag,Q.attributes,Q.inner_html)}var DQ=0;function UW(Z,Q,J,W){return new zQ(DQ,Z,Q,J,W)}var q9=1;function jJ(Z,Q,J,W,G,K,X,V,Y){return new qQ(q9,Z,Q,J,W,q0(G),K,X,V,Y||V7(W,J))}var d9=2;function FW(Z,Q,J){return new NQ(d9,Z,Q,J)}var k0=3;var RW=(Z,Q)=>Z===Q,D9=(Z,Q)=>{if(Z===Q)return!0;if(Z==null||Q==null)return!1;let J=typeof Z;if(J!==typeof Q)return!1;if(J!=="object")return!1;if(Z.constructor!==Q.constructor)return!1;if(Array.isArray(Z))return Y7(Z,Q);return H7(Z,Q)},Y7=(Z,Q)=>{let J=Z.length;if(J!==Q.length)return!1;while(J--)if(!D9(Z[J],Q[J]))return!1;return!0},H7=(Z,Q)=>{let J=Object.keys(Z),W=J.length;if(Object.keys(Q).length!==W)return!1;while(W--){let G=J[W];if(!Object.hasOwn(Q,G))return!1;if(!D9(Z[G],Q[G]))return!1}return!0};class uQ extends F{constructor(Z,Q,J){super();this.handlers=Z,this.dispatched_paths=Q,this.next_dispatched_paths=J}}function zW(){return new uQ(lZ(),_,_)}function h0(Z){return new uQ(Z.handlers,Z.next_dispatched_paths,_)}function v0(Z,Q,J){return XW(Z,MW(Q,J))}function AJ(Z,Q,J){let W=v0(Z.handlers,Q,J);return new uQ(W,Z.dispatched_paths,Z.next_dispatched_paths)}function y0(Z,Q,J){return EZ(J,Z,(W,G)=>{if(G instanceof yZ){let K=G.name;return v0(W,Q,K)}else return W})}function BJ(Z,Q,J,W){let G=D(Q,Z.next_dispatched_paths),K=new uQ(Z.handlers,Z.dispatched_paths,G),X=qJ(K.handlers,Q+HW+J);if(X instanceof x){let V=X[0];return[K,M9(W,V)]}else return[K,new b(z([]))]}function M8(Z,Q){return E0(Q,Z.dispatched_paths)}function g0(Z,Q,J,W,G){return z9(Z,MW(J,W),vJ(G,(K)=>{return new IJ(K.prevent_default,K.stop_propagation,OZ(Q)(K.message))}))}function PJ(Z,Q,J,W,G){let K=g0(Z.handlers,Q,J,W,G);return new uQ(K,Z.dispatched_paths,Z.next_dispatched_paths)}function b0(Z,Q,J,W){return EZ(W,Z,(G,K)=>{if(K instanceof yZ){let{name:X,handler:V}=K;return g0(G,Q,J,X,V)}else return G})}function J9(Z,Q){let J=RW(Z,OZ);if(RW(Q,OZ))return Z;else if(J)return Q;else return(G)=>{return Z(Q(G))}}function f0(Z,Q,J,W){while(!0){let G=Z,K=Q,X=J,V=W;if(V instanceof j)return G;else{let{head:Y,tail:H}=V;Z=_0(G,K,X,Y),Q=K,J=X+1,W=H}}}function _0(Z,Q,J,W){if(W instanceof zQ){let G=W.children,K=IQ(Q,J,W.key);return f0(Z,K,0,G)}else if(W instanceof qQ){let{attributes:G,children:K}=W,X=IQ(Q,J,W.key),Y=y0(Z,X,G);return f0(Y,X,0,K)}else if(W instanceof NQ)return Z;else{let G=W.attributes,K=IQ(Q,J,W.key);return y0(Z,K,G)}}function $Q(Z,Q,J,W){let G=_0(Z.handlers,Q,J,W);return new uQ(G,Z.dispatched_paths,Z.next_dispatched_paths)}function IW(Z,Q,J,W,G){while(!0){let K=Z,X=Q,V=J,Y=W,H=G;if(H instanceof j)return K;else{let{head:U,tail:M}=H;Z=u0(K,X,V,Y,U),Q=X,J=V,W=Y+1,G=M}}}function u0(Z,Q,J,W,G){if(G instanceof zQ){let K=G.children,X=IQ(J,W,G.key),V=J9(Q,G.mapper);return IW(Z,V,X,0,K)}else if(G instanceof qQ){let{attributes:K,children:X}=G,V=IQ(J,W,G.key),Y=J9(Q,G.mapper),U=b0(Z,Y,V,K);return IW(U,Y,V,0,X)}else if(G instanceof NQ)return Z;else{let K=G.attributes,X=IQ(J,W,G.key),V=J9(Q,G.mapper);return b0(Z,V,X,K)}}function mQ(Z,Q,J,W,G){let K=u0(Z.handlers,Q,J,W,G);return new uQ(K,Z.dispatched_paths,Z.next_dispatched_paths)}function $0(Z){return mQ(zW(),OZ,H8,0,Z)}function m0(Z,Q,J,W,G){let K=IW(Z.handlers,Q,J,W,G);return new uQ(K,Z.dispatched_paths,Z.next_dispatched_paths)}function cQ(Z,Q,J){return jJ("",OZ,"",Z,Q,J,lZ(),!1,!1)}function U8(Z){return FW("",OZ,Z)}function c0(){return FW("",OZ,"")}function SQ(Z){return U8(Z)}function p0(Z,Q){return cQ("body",Z,Q)}function d0(Z,Q){return cQ("aside",Z,Q)}function s0(Z,Q){return cQ("main",Z,Q)}function G9(Z,Q){return cQ("div",Z,Q)}function n9(Z,Q){return cQ("p",Z,Q)}function F8(Z,Q){return cQ("a",Z,Q)}function R8(Z){return cQ("img",Z,_)}class SJ extends F{constructor(Z,Q,J,W){super();this.index=Z,this.removed=Q,this.changes=J,this.children=W}}class n0 extends F{constructor(Z,Q){super();this.kind=Z,this.content=Q}}class l0 extends F{constructor(Z,Q){super();this.kind=Z,this.inner_html=Q}}class r0 extends F{constructor(Z,Q,J){super();this.kind=Z,this.added=Q,this.removed=J}}class i0 extends F{constructor(Z,Q,J){super();this.kind=Z,this.key=Q,this.before=J}}class a0 extends F{constructor(Z,Q,J){super();this.kind=Z,this.index=Q,this.with=J}}class t0 extends F{constructor(Z,Q){super();this.kind=Z,this.index=Q}}class o0 extends F{constructor(Z,Q,J){super();this.kind=Z,this.children=Q,this.before=J}}function qW(Z,Q,J,W){return new SJ(Z,Q,J,W)}var NW=0;function e0(Z){return new n0(NW,Z)}var DW=1;function ZK(Z){return new l0(DW,Z)}var OW=2;function jW(Z,Q){return new r0(OW,Z,Q)}var AW=3;function QK(Z,Q){return new i0(AW,Z,Q)}var BW=4;function JK(Z){return new t0(BW,Z)}var PW=5;function O9(Z,Q){return new a0(PW,Z,Q)}var TW=6;function SW(Z,Q){return new o0(TW,Z,Q)}class GK extends F{constructor(Z,Q,J,W,G,K,X,V){super();this.kind=Z,this.open_shadow_root=Q,this.will_adopt_styles=J,this.observed_attributes=W,this.observed_properties=G,this.requested_contexts=K,this.provided_contexts=X,this.vdom=V}}class KK extends F{constructor(Z,Q){super();this.kind=Z,this.patch=Q}}class XK extends F{constructor(Z,Q,J){super();this.kind=Z,this.name=Q,this.data=J}}class VK extends F{constructor(Z,Q,J){super();this.kind=Z,this.key=Q,this.value=J}}class I8 extends F{constructor(Z,Q){super();this.kind=Z,this.messages=Q}}class z8 extends F{constructor(Z,Q,J){super();this.kind=Z,this.name=Q,this.value=J}}class q8 extends F{constructor(Z,Q,J){super();this.kind=Z,this.name=Q,this.value=J}}class N8 extends F{constructor(Z,Q,J,W){super();this.kind=Z,this.path=Q,this.name=J,this.event=W}}class LW extends F{constructor(Z,Q,J){super();this.kind=Z,this.key=Q,this.value=J}}var I7=0;function YK(Z,Q,J,W,G,K,X){return new GK(I7,Z,Q,J,W,G,K,X)}var z7=1;function CW(Z){return new KK(z7,Z)}var q7=2;function HK(Z,Q){return new XK(q7,Z,Q)}var N7=3;function MK(Z,Q){return new VK(N7,Z,Q)}class D8 extends F{constructor(Z,Q){super();this.patch=Z,this.events=Q}}class RK extends F{constructor(Z,Q,J){super();this.added=Z,this.removed=Q,this.events=J}}function D7(Z,Q,J,W){if(J==="input"&&Q==="")return M8(Z,W);else if(J==="select"&&Q==="")return M8(Z,W);else if(J==="textarea"&&Q==="")return M8(Z,W);else return!1}function FK(Z,Q,J,W,G,K,X,V){while(!0){let Y=Z,H=Q,U=J,M=W,R=G,I=K,q=X,P=V;if(I instanceof j)if(R instanceof j)return new RK(q,P,M);else{let O=R.head;if(O instanceof yZ){let L=O,T=R.tail,k=O.name,C=D(L,P),N=AJ(M,H,k);Z=Y,Q=H,J=U,W=N,G=T,K=I,X=q,V=C}else{let L=O,T=R.tail,k=D(L,P);Z=Y,Q=H,J=U,W=M,G=T,K=I,X=q,V=k}}else if(R instanceof j){let O=I.head;if(O instanceof yZ){let L=O,T=I.tail,k=O.name,C=O.handler,N=D(L,q),w=PJ(M,U,H,k,C);Z=Y,Q=H,J=U,W=w,G=R,K=T,X=N,V=P}else{let L=O,T=I.tail,k=D(L,q);Z=Y,Q=H,J=U,W=M,G=R,K=T,X=k,V=P}}else{let{head:O,tail:L}=I,T=R.head,k=R.tail,C=eJ(T,O);if(C instanceof KZ)if(T instanceof yZ){let N=T.name,w=D(T,P),E=AJ(M,H,N);Z=Y,Q=H,J=U,W=E,G=k,K=I,X=q,V=w}else{let N=D(T,P);Z=Y,Q=H,J=U,W=M,G=k,K=I,X=q,V=N}else if(C instanceof XZ)if(O instanceof TQ)if(T instanceof TQ){let N,w=O.name;if(w==="value")N=Y||T.value!==O.value;else if(w==="checked")N=Y||T.value!==O.value;else if(w==="selected")N=Y||T.value!==O.value;else N=T.value!==O.value;let E=N,h;if(E)h=D(O,q);else h=q;let m=h;Z=Y,Q=H,J=U,W=M,G=k,K=L,X=m,V=P}else if(T instanceof yZ){let N=T.name,w=D(O,q),E=D(T,P),h=AJ(M,H,N);Z=Y,Q=H,J=U,W=h,G=k,K=L,X=w,V=E}else{let N=D(O,q),w=D(T,P);Z=Y,Q=H,J=U,W=M,G=k,K=L,X=N,V=w}else if(O instanceof Z8)if(T instanceof Z8){let N,w=O.name;if(w==="scrollLeft")N=!0;else if(w==="scrollRight")N=!0;else if(w==="value")N=Y||!D9(T.value,O.value);else if(w==="checked")N=Y||!D9(T.value,O.value);else if(w==="selected")N=Y||!D9(T.value,O.value);else N=!D9(T.value,O.value);let E=N,h;if(E)h=D(O,q);else h=q;let m=h;Z=Y,Q=H,J=U,W=M,G=k,K=L,X=m,V=P}else if(T instanceof yZ){let N=T.name,w=D(O,q),E=D(T,P),h=AJ(M,H,N);Z=Y,Q=H,J=U,W=h,G=k,K=L,X=w,V=E}else{let N=D(O,q),w=D(T,P);Z=Y,Q=H,J=U,W=M,G=k,K=L,X=N,V=w}else if(T instanceof yZ){let{name:N,handler:w}=O,E=T.prevent_default.kind!==O.prevent_default.kind||T.stop_propagation.kind!==O.stop_propagation.kind||T.immediate!==O.immediate||T.debounce!==O.debounce||T.throttle!==O.throttle,h;if(E)h=D(O,q);else h=q;let m=h,c=PJ(M,U,H,N,w);Z=Y,Q=H,J=U,W=c,G=k,K=L,X=m,V=P}else{let{name:N,handler:w}=O,E=D(O,q),h=D(T,P),m=PJ(M,U,H,N,w);Z=Y,Q=H,J=U,W=m,G=k,K=L,X=E,V=h}else if(O instanceof yZ){let{name:N,handler:w}=O,E=D(O,q),h=PJ(M,U,H,N,w);Z=Y,Q=H,J=U,W=h,G=R,K=L,X=E,V=P}else{let N=D(O,q);Z=Y,Q=H,J=U,W=M,G=R,K=L,X=N,V=P}}}}function EW(Z,Q,J,W,G,K,X,V,Y,H,U,M,R,I){while(!0){let q=Z,P=Q,O=J,L=W,T=G,k=K,C=X,N=V,w=Y,E=H,h=U,m=M,c=R,YZ=I;if(O instanceof j)if(q instanceof j)return new D8(new SJ(w,C,h,m),YZ);else{let{head:uZ,tail:LQ}=q,HZ;if(uZ.key===""||!NJ(T,uZ.key))HZ=C+1;else HZ=C;let u=HZ,ZZ=$Q(YZ,E,N,uZ);Z=LQ,Q=P,J=O,W=L,G=T,K=k,X=u,V=N,Y=w,H=E,U=h,M=m,R=c,I=ZZ}else if(q instanceof j){let uZ=m0(YZ,c,E,N,O),LQ=SW(O,N-k),HZ=D(LQ,h);return new D8(new SJ(w,C,HZ,m),uZ)}else{let uZ=O.head,LQ=q.head;if(LQ.key!==uZ.key){let HZ=O.tail,WZ=q.tail,u=qJ(P,uZ.key),ZZ=NJ(L,LQ.key);if(u instanceof x)if(ZZ){let n=u[0];if(NJ(T,LQ.key))Z=WZ,Q=P,J=O,W=L,G=T,K=k-1,X=C,V=N,Y=w,H=E,U=h,M=m,R=c,I=YZ;else{let o=N-k,d=D(QK(uZ.key,o),h),MZ=z9(T,uZ.key,void 0),a=k+1;Z=D(n,q),Q=P,J=O,W=L,G=MZ,K=a,X=C,V=N,Y=w,H=E,U=d,M=m,R=c,I=YZ}}else{let n=N-k,i=D(JK(n),h),o=$Q(YZ,E,N,LQ),d=k-1;Z=WZ,Q=P,J=O,W=L,G=T,K=d,X=C,V=N,Y=w,H=E,U=i,M=m,R=c,I=o}else if(ZZ){let n=N-k,i=mQ(YZ,c,E,N,uZ),o=SW(z([uZ]),n),d=D(o,h);Z=q,Q=P,J=HZ,W=L,G=T,K=k+1,X=C,V=N+1,Y=w,H=E,U=d,M=m,R=c,I=i}else{let n=O9(N-k,uZ),i,d=$Q(YZ,E,N,LQ);i=mQ(d,c,E,N,uZ);let MZ=i;Z=WZ,Q=P,J=HZ,W=L,G=T,K=k,X=C,V=N+1,Y=w,H=E,U=D(n,h),M=m,R=c,I=MZ}}else{let HZ=q.head;if(HZ instanceof zQ){let WZ=O.head;if(WZ instanceof zQ){let u=WZ,ZZ=O.tail,n=HZ,i=q.tail,o=J9(c,u.mapper),d=IQ(E,N,u.key),MZ=EW(n.children,n.keyed_children,u.children,u.keyed_children,lZ(),0,0,0,N,d,_,_,o,YZ),a,NZ=MZ.patch;if(NZ.children instanceof j)if(NZ.changes instanceof j)if(NZ.removed===0)a=m;else a=D(MZ.patch,m);else a=D(MZ.patch,m);else a=D(MZ.patch,m);let OQ=a;Z=i,Q=P,J=ZZ,W=L,G=T,K=k,X=C,V=N+1,Y=w,H=E,U=h,M=OQ,R=c,I=MZ.events}else{let u=WZ,ZZ=O.tail,n=HZ,i=q.tail,o=O9(N-k,u),d,a=$Q(YZ,E,N,n);d=mQ(a,c,E,N,u);let NZ=d;Z=i,Q=P,J=ZZ,W=L,G=T,K=k,X=C,V=N+1,Y=w,H=E,U=D(o,h),M=m,R=c,I=NZ}}else if(HZ instanceof qQ){let WZ=O.head;if(WZ instanceof qQ){let u=WZ,ZZ=HZ;if(ZZ.namespace===u.namespace&&ZZ.tag===u.tag){let n=O.tail,i=q.tail,o=J9(c,u.mapper),d=IQ(E,N,u.key),MZ=D7(YZ,u.namespace,u.tag,d),a=FK(MZ,d,o,YZ,ZZ.attributes,u.attributes,_,_),NZ,CQ,OQ;NZ=a.added,CQ=a.removed,OQ=a.events;let V9;if(CQ instanceof j&&NZ instanceof j)V9=_;else V9=z([jW(NZ,CQ)]);let T9=V9,S9=EW(ZZ.children,ZZ.keyed_children,u.children,u.keyed_children,lZ(),0,0,0,N,d,T9,_,o,OQ),nQ,Y9=S9.patch;if(Y9.children instanceof j)if(Y9.changes instanceof j)if(Y9.removed===0)nQ=m;else nQ=D(S9.patch,m);else nQ=D(S9.patch,m);else nQ=D(S9.patch,m);let WX=nQ;Z=i,Q=P,J=n,W=L,G=T,K=k,X=C,V=N+1,Y=w,H=E,U=h,M=WX,R=c,I=S9.events}else{let n=WZ,i=O.tail,o=HZ,d=q.tail,MZ=O9(N-k,n),a,CQ=$Q(YZ,E,N,o);a=mQ(CQ,c,E,N,n);let OQ=a;Z=d,Q=P,J=i,W=L,G=T,K=k,X=C,V=N+1,Y=w,H=E,U=D(MZ,h),M=m,R=c,I=OQ}}else{let u=WZ,ZZ=O.tail,n=HZ,i=q.tail,o=O9(N-k,u),d,a=$Q(YZ,E,N,n);d=mQ(a,c,E,N,u);let NZ=d;Z=i,Q=P,J=ZZ,W=L,G=T,K=k,X=C,V=N+1,Y=w,H=E,U=D(o,h),M=m,R=c,I=NZ}}else if(HZ instanceof NQ){let WZ=O.head;if(WZ instanceof NQ){let u=WZ;if(HZ.content===u.content){let n=O.tail;Z=q.tail,Q=P,J=n,W=L,G=T,K=k,X=C,V=N+1,Y=w,H=E,U=h,M=m,R=c,I=YZ}else{let n=WZ,i=O.tail,o=q.tail,d=qW(N,0,z([e0(n.content)]),_);Z=o,Q=P,J=i,W=L,G=T,K=k,X=C,V=N+1,Y=w,H=E,U=h,M=D(d,m),R=c,I=YZ}}else{let u=WZ,ZZ=O.tail,n=HZ,i=q.tail,o=O9(N-k,u),d,a=$Q(YZ,E,N,n);d=mQ(a,c,E,N,u);let NZ=d;Z=i,Q=P,J=ZZ,W=L,G=T,K=k,X=C,V=N+1,Y=w,H=E,U=D(o,h),M=m,R=c,I=NZ}}else{let WZ=O.head;if(WZ instanceof p9){let u=WZ,ZZ=O.tail,n=HZ,i=q.tail,o=J9(c,u.mapper),d=IQ(E,N,u.key),MZ=FK(!1,d,o,YZ,n.attributes,u.attributes,_,_),a,NZ,CQ;a=MZ.added,NZ=MZ.removed,CQ=MZ.events;let OQ;if(NZ instanceof j&&a instanceof j)OQ=_;else OQ=z([jW(a,NZ)]);let V9=OQ,T9;if(n.inner_html===u.inner_html)T9=V9;else T9=D(ZK(u.inner_html),V9);let nQ=T9,Y9;if(nQ instanceof j)Y9=m;else Y9=D(qW(N,0,nQ,z([])),m);let VG=Y9;Z=i,Q=P,J=ZZ,W=L,G=T,K=k,X=C,V=N+1,Y=w,H=E,U=h,M=VG,R=c,I=CQ}else{let u=WZ,ZZ=O.tail,n=HZ,i=q.tail,o=O9(N-k,u),d,a=$Q(YZ,E,N,n);d=mQ(a,c,E,N,u);let NZ=d;Z=i,Q=P,J=ZZ,W=L,G=T,K=k,X=C,V=N+1,Y=w,H=E,U=D(o,h),M=m,R=c,I=NZ}}}}}}function l9(Z,Q,J){return EW(z([Q]),lZ(),z([J]),lZ(),lZ(),0,0,0,0,H8,_,_,OZ,h0(Z))}var{setTimeout:O7,clearTimeout:wW}=globalThis,j7=(Z,Q)=>JQ().createElementNS(Z,Q),A7=(Z)=>JQ().createTextNode(Z),B7=()=>JQ().createDocumentFragment(),r9=(Z,Q,J)=>Z.insertBefore(Q,J),zK=H0?(Z,Q,J)=>Z.moveBefore(Q,J):r9,P7=(Z,Q)=>Z.removeChild(Q),T7=(Z,Q)=>Z.getAttribute(Q),qK=(Z,Q,J)=>Z.setAttribute(Q,J),S7=(Z,Q)=>Z.removeAttribute(Q),L7=(Z,Q,J,W)=>Z.addEventListener(Q,J,W),NK=(Z,Q,J)=>Z.removeEventListener(Q,J),C7=(Z,Q)=>Z.innerHTML=Q,E7=(Z,Q)=>Z.data=Q,pQ=Symbol("lustre");class jK{constructor(Z,Q,J,W){this.kind=Z,this.key=W,this.parent=Q,this.children=[],this.node=J,this.handlers=new Map,this.throttles=new Map,this.debouncers=new Map}get parentNode(){return this.kind===DQ?this.node.parentNode:this.node}}var dQ=(Z,Q,J,W,G)=>{let K=new jK(Z,Q,J,G);return J[pQ]=K,Q?.children.splice(W,0,K),K},w7=(Z)=>{let Q="";for(let J=Z[pQ];J.parent;J=J.parent)if(J.key)Q=`${OJ}${J.key}${Q}`;else{let W=J.parent.children.indexOf(J);Q=`${OJ}${W}${Q}`}return Q.slice(1)};class kW{#Z=null;#G=()=>{};#W=!1;#J=!1;constructor(Z,Q,{useServerEvents:J=!1,exposeKeys:W=!1}={}){this.#Z=Z,this.#G=Q,this.#W=J,this.#J=W}mount(Z){dQ(q9,null,this.#Z,0,null),this.#D(this.#Z,null,this.#Z[pQ],0,Z)}push(Z){this.#Q.push({node:this.#Z[pQ],patch:Z}),this.#K()}#Q=[];#K(){let Z=this.#Q;while(Z.length){let{node:Q,patch:J}=Z.pop(),{children:W}=Q,{changes:G,removed:K,children:X}=J;if(j9(G,(V)=>this.#X(Q,V)),K)this.#I(Q,W.length-K,K);j9(X,(V)=>{let Y=W[V.index|0];this.#Q.push({node:Y,patch:V})})}}#X(Z,Q){switch(Q.kind){case NW:this.#P(Z,Q);break;case DW:this.#O(Z,Q);break;case OW:this.#z(Z,Q);break;case AW:this.#U(Z,Q);break;case BW:this.#F(Z,Q);break;case PW:this.#M(Z,Q);break;case TW:this.#Y(Z,Q);break}}#Y(Z,{children:Q,before:J}){let W=B7(),G=this.#H(Z,J);this.#N(W,null,Z,J|0,Q),r9(Z.parentNode,W,G)}#M(Z,{index:Q,with:J}){this.#I(Z,Q|0,1);let W=this.#H(Z,Q);this.#D(Z.parentNode,W,Z,Q|0,J)}#H(Z,Q){Q=Q|0;let{children:J}=Z,W=J.length;if(Q<W)return J[Q].node;let G=J[W-1];if(!G&&Z.kind!==DQ)return null;if(!G)G=Z;while(G.kind===DQ&&G.children.length)G=G.children[G.children.length-1];return G.node.nextSibling}#U(Z,{key:Q,before:J}){J=J|0;let{children:W,parentNode:G}=Z,K=W[J].node,X=W[J];for(let U=J+1;U<W.length;++U){let M=W[U];if(W[U]=X,X=M,M.key===Q){W[J]=M;break}}let{kind:V,node:Y,children:H}=X;if(zK(G,Y,K),V===DQ)this.#V(G,H,K)}#V(Z,Q,J){for(let W=0;W<Q.length;++W){let{kind:G,node:K,children:X}=Q[W];if(zK(Z,K,J),G===DQ)this.#V(Z,X,J)}}#F(Z,{index:Q}){this.#I(Z,Q,1)}#I(Z,Q,J){let{children:W,parentNode:G}=Z,K=W.splice(Q,J);for(let X=0;X<K.length;++X){let{kind:V,node:Y,children:H}=K[X];if(P7(G,Y),this.#R(K[X]),V===DQ)K.push(...H)}}#R(Z){let{debouncers:Q,children:J}=Z;for(let{timeout:W}of Q.values())if(W)wW(W);Q.clear(),j9(J,(W)=>this.#R(W))}#z({node:Z,handlers:Q,throttles:J,debouncers:W},{added:G,removed:K}){j9(K,({name:X})=>{if(Q.delete(X))NK(Z,X,xW),this.#q(J,X,0),this.#q(W,X,0);else S7(Z,X),OK[X]?.removed?.(Z,X)}),j9(G,(X)=>this.#B(Z,X))}#P({node:Z},{content:Q}){E7(Z,Q??"")}#O({node:Z},{inner_html:Q}){C7(Z,Q??"")}#N(Z,Q,J,W,G){j9(G,(K)=>this.#D(Z,Q,J,W++,K))}#D(Z,Q,J,W,G){switch(G.kind){case q9:{let K=this.#j(J,W,G);this.#N(K,null,K[pQ],0,G.children),r9(Z,K,Q);break}case d9:{let K=this.#A(J,W,G);r9(Z,K,Q);break}case DQ:{let K=this.#A(J,W,G);r9(Z,K,Q),this.#N(Z,Q,K[pQ],0,G.children);break}case k0:{let K=this.#j(J,W,G);this.#O({node:K},G),r9(Z,K,Q);break}}}#j(Z,Q,{kind:J,key:W,tag:G,namespace:K,attributes:X}){let V=j7(K||aJ,G);if(dQ(J,Z,V,Q,W),this.#J&&W)qK(V,"data-lustre-key",W);return j9(X,(Y)=>this.#B(V,Y)),V}#A(Z,Q,{kind:J,key:W,content:G}){let K=A7(G??"");return dQ(J,Z,K,Q,W),K}#B(Z,Q){let{debouncers:J,handlers:W,throttles:G}=Z[pQ],{kind:K,name:X,value:V,prevent_default:Y,debounce:H,throttle:U}=Q;switch(K){case JW:{let M=V??"";if(X==="virtual:defaultValue"){Z.defaultValue=M;return}if(M!==T7(Z,X))qK(Z,X,M);OK[X]?.added?.(Z,M);break}case D0:Z[X]=V;break;case WW:{if(W.has(X))NK(Z,X,xW);let M=Y.kind===GW;L7(Z,X,xW,{passive:M}),this.#q(G,X,U),this.#q(J,X,H),W.set(X,(R)=>this.#T(Q,R));break}}}#q(Z,Q,J){let W=Z.get(Q);if(J>0)if(W)W.delay=J;else Z.set(Q,{delay:J});else if(W){let{timeout:G}=W;if(G)wW(G);Z.delete(Q)}}#T(Z,Q){let{currentTarget:J,type:W}=Q,{debouncers:G,throttles:K}=J[pQ],X=w7(J),{prevent_default:V,stop_propagation:Y,include:H,immediate:U}=Z;if(V.kind===Q8)Q.preventDefault();if(Y.kind===Q8)Q.stopPropagation();if(W==="submit")Q.detail??={},Q.detail.formData=[...new FormData(Q.target,Q.submitter).entries()];let M=this.#W?x7(Q,H??[]):Q,R=K.get(W);if(R){let q=Date.now(),P=R.last||0;if(q>P+R.delay)R.last=q,R.lastEvent=Q,this.#G(M,X,W,U)}let I=G.get(W);if(I)wW(I.timeout),I.timeout=O7(()=>{if(Q===K.get(W)?.lastEvent)return;this.#G(M,X,W,U)},I.delay);if(!R&&!I)this.#G(M,X,W,U)}}var j9=(Z,Q)=>{if(Array.isArray(Z))for(let J=0;J<Z.length;J++)Q(Z[J]);else if(Z)for(Z;Z.head;Z=Z.tail)Q(Z.head)},xW=(Z)=>{let{currentTarget:Q,type:J}=Z;Q[pQ].handlers.get(J)(Z)},x7=(Z,Q=[])=>{let J={};if(Z.type==="input"||Z.type==="change")Q.push("target.value");if(Z.type==="submit")Q.push("detail.formData");for(let W of Q){let G=W.split(".");for(let K=0,X=Z,V=J;K<G.length;K++){if(K===G.length-1){V[G[K]]=X[G[K]];break}V=V[G[K]]??={},X=X[G[K]]}}return J},DK=(Z)=>{return{added(Q){Q[Z]=!0},removed(Q){Q[Z]=!1}}},k7=(Z)=>{return{added(Q,J){Q[Z]=J}}},OK={checked:DK("checked"),selected:DK("selected"),value:k7("value"),autofocus:{added(Z){queueMicrotask(()=>{Z.focus?.()})}},autoplay:{added(Z){try{Z.play?.()}catch(Q){console.error(Q)}}}};function y7(Z,Q,J){while(!0){let W=Z,G=Q,K=J;if(W instanceof j)return[G,e(K)];else{let X=W.tail,V=W.head[0],Y=W.head[1],H=x0(V,Y),U;if(V==="")U=G;else U=z9(G,V,H);let M=U,R=D(H,K);Z=X,Q=M,J=R}}}function yW(Z){return y7(Z,lZ(),_)}function AK(Z,Q,J){let W=yW(J),G,K;return G=W[0],K=W[1],jJ("",OZ,"",Z,Q,K,G,!1,!1)}function BK(Z,Q,J,W){let G=yW(W),K,X;return K=G[0],X=G[1],jJ("",OZ,Z,Q,J,X,K,!1,!1)}function PK(Z){let Q=yW(Z),J,W;return J=Q[0],W=Q[1],UW("",OZ,W,J)}var TK=(Z)=>{let Q=dQ(q9,null,Z,0,null),J=0;for(let X=Z.firstChild;X;X=X.nextSibling)if(SK(X))J+=1;if(J===0){let X=JQ().createTextNode("");return dQ(d9,Q,X,0,null),Z.replaceChildren(X),c0()}if(J===1)return bW(Q,Z).head[1];let W=JQ().createTextNode(""),G=dQ(DQ,Q,W,0,null),K=bW(G,Z);return Z.insertBefore(W,Z.firstChild),PK(K)},SK=(Z)=>{switch(Z.nodeType){case tJ:return!0;case e8:return!!Z.data;default:return!1}},b7=(Z,Q,J,W)=>{if(!SK(Q))return null;switch(Q.nodeType){case tJ:{let G=dQ(q9,Z,Q,W,J),K=Q.localName,X=Q.namespaceURI,V=!X||X===aJ;if(V&&f7.includes(K))h7(K,Q);let Y=v7(Q),H=bW(G,Q);return V?AK(K,Y,H):BK(X,K,Y,H)}case e8:return dQ(d9,Z,Q,W,null),U8(Q.data);default:return null}},f7=["input","select","textarea"],h7=(Z,Q)=>{let{value:J,checked:W}=Q;if(Z==="input"&&Q.type==="checkbox"&&!W)return;if(Z==="input"&&Q.type==="radio"&&!W)return;if(Q.type!=="checkbox"&&Q.type!=="radio"&&!J)return;queueMicrotask(()=>{if(Q.value=J,Q.checked=W,Q.dispatchEvent(new Event("input",{bubbles:!0})),Q.dispatchEvent(new Event("change",{bubbles:!0})),JQ().activeElement!==Q)Q.dispatchEvent(new Event("blur",{bubbles:!0}))})},bW=(Z,Q)=>{let J=null,W=Q.firstChild,G=null,K=0;while(W){let X=W.nodeType===tJ?W.getAttribute("data-lustre-key"):null;if(X!=null)W.removeAttribute("data-lustre-key");let V=b7(Z,W,X,K),Y=W.nextSibling;if(V){let H=new pZ([X??"",V],null);if(G)G=G.tail=H;else G=J=H;K+=1}else Q.removeChild(W);W=Y}if(!G)return _;return G.tail=_,J},v7=(Z)=>{let Q=Z.attributes.length,J=_;while(Q-- >0){let W=Z.attributes[Q];if(W.name==="xmlns")continue;J=new pZ(g7(W),J)}return J},g7=(Z)=>{let{localName:Q,value:J}=Z;return gQ(Q,J)};var LJ=()=>!!JQ();class O8{constructor(Z,[Q,J],W,G){this.root=Z,this.#Z=Q,this.#G=W,this.#W=G,this.root.addEventListener("context-request",(K)=>{if(!(K.context&&K.callback))return;if(!this.#X.has(K.context))return;K.stopImmediatePropagation();let X=this.#X.get(K.context);if(K.subscribe){let V=()=>{X.subscribers=X.subscribers.filter((Y)=>Y!==K.callback)};X.subscribers.push([K.callback,V]),K.callback(X.value,V)}else K.callback(X.value)}),this.#K=new kW(this.root,(K,X,V)=>{let[Y,H]=BJ(this.#Q,X,V,K);if(this.#Q=Y,H.isOk()){let U=H[0];if(U.stop_propagation)K.stopPropagation();if(U.prevent_default)K.preventDefault();this.dispatch(U.message,!1)}}),this.#J=TK(this.root),this.#Q=zW(),this.#F=!0,this.#R(J)}root=null;dispatch(Z,Q=!1){if(this.#F||=Q,this.#Y)this.#M.push(Z);else{let[J,W]=this.#W(this.#Z,Z);this.#Z=J,this.#R(W)}}emit(Z,Q){(this.root.host??this.root).dispatchEvent(new CustomEvent(Z,{detail:Q,bubbles:!0,composed:!0}))}provide(Z,Q){if(!this.#X.has(Z))this.#X.set(Z,{value:Q,subscribers:[]});else{let J=this.#X.get(Z);J.value=Q;for(let W=J.subscribers.length-1;W>=0;W--){let[G,K]=J.subscribers[W];if(!G){J.subscribers.splice(W,1);continue}G(Q,K)}}}#Z;#G;#W;#J;#Q;#K;#X=new Map;#Y=!1;#M=[];#H=_;#U=_;#V=null;#F=!1;#I={dispatch:(Z,Q)=>this.dispatch(Z,Q),emit:(Z,Q)=>this.emit(Z,Q),select:()=>{},root:()=>this.root,provide:(Z,Q)=>this.provide(Z,Q)};#R(Z){this.#Y=!0;while(!0){for(let Q=Z.synchronous;Q.tail;Q=Q.tail)Q.head(this.#I);if(this.#H=CK(this.#H,Z.before_paint),this.#U=CK(this.#U,Z.after_paint),!this.#M.length)break;[this.#Z,Z]=this.#W(this.#Z,this.#M.shift())}if(this.#Y=!1,this.#F)cancelAnimationFrame(this.#V),this.#z();else if(!this.#V)this.#V=requestAnimationFrame(()=>{this.#z()})}#z(){this.#F=!1,this.#V=null;let Z=this.#G(this.#Z),{patch:Q,events:J}=l9(this.#Q,this.#J,Z);if(this.#Q=J,this.#J=Z,this.#K.push(Q),this.#H instanceof pZ){let W=LK(this.#H);this.#H=_,queueMicrotask(()=>{this.#F=!0,this.#R(W)})}if(this.#U instanceof pZ){let W=LK(this.#U);this.#U=_,requestAnimationFrame(()=>{this.#F=!0,this.#R(W)})}}}function LK(Z){return{synchronous:Z,after_paint:_,before_paint:_}}function CK(Z,Q){if(Z instanceof j)return Q;else if(Q instanceof j)return Z;else return x9(Z,Q)}class hW extends F{constructor(Z){super();this.message=Z}}class vW extends F{constructor(Z){super();this.callback=Z}}class gW extends F{constructor(Z){super();this.callback=Z}}class K9 extends F{constructor(Z){super();this.message=Z}}class A9 extends F{constructor(Z,Q){super();this.name=Z,this.data=Q}}class j8 extends F{constructor(Z,Q){super();this.key=Z,this.value=Q}}class B9 extends F{}class wK extends F{constructor(Z,Q,J,W,G,K,X,V,Y,H){super();this.open_shadow_root=Z,this.adopt_styles=Q,this.delegates_focus=J,this.attributes=W,this.properties=G,this.contexts=K,this.is_form_associated=X,this.on_form_autofill=V,this.on_form_reset=Y,this.on_form_restore=H}}function xK(Z){let Q=new wK(!0,!0,!1,_,_,_,!1,oJ,oJ,oJ);return EZ(Z,Q,(J,W)=>{return W.apply(J)})}class yK{#Z;constructor(Z,[Q,J],W,G){this.#Z=new O8(Z,[Q,J],G,W)}send(Z){switch(Z.constructor){case K9:{this.dispatch(Z.message,!1);break}case A9:{this.emit(Z.name,Z.data);break}case B9:break}}dispatch(Z,Q){this.#Z.dispatch(Z,Q)}emit(Z,Q){this.#Z.emit(Z,Q)}}var bK=({init:Z,update:Q,view:J},W,G)=>{if(!LJ())return new b(new CJ);let K=W instanceof HTMLElement?W:JQ().querySelector(W);if(!K)return new b(new _W(W));return new x(new yK(K,Z(G),Q,J))};class _7{#Z;#G;#W;#J;#Q;#K;#X=tZ();#Y=new Set;constructor([Z,Q],J,W,G){this.#Z=Z,this.#G=J,this.#W=W,this.#J=G,this.#Q=this.#W(this.#Z),this.#K=$0(this.#Q),this.#V(Q)}send(Z){switch(Z.constructor){case hW:{let{message:Q}=Z,J=this.#M(Q),W=l9(this.#K,this.#Q,J);this.#Q=J,this.#K=W.events,this.broadcast(CW(W.patch));return}case vW:{let{callback:Q}=Z;this.#Y.add(Q),Q(YK(this.#J.open_shadow_root,this.#J.adopt_styles,XQ(this.#J.attributes),XQ(this.#J.properties),XQ(this.#J.contexts),this.#X,this.#Q));return}case gW:{let{callback:Q}=Z;this.#Y.delete(Q);return}case K9:{let{message:Q}=Z,[J,W]=this.#G(this.#Z,Q),G=this.#W(J),K=l9(this.#K,this.#Q,G);this.#V(W),this.#Z=J,this.#Q=G,this.#K=K.events,this.broadcast(CW(K.patch));return}case A9:{let{name:Q,data:J}=Z;this.broadcast(HK(Q,J));return}case j8:{let{key:Q,value:J}=Z;this.#X=AZ(this.#X,Q,J),this.broadcast(MK(Q,J));return}case B9:{this.#Z=null,this.#G=null,this.#W=null,this.#J=null,this.#Q=null,this.#K=null,this.#X=null,this.#Y.clear();return}default:return}}broadcast(Z){for(let Q of this.#Y)Q(Z)}#M(Z){switch(Z.constructor){case I8:{let{messages:Q}=Z,J=this.#Z,W=zJ();for(let G=Q;G.head;G=G.tail){let K=this.#M(G.head);if(K instanceof x){J=K[0][0],W=S0(WQ.fromArray([W,K[0][1]]));break}}return this.#V(W),this.#Z=J,this.#W(this.#Z)}case z8:{let{name:Q,value:J}=Z,W=this.#H(Q,J);if(W instanceof b)return this.#Q;else{let[G,K]=this.#G(this.#Z,W[0]);return this.#V(K),this.#Z=G,this.#W(this.#Z)}}case q8:{let{name:Q,value:J}=Z,W=this.#U(Q,J);if(W instanceof b)return this.#Q;else{let[G,K]=this.#G(this.#Z,W[0]);return this.#V(K),this.#Z=G,this.#W(this.#Z)}}case N8:{let{path:Q,name:J,event:W}=Z,[G,K]=BJ(this.#K,Q,J,W);if(this.#K=G,K instanceof b)return this.#Q;else{let[X,V]=this.#G(this.#Z,K[0].message);return this.#V(V),this.#Z=X,this.#W(this.#Z)}}case LW:{let{key:Q,value:J}=Z,W=UZ(this.#J.contexts,Q);if(W instanceof b)return this.#Q;if(W=M9(J,W[0]),W instanceof b)return this.#Q;let[G,K]=this.#G(this.#Z,W[0]);return this.#V(K),this.#Z=G,this.#W(this.#Z)}}}#H(Z,Q){let J=UZ(this.#J.attributes,Z);switch(J.constructor){case x:return J[0](Q);case b:return new b(void 0)}}#U(Z,Q){let J=UZ(this.#J.properties,Z);switch(J.constructor){case x:return J[0](Q);case b:return new b(void 0)}}#V(Z){let Q=(X)=>this.send(new K9(X)),J=(X,V)=>this.send(new A9(X,V)),W=()=>{return},G=()=>{return},K=(X,V)=>this.send(new j8(X,V));globalThis.queueMicrotask(()=>{P0(Z,Q,J,W,G,K)})}}class fK extends F{constructor(Z,Q,J,W){super();this.init=Z,this.update=Q,this.view=J,this.config=W}}class _W extends F{constructor(Z){super();this.selector=Z}}class CJ extends F{}function hK(Z,Q,J){return new fK(Z,Q,J,xK(_))}function vK(Z,Q,J){return GZ(!LJ(),new b(new CJ),()=>{return bK(Z,Q,J)})}function m7(Z){if(Z==="input")return!0;else if(Z==="change")return!0;else if(Z==="focus")return!0;else if(Z==="focusin")return!0;else if(Z==="focusout")return!0;else if(Z==="blur")return!0;else if(Z==="select")return!0;else return!1}function sQ(Z,Q){return O0(Z,vJ(Q,(J)=>{return new IJ(!1,!1,J)}),_,KW,KW,m7(Z),0,0)}function i9(Z){if(Z instanceof yZ)return new yZ(Z.kind,Z.name,Z.handler,Z.include,j0,Z.stop_propagation,Z.immediate,Z.debounce,Z.throttle);else return Z}function gK(Z){return sQ("mousedown",KQ(Z))}var a9="src/chess/algebraic_notation.gleam";class uK extends F{}class cW extends F{}class dW extends F{}class EJ extends F{}class A8 extends F{}function c7(Z){if(Z instanceof dW)return"#";else if(Z instanceof EJ)return"+";else return""}function uW(Z){if(Z)return"x";else return""}function B8(Z){if(Z instanceof s)return"";else if(Z instanceof ZQ)return"N";else if(Z instanceof $Z)return"B";else if(Z instanceof IZ)return"R";else if(Z instanceof QQ)return"Q";else return"K"}function p7(Z){return"="+B8(Z)}function $K(Z){if(Z instanceof g)return"1";else if(Z instanceof FZ)return"2";else if(Z instanceof sZ)return"3";else if(Z instanceof vZ)return"4";else if(Z instanceof gZ)return"5";else if(Z instanceof nZ)return"6";else if(Z instanceof RZ)return"7";else return"8"}function pW(Z){if(Z instanceof DZ)return"a";else if(Z instanceof BZ)return"b";else if(Z instanceof QZ)return"c";else if(Z instanceof zZ)return"d";else if(Z instanceof p)return"e";else if(Z instanceof qZ)return"f";else if(Z instanceof JZ)return"g";else return"h"}function mK(Z){let Q=pW(Z.file),J=$K(Z.row);return Q+J}function $W(Z){return mK(Z)}function mW(Z,Q,J,W,G){let K=FQ(Z,J),X;if(K instanceof S)X=K[0];else throw v("let_assert",a9,"chess/algebraic_notation",196,"disambiguation","Pattern match failed, no pattern matched the value.",{value:K,start:5423,end:5473,pattern_start:5434,pattern_end:5446});let V=X[0];if(V instanceof s&&G)return pW(J.file);else{let Y=V,H=X[1],U,R=XQ(Q);U=w9(R,(L)=>{return GZ(B(L,J),!1,()=>{let T=FQ(Z,L);return B(T,new S([Y,H]))})});let I=U,q;q=w9(I,(L)=>{let k=UZ(Q,L),C=R9(k,()=>{throw v("panic",a9,"chess/algebraic_notation",219,"disambiguation","`panic` expression evaluated.",{})}),N=I9(C);return KJ(N,(w)=>{if(w instanceof kZ){let E=w.to;return B(E,W)}else if(w instanceof HQ){let E=w.to;return B(E,W)}else if(w instanceof MQ){let E=w.to;return B(E,W)}else if(w instanceof UQ)return!1;else return!1})});let O=q;return GZ(SG(O),"",()=>{let L;return L=GJ(O,(C)=>{return!B(C.file,J.file)}),GZ(L,(()=>{let C=J.file;return pW(C)})(),()=>{let C;return C=GJ(O,(E)=>{return!B(E.row,J.row)}),GZ(C,(()=>{let E=J.row;return $K(E)})(),()=>{return mK(J)})})})}}function d7(Z,Q,J,W){let G;{let M=r8(Q);G=r8(Z)>M}let K=G,X;if(W instanceof PQ){let{from:M,to:R}=W,I=FQ(Z,M),q;if(I instanceof S)q=I[0][0];else throw v("let_assert",a9,"chess/algebraic_notation",123,"describe_internal","Pattern match failed, no pattern matched the value.",{value:I,start:3633,end:3696,pattern_start:3644,pattern_end:3669});X=B8(q)+mW(Z,J,M,R,K)+uW(K)+$W(R)}else if(W instanceof bQ){let{from:M,to:R,new_figure:I}=W,q=FQ(Z,M),P;if(q instanceof S)P=q[0][0];else throw v("let_assert",a9,"chess/algebraic_notation",137,"describe_internal","Pattern match failed, no pattern matched the value.",{value:q,start:4164,end:4227,pattern_start:4175,pattern_end:4200});X=B8(P)+mW(Z,J,M,R,K)+uW(K)+$W(R)+p7(I)}else if(W instanceof fQ){let{from:M,to:R}=W,I=FQ(Z,M),q;if(I instanceof S)q=I[0][0];else throw v("let_assert",a9,"chess/algebraic_notation",130,"describe_internal","Pattern match failed, no pattern matched the value.",{value:I,start:3890,end:3953,pattern_start:3901,pattern_end:3926});X=B8(q)+mW(Z,J,M,R,K)+uW(K)+$W(R)}else if(W instanceof hQ)X="O-O";else X="O-O-O";let V=X,Y,H=Q9(Q);if(H instanceof YQ){let M=H.info;if(M instanceof uJ)if(M.by instanceof $J)Y=new dW;else{let I;if(I=lJ(Q),I)Y=new EJ;else Y=new A8}else{let R;if(R=lJ(Q),R)Y=new EJ;else Y=new A8}}else{let M;if(M=lJ(Q),M)Y=new EJ;else Y=new A8}return V+c7(Y)}function cK(Z,Q){let J,W=rJ(Z,Q);return J=F9(W,(K)=>{if(K instanceof cJ)return new uK;else if(K instanceof pJ)return new cW;else return new cW}),kQ(J,(K)=>{let X,V=K0(Z);return X=F9(V,(H)=>{throw v("panic",a9,"chess/algebraic_notation",99,"describe","`panic` expression evaluated.",{})}),kQ(X,(H)=>{let U=d7(Z,K,H,Q);return new x(U)})})}var sW=new A(new QZ,new g);var nW=new A(new QZ,new $);var lW=new A(new JZ,new g);var rW=new A(new JZ,new $);var P8="src/web_chess/internal/game_logic.gleam";class cZ extends F{constructor(Z,Q){super();this.state=Z,this.move_history=Q}}class P9 extends F{constructor(Z,Q,J,W){super();this.state=Z,this.move_history=Q,this.selected_figure=J,this.moves=W}}class t9 extends F{constructor(Z,Q,J,W,G){super();this.state=Z,this.move_history=Q,this.selected_figure=J,this.moves=W,this.dragging_over=G}}class wJ extends F{constructor(Z,Q){super();this.white=Z,this.black=Q}}class iW extends F{constructor(Z){super();this.white=Z}}function dK(Z,Q){let J=Q9(Z.state),W;if(J instanceof _9)W=J.next_player;else throw v("let_assert",P8,"web_chess/internal/game_logic",67,"handle_drag_start","Pattern match failed, no pattern matched the value.",{value:J,start:2024,end:2109,pattern_start:2035,pattern_end:2073});let G=FQ(Z.state,Q);if(G instanceof S){let K=G[0][1];if(B(K,W)){let X,V=t8(Z.state,Q),Y=R9(V,()=>{return PZ()}),H=I9(Y),U=CZ(H,(R)=>{if(R instanceof kZ)return[R.to,R];else if(R instanceof HQ)return[R.to,R];else if(R instanceof MQ)return[R.to,R];else if(R instanceof UQ)if(W instanceof f)return[lW,R];else return[rW,R];else if(W instanceof f)return[sW,R];else return[nW,R]});X=rQ(U);let M=X;return new t9(Z.state,Z.move_history,Q,M,new y)}else return aW("dragging non-friendly: deselect",void 0,"src/web_chess/internal/game_logic.gleam",107),new cZ(Z.state,Z.move_history)}else return aW("dragging non-friendly: deselect",void 0,"src/web_chess/internal/game_logic.gleam",107),new cZ(Z.state,Z.move_history)}function sK(Z,Q){if(Z instanceof t9){let{state:J,move_history:W,selected_figure:G,moves:K}=Z;return new t9(J,W,G,K,new S(Q))}else return Z}function nK(Z){if(Z instanceof t9){let{state:Q,move_history:J,selected_figure:W,moves:G}=Z;return new P9(Q,J,W,G)}else return Z}function lK(Z,Q,J,W){let G;if(W instanceof kZ){let V=W.to;G=new PQ(J,V)}else if(W instanceof HQ){let V=W.to;G=new bQ(J,V,new QQ)}else if(W instanceof MQ){let V=W.to;G=new fQ(J,V)}else if(W instanceof UQ)G=new hQ;else G=new mJ;let K=G,X=rJ(Z,K);if(X instanceof x){let V=X[0],Y=cK(Z,K),H;if(Y instanceof x)H=Y[0];else throw v("let_assert",P8,"web_chess/internal/game_logic",220,"try_do_move","Pattern match failed, no pattern matched the value.",{value:Y,start:6317,end:6383,pattern_start:6328,pattern_end:6348});let U;if(Q instanceof j)U=z([new iW(H)]);else{let R=Q.head;if(R instanceof wJ)U=D(new iW(H),Q);else{let I=Q.tail,q=R.white;U=D(new wJ(q,H),I)}}return new cZ(V,U)}else{let V=X[0];throw aW(V,void 0,"src/web_chess/internal/game_logic.gleam",215),v("panic",P8,"web_chess/internal/game_logic",216,"try_do_move","error executing move",{})}}function rK(Z){if(Z instanceof t9){let{state:Q,move_history:J,selected_figure:W,moves:G,dragging_over:K}=Z;if(K instanceof S){let X=K[0];return GZ(B(X,W),new P9(Q,J,W,G),()=>{let V=UZ(G,X);if(V instanceof x){let Y=V[0];return lK(Q,J,W,Y)}else return new cZ(Q,J)})}else return new cZ(Q,J)}else return Z}function pK(Z,Q,J){let W=Q9(Z),G;if(W instanceof _9)G=W.next_player;else throw v("let_assert",P8,"web_chess/internal/game_logic",244,"try_select","Pattern match failed, no pattern matched the value.",{value:W,start:7092,end:7167,pattern_start:7103,pattern_end:7141});let K=FQ(Z,J);if(K instanceof S){let X=K[0][1];if(B(X,G)){let V,Y=t8(Z,J),H=R9(Y,()=>{return PZ()}),U=I9(H),M=CZ(U,(I)=>{if(I instanceof kZ)return[I.to,I];else if(I instanceof HQ)return[I.to,I];else if(I instanceof MQ)return[I.to,I];else if(I instanceof UQ)if(G instanceof f)return[lW,I];else return[rW,I];else if(G instanceof f)return[sW,I];else return[nW,I]});return V=rQ(M),new P9(Z,Q,J,V)}else return new cZ(Z,Q)}else return new cZ(Z,Q)}function iK(Z,Q){if((()=>{let W=Z.state;return Q9(W)})()instanceof YQ)return Z;else if(Z instanceof cZ){let{state:W,move_history:G}=Z;return pK(W,G,Q)}else if(Z instanceof P9){let{state:W,move_history:G,selected_figure:K,moves:X}=Z,V=UZ(X,Q);if(V instanceof x){let Y=V[0];return lK(Z.state,G,K,Y)}else return pK(W,G,Q)}else{let{state:W,move_history:G}=Z;return new cZ(W,G)}}function aW(Z,Q,J,W){let X=`${J}:${W}`,Y=new aK().inspect(Z),H=Q===void 0?"":" "+Q;if(globalThis.process?.stderr?.write){let U=`\x1B[90m${X}\x1B[39m${H}
${Y}
`;globalThis.process.stderr.write(U)}else if(globalThis.Deno){let U=`\x1B[90m${X}\x1B[39m${H}
${Y}
`;globalThis.Deno.stderr.writeSync(new TextEncoder().encode(U))}else{let U=`${X}
${Y}`;globalThis.console.log(U)}return Z}class aK{#Z=new Set;#G(Z){try{return Z instanceof bZ}catch{return!1}}#W(Z){let Q=Z.toString().replace("+","");if(Q.indexOf(".")>=0)return Q;else{let J=Q.indexOf("e");if(J>=0)return Q.slice(0,J)+".0"+Q.slice(J);else return Q+".0"}}inspect(Z){let Q=typeof Z;if(Z===!0)return"True";if(Z===!1)return"False";if(Z===null)return"//js(null)";if(Z===void 0)return"Nil";if(Q==="string")return this.#Y(Z);if(Q==="bigint"||Number.isInteger(Z))return Z.toString();if(Q==="number")return this.#W(Z);if(Z instanceof e9)return this.#M(Z);if(Z instanceof L9)return this.#H(Z);if(Z instanceof RegExp)return`//js(${Z})`;if(Z instanceof Date)return`//js(Date("${Z.toISOString()}"))`;if(Z instanceof globalThis.Error)return`//js(${Z.toString()})`;if(Z instanceof Function){let W=[];for(let G of Array(Z.length).keys())W.push(String.fromCharCode(G+97));return`//fn(${W.join(", ")}) { ... }`}if(this.#Z.size===this.#Z.add(Z).size)return"//js(circular reference)";let J;if(Array.isArray(Z))J=`#(${Z.map((W)=>this.inspect(W)).join(", ")})`;else if(Z instanceof WQ)J=this.#X(Z);else if(Z instanceof F)J=this.#K(Z);else if(this.#G(Z))J=this.#Q(Z);else if(Z instanceof Set)return`//js(Set(${[...Z].map((W)=>this.inspect(W)).join(", ")}))`;else J=this.#J(Z);return this.#Z.delete(Z),J}#J(Z){let Q=Object.getPrototypeOf(Z)?.constructor?.name||"Object",J=[];for(let K of Object.keys(Z))J.push(`${this.inspect(K)}: ${this.inspect(Z[K])}`);let W=J.length?" "+J.join(", ")+" ":"";return`//js(${Q==="Object"?"":Q+" "}{${W}})`}#Q(Z){let Q="dict.from_list([",J=!0,W=[];return Z.forEach((G,K)=>{W.push([K,G])}),W.sort(),W.forEach(([G,K])=>{if(!J)Q=Q+", ";Q=Q+"#("+this.inspect(G)+", "+this.inspect(K)+")",J=!1}),Q+"])"}#K(Z){let Q=Object.keys(Z).map((J)=>{let W=this.inspect(Z[J]);return isNaN(parseInt(J))?`${J}: ${W}`:W}).join(", ");return Q?`${Z.constructor.name}(${Q})`:Z.constructor.name}#X(Z){if(Z instanceof j)return"[]";let Q='charlist.from_string("',J="[",W=Z;while(W instanceof pZ){let G=W.head;if(W=W.tail,J!=="[")J+=", ";if(J+=this.inspect(G),Q)if(Number.isInteger(G)&&G>=32&&G<=126)Q+=String.fromCharCode(G);else Q=null}if(Q)return Q+'")';else return J+"]"}#Y(Z){let Q='"';for(let J=0;J<Z.length;J++){let W=Z[J];switch(W){case`
`:Q+="\\n";break;case"\r":Q+="\\r";break;case"\t":Q+="\\t";break;case"\f":Q+="\\f";break;case"\\":Q+="\\\\";break;case'"':Q+="\\\"";break;default:if(W<" "||W>"~"&&W<" ")Q+="\\u{"+W.charCodeAt(0).toString(16).toUpperCase().padStart(4,"0")+"}";else Q+=W}}return Q+='"',Q}#M(Z){return`//utfcodepoint(${String.fromCodePoint(Z.value)})`}#H(Z){if(Z.bitSize===0)return"<<>>";let Q="<<";for(let J=0;J<Z.byteSize-1;J++)Q+=Z.byteAt(J).toString(),Q+=", ";if(Z.byteSize*8===Z.bitSize)Q+=Z.byteAt(Z.byteSize-1).toString();else{let J=Z.bitSize%8;Q+=Z.byteAt(Z.byteSize-1)>>8-J,Q+=`:size(${J})`}return Q+=">>",Q}}function oW(Z){window.addEventListener("resize",()=>Z())}function tK(){return[window.innerWidth,window.innerHeight]}function oK(){let Z=parseFloat(getComputedStyle(document.documentElement).fontSize),Q=getComputedStyle(document.documentElement).getPropertyValue("--layout-sidebar-min-width");if(!Q||Q.indexOf("rem")===-1)throw Error("CSS variable --layout-sidebar-min-width missing or invalid format.");return parseFloat(Q.slice(0,Q.indexOf("rem")))*Z}function eW(){let Z=tK(),Q,J;Q=Z[0],J=Z[1];let W=oK();return Q-W>=J}var r7="src/web_chess/internal/views/board.gleam";class T8 extends F{}class S8 extends F{}function i7(Z){if(Z)return R8(z([TZ("absolute inset-0 h-full w-full"),X8("./indicators/capture.svg"),K8("This figure can be captured"),J8(!1)]));else return R8(z([TZ("absolute inset-0 h-full w-full"),X8("./indicators/move.svg"),K8("Can move to here"),J8(!1)]))}function a7(Z,Q,J){let W;if(Z[1]instanceof f){let H=Z[0];if(H instanceof s)W=["./figures/pawn_white.svg","White Bishop"];else if(H instanceof ZQ)W=["./figures/knight_white.svg","White Knight"];else if(H instanceof $Z)W=["./figures/bishop_white.svg","White Bishop"];else if(H instanceof IZ)W=["./figures/rook_white.svg","White Rook"];else if(H instanceof QQ)W=["./figures/queen_white.svg","White Queen"];else W=["./figures/king_white.svg","White King"]}else{let H=Z[0];if(H instanceof s)W=["./figures/pawn_black.svg","Black Pawn"];else if(H instanceof ZQ)W=["./figures/knight_black.svg","Black Knight"];else if(H instanceof $Z)W=["./figures/bishop_black.svg","Black Bishop"];else if(H instanceof IZ)W=["./figures/rook_black.svg","Black Rook"];else if(H instanceof QQ)W=["./figures/queen_black.svg","Black Queen"];else W=["./figures/king_black.svg","Black King"]}let K=W,X,V;X=K[0],V=K[1];let Y=Z[1];return R8(z([TZ("absolute inset-0 h-full w-full"),X8(X),K8(V),J8(B(new S(Y),Q)),sQ("dragstart",KQ(J()))]))}function t7(Z,Q,J,W,G,K,X,V,Y,H){let U;if(Q instanceof S){let q=Q[0];U=new S(a7(q,J,X))}else U=Q;let M=U,R;if(G)R=new S(i7(!B(M,new y)));else R=new y;let I=R;return G9(z([m9(z([["relative",!0],["bg-[var(--color-square-dark)]",B(Z,new S8)&&!W],["bg-[var(--color-square-light)]",B(Z,new T8)&&!W],["bg-[var(--color-square-dark-highlighted)]",B(Z,new S8)&&W],["bg-[var(--color-square-light-highlighted)]",B(Z,new T8)&&W]])),gK(K()),(()=>{let q=sQ("dragover",KQ(H()));return i9(q)})(),(()=>{let q=sQ("drop",KQ(Y()));return i9(q)})(),sQ("dragenter",KQ(V()))]),(()=>{let q=z([M,I]);return lQ(q)})())}function o7(Z){let Q,J=Z.file;if(J instanceof DZ)Q=0;else if(J instanceof BZ)Q=1;else if(J instanceof QZ)Q=2;else if(J instanceof zZ)Q=3;else if(J instanceof p)Q=4;else if(J instanceof qZ)Q=5;else if(J instanceof JZ)Q=6;else Q=7;let W=Q,G,K=Z.row;if(K instanceof g)G=0;else if(K instanceof FZ)G=1;else if(K instanceof sZ)G=2;else if(K instanceof vZ)G=3;else if(K instanceof gZ)G=4;else if(K instanceof nZ)G=5;else if(K instanceof RZ)G=6;else G=7;let V=(W+G)%2;if(V===0)return new S8;else if(V===1)return new T8;else throw v("panic",r7,"web_chess/internal/views/board",202,"coordinate_colour","`panic` expression evaluated.",{})}function e7(){let Z=z([new DZ,new BZ,new QZ,new zZ,new p,new qZ,new JZ,new mZ]),J=z([new $,new RZ,new nZ,new gZ,new vZ,new sZ,new FZ,new g]);return k9(J,(W)=>{return CZ(Z,(K)=>{return new A(K,W)})})}function eK(Z,Q,J,W,G,K){let X;if(Z instanceof cZ)X=[PZ(),PZ()];else if(Z instanceof P9){let{selected_figure:I,moves:q}=Z;X=[(()=>{let P=z([I]);return wZ(P)})(),(()=>{let O=XQ(q);return wZ(O)})()]}else{let{selected_figure:I,moves:q,dragging_over:P}=Z;X=[(()=>{let O=z([new S(I),P]),L=lQ(O);return wZ(L)})(),(()=>{let L=XQ(q);return wZ(L)})()]}let V=X,Y,H;Y=V[0],H=V[1];let U,M=(()=>{let I=Z.state;return Q9(I)})();if(M instanceof YQ)U=new y;else{let I=M.next_player;U=new S(I)}let R=U;return G9(z([TZ("grid h-[100vmin] w-[100vmin] grid-cols-8 grid-rows-8 select-none")]),CZ(e7(),(I)=>{return t7(o7(I),FQ(Z.state,I),R,(()=>{return HJ(Y,I)})(),(()=>{return HJ(H,I)})(),()=>{return Q(I)},()=>{return J(I)},()=>{return W(I)},G,K)}))}function ZX(){return n9(z([TZ("m-1 text-xs")]),z([F8(z([TZ("whitespace-nowrap"),W8("https://commons.wikimedia.org/wiki/Category:SVG_chess_pieces"),G8("_blank")]),z([SQ("Chess icons")])),SQ(" by "),F8(z([W8("https://commons.wikimedia.org/wiki/User:Cburnett"),G8("_blank")]),z([SQ("Cburnett")])),SQ(" "),F8(z([TZ("whitespace-nowrap"),W8("https://creativecommons.org/licenses/by-sa/3.0/deed.en"),G8("_blank")]),z([SQ("CC BY-SA 3.0")]))]))}function QX(Z){let Q,W=e(Z);Q=LG(W,(K,X)=>{let V=X+1;if(K instanceof wJ){let{white:Y,black:H}=K;return[V,Y,H]}else{let Y=K.white;return[V,Y,""]}});let G=Q;return G9(z([TZ("grid [grid-template-columns:1.5rem_4.5rem_4.5rem] justify-center gap-y-1 gap-x-1.5 pt-2 pb-1")]),(()=>{return k9(G,(X)=>{let V,Y,H;return V=X[0],Y=X[1],H=X[2],z([n9(z([]),z([SQ(tQ(V)+".")])),n9(z([TZ("font-bold")]),z([SQ(Y)])),n9(z([TZ("font-bold")]),z([SQ(H)]))])})})())}var WV="src/app.gleam";class X9 extends F{constructor(Z,Q){super();this.is_layout_sideways=Z,this.game=Q}}class QG extends F{}class JG extends F{constructor(Z){super();this.square=Z}}class WG extends F{constructor(Z){super();this.dragging_figure=Z}}class GG extends F{constructor(Z){super();this.over=Z}}class KG extends F{}class XG extends F{}class ZG extends F{}function GV(Z){let Q=new X9(eW(),new cZ(J0(),z([]))),J=T0((W)=>{return oW(()=>{return W(new QG)})});return[Q,J]}function KV(Z){return new X9(eW(),Z.game)}function XV(Z,Q){let J;if(Q instanceof QG)J=KV(Z);else if(Q instanceof JG){let G=Q.square;J=new X9(Z.is_layout_sideways,iK(Z.game,G))}else if(Q instanceof WG){let G=Q.dragging_figure;J=new X9(Z.is_layout_sideways,dK(Z.game,G))}else if(Q instanceof GG){let G=Q.over;J=new X9(Z.is_layout_sideways,sK(Z.game,G))}else if(Q instanceof KG)J=new X9(Z.is_layout_sideways,rK(Z.game));else if(Q instanceof XG)J=new X9(Z.is_layout_sideways,nK(Z.game));else J=Z;return[J,zJ()]}function VV(Z){return p0(z([TZ("flex bg-background text-text font-sans h-screen w-screen overflow-x-hidden"),m9(z([["flex-row items-stretch",Z.is_layout_sideways],["flex-col items-stretch",!Z.is_layout_sideways]])),(()=>{let Q=sQ("dragover",KQ(new ZG));return i9(Q)})(),(()=>{let Q=sQ("drop",KQ(new XG));return i9(Q)})()]),z([G9(z([TZ("h-[calc(50vh-50vmin)] flex-none")]),z([])),s0(z([m9(z([["flex justify-center",!0],["flex-1",Z.is_layout_sideways],["h-[100vmin] min-h-[100vmin]",!Z.is_layout_sideways]]))]),z([eK(Z.game,(Q)=>{return new JG(Q)},(Q)=>{return new WG(Q)},(Q)=>{return new GG(Q)},()=>{return new KG},()=>{return new ZG})])),d0(z([m9(z([["flex flex-col justify-between",!0],["h-full w-[var(--layout-sidebar-min-width)] overflow-y-scroll",Z.is_layout_sideways],["w-full flex-1",!Z.is_layout_sideways]]))]),z([QX(Z.game.move_history),G9(z([TZ("text-center")]),z([ZX()]))]))]))}function JX(){let Z=hK(GV,XV,VV),Q=vK(Z,"#app",void 0);if(!(Q instanceof x))throw v("let_assert",WV,"app",17,"main","Pattern match failed, no pattern matched the value.",{value:Q,start:474,end:523,pattern_start:485,pattern_end:490});return}JX();
